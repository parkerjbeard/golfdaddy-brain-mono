============================= test session starts ==============================
platform darwin -- Python 3.13.7, pytest-8.4.1, pluggy-1.6.0 -- /Users/parkerbeard/golfdaddy-brain/backend/venv/bin/python
cachedir: .pytest_cache
rootdir: /Users/parkerbeard/golfdaddy-brain/backend
configfile: pytest.ini
plugins: anyio-4.9.0, asyncio-1.1.0, cov-6.2.1, mock-3.14.1
asyncio: mode=Mode.STRICT, asyncio_default_fixture_loop_scope=None, asyncio_default_test_loop_scope=function
collecting ... collected 264 items

tests/unit/api/test_api_gateway.py::TestApiKeyMiddleware::test_valid_api_key PASSED [  0%]
tests/unit/api/test_api_gateway.py::TestApiKeyMiddleware::test_invalid_api_key PASSED [  0%]
tests/unit/api/test_api_gateway.py::TestApiKeyMiddleware::test_missing_api_key PASSED [  1%]
tests/unit/api/test_api_gateway.py::TestApiKeyMiddleware::test_excluded_path PASSED [  1%]
tests/unit/api/test_api_gateway.py::TestRateLimiter::test_rate_limiting PASSED [  1%]
tests/unit/api/test_api_gateway.py::TestRateLimiter::test_custom_rate_limit PASSED [  2%]
tests/unit/api/test_api_gateway.py::TestRateLimiter::test_excluded_path_rate_limit PASSED [  2%]
tests/unit/api/test_api_gateway.py::TestRequestMetrics::test_metrics_collection FAILED [  3%]
tests/unit/api/test_auth_endpoints.py::test_auth_me_root_requires_bearer_token PASSED [  3%]
tests/unit/api/test_auth_endpoints.py::test_auth_me_v1_requires_bearer_token PASSED [  3%]
tests/unit/api/test_auth_endpoints.py::test_login_returns_token_with_mocked_supabase FAILED [  4%]
tests/unit/api/test_basic_auth.py::TestBasicAuth::test_health_endpoint_no_auth PASSED [  4%]
tests/unit/api/test_basic_auth.py::TestBasicAuth::test_api_endpoint_requires_api_key_when_enabled FAILED [  4%]
tests/unit/api/test_basic_auth.py::TestBasicAuth::test_docs_endpoint_no_auth PASSED [  5%]
tests/unit/api/test_basic_auth.py::TestBasicAuth::test_auth_exclude_paths PASSED [  5%]
tests/unit/api/test_basic_auth.py::TestBasicAuth::test_valid_api_key_passes_when_enabled PASSED [  6%]
tests/unit/api/test_basic_auth.py::TestBasicAuth::test_frontend_url_configured PASSED [  6%]
tests/unit/api/test_basic_auth.py::TestBasicAuth::test_slack_settings_configured PASSED [  6%]
tests/unit/api/test_basic_auth.py::TestBasicAuth::test_api_auth_disabled_by_default PASSED [  7%]
tests/unit/api/test_daily_report_endpoints.py::test_submit_eod_report_success FAILED [  7%]
tests/unit/api/test_daily_report_endpoints.py::test_submit_eod_report_service_exception FAILED [  7%]
tests/unit/api/test_daily_report_endpoints.py::test_submit_eod_report_validation_error FAILED [  8%]
tests/unit/api/test_daily_report_endpoints.py::test_get_my_daily_reports_success FAILED [  8%]
tests/unit/api/test_daily_report_endpoints.py::test_get_my_daily_report_for_date_success FAILED [  9%]
tests/unit/api/test_daily_report_endpoints.py::test_get_my_daily_report_for_date_not_found FAILED [  9%]
tests/unit/api/test_daily_report_endpoints.py::test_get_my_daily_report_for_date_invalid_format FAILED [  9%]
tests/unit/api/test_daily_report_endpoints.py::test_get_daily_report_by_id_success FAILED [ 10%]
tests/unit/api/test_daily_report_endpoints.py::test_get_daily_report_by_id_not_found FAILED [ 10%]
tests/unit/api/test_daily_report_endpoints.py::test_get_daily_report_by_id_invalid_uuid FAILED [ 10%]
tests/unit/api/test_health.py::TestHealthChecker::test_check_database_success PASSED [ 11%]
tests/unit/api/test_health.py::TestHealthChecker::test_check_database_failure PASSED [ 11%]
tests/unit/api/test_health.py::TestHealthChecker::test_check_github_api_success FAILED [ 12%]
tests/unit/api/test_health.py::TestHealthChecker::test_check_github_api_no_token PASSED [ 12%]
tests/unit/api/test_health.py::TestHealthChecker::test_check_github_api_degraded FAILED [ 12%]
tests/unit/api/test_health.py::TestHealthChecker::test_check_openai_api_success FAILED [ 13%]
tests/unit/api/test_health.py::TestHealthChecker::test_check_openai_api_no_key PASSED [ 13%]
tests/unit/api/test_health.py::TestHealthChecker::test_check_circuit_breakers_healthy PASSED [ 14%]
tests/unit/api/test_health.py::TestHealthChecker::test_check_circuit_breakers_degraded PASSED [ 14%]
tests/unit/api/test_health.py::TestHealthChecker::test_check_circuit_breakers_unhealthy PASSED [ 14%]
tests/unit/api/test_health.py::TestHealthChecker::test_check_rate_limiters_healthy PASSED [ 15%]
tests/unit/api/test_health.py::TestHealthChecker::test_check_rate_limiters_degraded PASSED [ 15%]
tests/unit/api/test_health.py::TestHealthEndpoints::test_basic_health PASSED [ 15%]
tests/unit/api/test_health.py::TestHealthEndpoints::test_detailed_health_disabled PASSED [ 16%]
tests/unit/api/test_health.py::TestHealthEndpoints::test_detailed_health_success FAILED [ 16%]
tests/unit/api/test_health.py::TestHealthEndpoints::test_detailed_health_degraded FAILED [ 17%]
tests/unit/api/test_health.py::TestHealthEndpoints::test_metrics_endpoint PASSED [ 17%]
tests/unit/api/test_health.py::TestHealthEndpoints::test_reset_circuit_breaker_success PASSED [ 17%]
tests/unit/api/test_health.py::TestHealthEndpoints::test_reset_circuit_breaker_not_found FAILED [ 18%]
tests/unit/api/test_webhooks.py::TestWebhookEndpoints::test_github_webhook_success FAILED [ 18%]
tests/unit/api/test_webhooks.py::TestWebhookEndpoints::test_github_webhook_no_secret_configured FAILED [ 18%]
tests/unit/api/test_webhooks.py::TestWebhookEndpoints::test_github_webhook_invalid_signature FAILED [ 19%]
tests/unit/api/test_webhooks.py::TestWebhookEndpoints::test_github_webhook_missing_signature FAILED [ 19%]
tests/unit/api/test_webhooks.py::TestWebhookEndpoints::test_github_webhook_invalid_json FAILED [ 20%]
tests/unit/api/test_webhooks.py::TestWebhookEndpoints::test_github_webhook_processing_error FAILED [ 20%]
tests/unit/api/test_webhooks.py::TestWebhookEndpoints::test_github_webhook_status_configured FAILED [ 20%]
tests/unit/api/test_webhooks.py::TestWebhookEndpoints::test_github_webhook_status_not_configured FAILED [ 21%]
tests/unit/core/test_circuit_breaker.py::TestCircuitBreakerConfig::test_default_config PASSED [ 21%]
tests/unit/core/test_circuit_breaker.py::TestCircuitBreakerConfig::test_custom_config PASSED [ 21%]
tests/unit/core/test_circuit_breaker.py::TestCircuitBreaker::test_initial_state PASSED [ 22%]
tests/unit/core/test_circuit_breaker.py::TestCircuitBreaker::test_successful_call PASSED [ 22%]
tests/unit/core/test_circuit_breaker.py::TestCircuitBreaker::test_sync_function_call PASSED [ 23%]
tests/unit/core/test_circuit_breaker.py::TestCircuitBreaker::test_single_failure PASSED [ 23%]
tests/unit/core/test_circuit_breaker.py::TestCircuitBreaker::test_threshold_failures_open_circuit PASSED [ 23%]
tests/unit/core/test_circuit_breaker.py::TestCircuitBreaker::test_open_circuit_blocks_calls PASSED [ 24%]
tests/unit/core/test_circuit_breaker.py::TestCircuitBreaker::test_circuit_recovery_attempt FAILED [ 24%]
tests/unit/core/test_circuit_breaker.py::TestCircuitBreaker::test_half_open_state_recovery PASSED [ 25%]
tests/unit/core/test_circuit_breaker.py::TestCircuitBreaker::test_half_open_failure_returns_to_open PASSED [ 25%]
tests/unit/core/test_circuit_breaker.py::TestCircuitBreaker::test_unexpected_exception_not_handled PASSED [ 25%]
tests/unit/core/test_circuit_breaker.py::TestCircuitBreaker::test_status_property PASSED [ 26%]
tests/unit/core/test_circuit_breaker.py::TestCircuitBreakerManager::test_create_breaker PASSED [ 26%]
tests/unit/core/test_circuit_breaker.py::TestCircuitBreakerManager::test_get_nonexistent_breaker PASSED [ 26%]
tests/unit/core/test_circuit_breaker.py::TestCircuitBreakerManager::test_get_status_all_breakers PASSED [ 27%]
tests/unit/core/test_circuit_breaker.py::TestCircuitBreakerManager::test_reset_breaker PASSED [ 27%]
tests/unit/core/test_circuit_breaker.py::TestCircuitBreakerManager::test_reset_nonexistent_breaker PASSED [ 28%]
tests/unit/core/test_circuit_breaker.py::TestCircuitBreakerDecorator::test_decorator_async_function PASSED [ 28%]
tests/unit/core/test_circuit_breaker.py::TestCircuitBreakerDecorator::test_decorator_sync_function PASSED [ 28%]
tests/unit/core/test_circuit_breaker.py::TestGlobalCircuitManager::test_global_manager_exists PASSED [ 29%]
tests/unit/core/test_circuit_breaker.py::TestGlobalCircuitManager::test_github_circuit_breaker_creation FAILED [ 29%]
tests/unit/core/test_circuit_breaker.py::TestGlobalCircuitManager::test_openai_circuit_breaker_creation FAILED [ 29%]
tests/unit/core/test_log_sanitizer.py::TestSensitiveDataFilter::test_api_key_redaction PASSED [ 30%]
tests/unit/core/test_log_sanitizer.py::TestSensitiveDataFilter::test_password_redaction PASSED [ 30%]
tests/unit/core/test_log_sanitizer.py::TestSensitiveDataFilter::test_base64_redaction PASSED [ 31%]
tests/unit/core/test_log_sanitizer.py::TestSensitiveDataFilter::test_header_redaction PASSED [ 31%]
tests/unit/core/test_log_sanitizer.py::TestSensitiveDataFilter::test_email_redaction PASSED [ 31%]
tests/unit/core/test_log_sanitizer.py::TestSensitiveDataFilter::test_database_url_redaction PASSED [ 32%]
tests/unit/core/test_log_sanitizer.py::TestSensitiveDataFilter::test_jwt_token_redaction PASSED [ 32%]
tests/unit/core/test_log_sanitizer.py::TestSensitiveDataFilter::test_aws_credentials_redaction PASSED [ 32%]
tests/unit/core/test_log_sanitizer.py::TestSensitiveDataFilter::test_credit_card_redaction PASSED [ 33%]
tests/unit/core/test_log_sanitizer.py::TestSensitiveDataFilter::test_ssn_redaction PASSED [ 33%]
tests/unit/core/test_log_sanitizer.py::TestSensitiveDataFilter::test_uuid_redaction PASSED [ 34%]
tests/unit/core/test_log_sanitizer.py::TestSensitiveDataFilter::test_full_redact_patterns PASSED [ 34%]
tests/unit/core/test_log_sanitizer.py::TestSensitiveDataFilter::test_mixed_content_redaction PASSED [ 34%]
tests/unit/core/test_log_sanitizer.py::TestSensitiveDataFilter::test_safe_content_not_redacted PASSED [ 35%]
tests/unit/core/test_log_sanitizer.py::TestSensitiveDataFilter::test_exception_info_redaction PASSED [ 35%]
tests/unit/core/test_log_sanitizer.py::TestLogSanitizerFunctions::test_add_sensitive_data_filter_to_logger PASSED [ 35%]
tests/unit/core/test_log_sanitizer.py::TestLogSanitizerFunctions::test_add_sensitive_data_filter_to_root PASSED [ 36%]
tests/unit/core/test_log_sanitizer.py::TestLogSanitizerFunctions::test_configure_secure_logging PASSED [ 36%]
tests/unit/core/test_log_sanitizer.py::TestLogSanitizerIntegration::test_multiple_handlers_with_sanitizer PASSED [ 37%]
tests/unit/core/test_log_sanitizer.py::TestLogSanitizerIntegration::test_logger_hierarchy_with_sanitizer PASSED [ 37%]
tests/unit/integrations/test_commit_analyzer_impact.py::TestCommitAnalyzerImpact::test_analyze_commit_impact_scoring FAILED [ 37%]
tests/unit/integrations/test_commit_analyzer_impact.py::TestCommitAnalyzerImpact::test_analyze_commit_diff_combined_scoring FAILED [ 38%]
tests/unit/integrations/test_commit_analyzer_impact.py::TestCommitAnalyzerImpact::test_impact_score_calculation FAILED [ 38%]
tests/unit/integrations/test_commit_analyzer_impact.py::TestCommitAnalyzerImpact::test_error_handling FAILED [ 39%]
tests/unit/models/test_commit_model.py::test_commit_model_valid PASSED   [ 39%]
tests/unit/models/test_commit_model.py::test_commit_model_missing_required PASSED [ 39%]
tests/unit/models/test_daily_report_models.py::test_ai_analysis_creation_minimal PASSED [ 40%]
tests/unit/models/test_daily_report_models.py::test_ai_analysis_creation_full PASSED [ 40%]
tests/unit/models/test_daily_report_models.py::test_clarification_request_creation_defaults PASSED [ 40%]
tests/unit/models/test_daily_report_models.py::test_clarification_request_creation_with_status PASSED [ 41%]
tests/unit/models/test_daily_report_models.py::test_daily_report_create_fields PASSED [ 41%]
tests/unit/models/test_daily_report_models.py::test_daily_report_create_creation PASSED [ 42%]
tests/unit/models/test_daily_report_models.py::test_daily_report_update_creation_empty PASSED [ 42%]
tests/unit/models/test_daily_report_models.py::test_daily_report_update_creation_with_data PASSED [ 42%]
tests/unit/models/test_daily_report_models.py::test_daily_report_db_model_creation PASSED [ 43%]
tests/unit/models/test_daily_report_models.py::test_daily_report_validation_error PASSED [ 43%]
tests/unit/models/test_daily_report_models.py::test_model_serialization_deserialization PASSED [ 43%]
tests/unit/models/test_github_event_schemas.py::test_commit_payload_valid PASSED [ 44%]
tests/unit/models/test_github_event_schemas.py::test_commit_payload_invalid_url PASSED [ 44%]
tests/unit/models/test_github_event_schemas.py::test_commit_file_data_required PASSED [ 45%]
tests/unit/models/test_github_event_schemas.py::test_commit_detail_missing_field PASSED [ 45%]
tests/unit/models/test_github_event_schemas.py::test_github_repo_valid PASSED [ 45%]
tests/unit/models/test_github_event_schemas.py::test_github_repo_invalid_url PASSED [ 46%]
tests/unit/models/test_github_event_schemas.py::test_github_user_email_validation PASSED [ 46%]
tests/unit/models/test_github_event_schemas.py::test_commit_and_push_event FAILED [ 46%]
tests/unit/models/test_user_model.py::test_user_model_valid_role_coercion PASSED [ 47%]
tests/unit/models/test_user_model.py::test_user_model_invalid_email PASSED [ 47%]
tests/unit/models/test_user_model.py::test_user_model_missing_id PASSED  [ 48%]
tests/unit/repositories/test_commit_repository.py::test_get_existing_commit_hashes_empty_list PASSED [ 48%]
tests/unit/repositories/test_commit_repository.py::test_get_existing_commit_hashes_single_batch FAILED [ 48%]
tests/unit/repositories/test_commit_repository.py::test_get_existing_commit_hashes_multiple_batches FAILED [ 49%]
tests/unit/repositories/test_commit_repository.py::test_get_commits_with_analysis_empty_list PASSED [ 49%]
tests/unit/repositories/test_commit_repository.py::test_get_commits_with_analysis_success FAILED [ 50%]
tests/unit/repositories/test_commit_repository.py::test_get_commits_with_analysis_with_decimal_conversion FAILED [ 50%]
tests/unit/repositories/test_commit_repository.py::test_get_existing_commit_hashes_database_error PASSED [ 50%]
tests/unit/repositories/test_commit_repository.py::test_convert_commit_to_analysis_from_seeder FAILED [ 51%]
tests/unit/repositories/test_commit_repository.py::test_convert_commit_to_analysis_malformed_json FAILED [ 51%]
tests/unit/repositories/test_daily_report_repository.py::test_create_daily_report PASSED [ 51%]
tests/unit/repositories/test_daily_report_repository.py::test_get_daily_report_by_id FAILED [ 52%]
tests/unit/repositories/test_daily_report_repository.py::test_get_daily_report_by_id_not_found FAILED [ 52%]
tests/unit/repositories/test_daily_report_repository.py::test_get_daily_reports_by_user_id FAILED [ 53%]
tests/unit/repositories/test_daily_report_repository.py::test_get_daily_reports_by_user_and_date FAILED [ 53%]
tests/unit/repositories/test_daily_report_repository.py::test_update_daily_report FAILED [ 53%]
tests/unit/repositories/test_daily_report_repository.py::test_update_daily_report_partial FAILED [ 54%]
tests/unit/repositories/test_daily_report_repository.py::test_update_daily_report_not_found FAILED [ 54%]
tests/unit/repositories/test_daily_report_repository.py::test_delete_daily_report FAILED [ 54%]
tests/unit/repositories/test_daily_report_repository.py::test_delete_daily_report_not_found FAILED [ 55%]
tests/unit/repositories/test_daily_report_repository.py::test_get_all_daily_reports FAILED [ 55%]
tests/unit/repositories/test_user_repository.py::test_create_user FAILED [ 56%]
tests/unit/repositories/test_user_repository.py::test_get_user_by_id FAILED [ 56%]
tests/unit/repositories/test_user_repository.py::test_get_user_by_slack_id FAILED [ 56%]
tests/unit/repositories/test_user_repository.py::test_list_users_by_role FAILED [ 57%]
tests/unit/repositories/test_user_repository.py::test_update_user FAILED [ 57%]
tests/unit/services/test_change_analyzer.py::TestDiffParser::test_parse_simple_diff PASSED [ 57%]
tests/unit/services/test_change_analyzer.py::TestDiffParser::test_parse_new_file PASSED [ 58%]
tests/unit/services/test_change_analyzer.py::TestDiffParser::test_parse_deleted_file PASSED [ 58%]
tests/unit/services/test_change_analyzer.py::TestDiffParser::test_parse_multiple_files PASSED [ 59%]
tests/unit/services/test_change_analyzer.py::TestChangeAnalyzer::test_extract_function_symbols PASSED [ 59%]
tests/unit/services/test_change_analyzer.py::TestChangeAnalyzer::test_extract_class_symbols PASSED [ 59%]
tests/unit/services/test_change_analyzer.py::TestChangeAnalyzer::test_extract_endpoints PASSED [ 60%]
tests/unit/services/test_change_analyzer.py::TestChangeAnalyzer::test_extract_config_changes PASSED [ 60%]
tests/unit/services/test_change_analyzer.py::TestChangeAnalyzer::test_identify_breaking_changes PASSED [ 60%]
tests/unit/services/test_change_analyzer.py::TestChangeAnalyzer::test_identify_new_features PASSED [ 61%]
tests/unit/services/test_change_analyzer.py::TestChangeAnalyzer::test_categorize_changes PASSED [ 61%]
tests/unit/services/test_change_analyzer.py::TestChangeAnalyzer::test_calculate_impact_score PASSED [ 62%]
tests/unit/services/test_change_analyzer.py::TestChangeAnalyzer::test_extract_migrations PASSED [ 62%]
tests/unit/services/test_change_analyzer.py::TestChangeAnalyzer::test_private_vs_public_symbols PASSED [ 62%]
tests/unit/services/test_commit_analysis_service.py::test_process_commit_new_commit_success ERROR [ 63%]
tests/unit/services/test_commit_analysis_service.py::test_process_commit_existing_needs_analysis ERROR [ 63%]
tests/unit/services/test_commit_analysis_service.py::test_process_commit_already_processed ERROR [ 64%]
tests/unit/services/test_commit_analysis_service.py::test_process_commit_user_not_found ERROR [ 64%]
tests/unit/services/test_commit_analysis_service.py::test_process_commit_create_fails ERROR [ 64%]
tests/unit/services/test_commit_analysis_service.py::test_process_commit_update_fails ERROR [ 65%]
tests/unit/services/test_daily_commit_analysis_service.py::test_analyze_for_report_new_analysis ERROR [ 65%]
tests/unit/services/test_daily_commit_analysis_service.py::test_analyze_for_report_existing_analysis ERROR [ 65%]
tests/unit/services/test_daily_commit_analysis_service.py::test_analyze_for_report_no_commits ERROR [ 66%]
tests/unit/services/test_daily_commit_analysis_service.py::test_analyze_for_date_automatic FAILED [ 66%]
tests/unit/services/test_daily_commit_analysis_service.py::test_run_midnight_analysis FAILED [ 67%]
tests/unit/services/test_daily_commit_analysis_service.py::test_prepare_analysis_context ERROR [ 67%]
tests/unit/services/test_daily_commit_analysis_service.py::test_get_user_analysis_history FAILED [ 67%]
tests/unit/services/test_daily_commit_analysis_service.py::test_init_service PASSED [ 68%]
tests/unit/services/test_daily_report_service.py::test_submit_daily_report_new FAILED [ 68%]
tests/unit/services/test_daily_report_service.py::test_submit_daily_report_existing FAILED [ 68%]
tests/unit/services/test_daily_report_service.py::test_submit_daily_report_ai_processing_fails FAILED [ 69%]
tests/unit/services/test_daily_report_service.py::test_get_report_by_id PASSED [ 69%]
tests/unit/services/test_daily_report_service.py::test_get_report_by_id_not_found PASSED [ 70%]
tests/unit/services/test_daily_report_service.py::test_get_reports_for_user PASSED [ 70%]
tests/unit/services/test_daily_report_service.py::test_get_user_report_for_date PASSED [ 70%]
tests/unit/services/test_daily_report_service.py::test_update_report_assessment PASSED [ 71%]
tests/unit/services/test_daily_report_service.py::test_link_commits_to_report PASSED [ 71%]
tests/unit/services/test_daily_report_service.py::test_link_commits_to_report_no_initial_commits PASSED [ 71%]
tests/unit/services/test_daily_report_service.py::test_link_commits_to_report_non_existent_report PASSED [ 72%]
tests/unit/services/test_daily_report_service.py::test_submit_daily_report_update_fails_after_get_existing FAILED [ 72%]
tests/unit/services/test_daily_report_service.py::test_submit_daily_report_ai_update_fails_after_successful_first_update FAILED [ 73%]
tests/unit/services/test_daily_report_service.py::test_submit_daily_report_ai_service_exception FAILED [ 73%]
tests/unit/services/test_deduplication_service.py::TestDeduplicationService::test_find_duplicates_high_confidence ERROR [ 73%]
tests/unit/services/test_deduplication_service.py::TestDeduplicationService::test_find_duplicates_no_matches ERROR [ 74%]
tests/unit/services/test_deduplication_service.py::TestDeduplicationService::test_apply_deduplication_rules FAILED [ 74%]
tests/unit/services/test_deduplication_service.py::TestDeduplicationService::test_deduplication_with_time_correlation FAILED [ 75%]
tests/unit/services/test_deduplication_service.py::TestDeduplicationService::test_weekly_aggregation ERROR [ 75%]
tests/unit/services/test_deduplication_service.py::TestDeduplicationService::test_deduplication_result_persistence FAILED [ 75%]
tests/unit/services/test_deduplication_service.py::TestDeduplicationService::test_handle_empty_inputs FAILED [ 76%]
tests/unit/services/test_deduplication_service.py::TestDeduplicationService::test_ai_similarity_error_handling ERROR [ 76%]
tests/unit/services/test_deduplication_service.py::TestDeduplicationService::test_complex_deduplication_scenario FAILED [ 76%]
tests/unit/services/test_unified_daily_analysis_service.py::TestUnifiedDailyAnalysisService::test_analyze_daily_work_with_commits_and_report FAILED [ 77%]
tests/unit/services/test_unified_daily_analysis_service.py::TestUnifiedDailyAnalysisService::test_analyze_daily_work_commits_only FAILED [ 77%]
tests/unit/services/test_unified_daily_analysis_service.py::TestUnifiedDailyAnalysisService::test_analyze_daily_work_report_only FAILED [ 78%]
tests/unit/services/test_unified_daily_analysis_service.py::TestUnifiedDailyAnalysisService::test_analyze_daily_work_no_activity FAILED [ 78%]
tests/unit/services/test_unified_daily_analysis_service.py::TestUnifiedDailyAnalysisService::test_analyze_daily_work_existing_analysis FAILED [ 78%]
tests/unit/services/test_unified_daily_analysis_service.py::TestUnifiedDailyAnalysisService::test_analyze_daily_work_force_reanalysis FAILED [ 79%]
tests/unit/services/test_unified_daily_analysis_service.py::TestUnifiedDailyAnalysisService::test_parse_ai_response_validation FAILED [ 79%]
tests/unit/services/test_unified_daily_analysis_service.py::TestUnifiedDailyAnalysisService::test_ai_error_handling FAILED [ 79%]
tests/unit/services/test_unified_daily_analysis_service.py::TestUnifiedDailyAnalysisService::test_get_weekly_aggregate FAILED [ 80%]
tests/unit/services/test_unified_daily_analysis_service.py::TestUnifiedDailyAnalysisService::test_handle_clarification_needed FAILED [ 80%]
tests/unit/services/test_unified_daily_analysis_service.py::TestUnifiedDailyAnalysisService::test_provide_clarification FAILED [ 81%]
tests/unit/services/test_unified_daily_analysis_service.py::TestUnifiedDailyAnalysisService::test_deduplication_in_prompt FAILED [ 81%]
tests/unit/test_ai_integration_v2.py::TestAIIntegrationV2::test_init_with_api_key PASSED [ 81%]
tests/unit/test_ai_integration_v2.py::TestAIIntegrationV2::test_init_without_api_key PASSED [ 82%]
tests/unit/test_ai_integration_v2.py::TestAIIntegrationV2::test_make_completion_request PASSED [ 82%]
tests/unit/test_ai_integration_v2.py::TestAIIntegrationV2::test_make_completion_request_with_json PASSED [ 82%]
tests/unit/test_ai_integration_v2.py::TestAIIntegrationV2::test_make_completion_request_no_client PASSED [ 83%]
tests/unit/test_ai_integration_v2.py::TestAIIntegrationV2::test_analyze_commit_diff PASSED [ 83%]
tests/unit/test_ai_integration_v2.py::TestAIIntegrationV2::test_analyze_commit_diff_no_diff PASSED [ 84%]
tests/unit/test_ai_integration_v2.py::TestAIIntegrationV2::test_generate_documentation PASSED [ 84%]
tests/unit/test_ai_integration_v2.py::TestAIIntegrationV2::test_analyze_eod_report PASSED [ 84%]
tests/unit/test_ai_integration_v2.py::TestAIIntegrationV2::test_analyze_code_quality PASSED [ 85%]
tests/unit/test_ai_integration_v2.py::TestAIIntegrationV2::test_analyze_semantic_similarity PASSED [ 85%]
tests/unit/test_ai_integration_v2.py::TestAIIntegrationV2::test_analyze_daily_work PASSED [ 85%]
tests/unit/test_ai_integration_v2.py::TestAIIntegrationV2::test_error_handling_json_decode PASSED [ 86%]
tests/unit/test_ai_integration_v2.py::TestAIIntegrationV2::test_error_handling_api_error PASSED [ 86%]
tests/unit/test_ai_integration_v2.py::TestAIIntegrationV2::test_analyze_eod_report_text PASSED [ 87%]
tests/unit/test_ai_integration_v2.py::TestAIIntegrationV2::test_check_if_clarification_needed_prefilled PASSED [ 87%]
tests/unit/test_ai_integration_v2.py::TestAIIntegrationV2::test_check_if_clarification_needed_llm PASSED [ 87%]
tests/unit/test_ai_integration_v2.py::TestAIIntegrationV2::test_process_eod_clarification PASSED [ 88%]
tests/unit/test_ai_integration_v2.py::TestAIIntegrationV2::test_analyze_commit_code_quality_legacy PASSED [ 88%]
tests/unit/test_ai_integration_v2.py::TestAIIntegrationV2::test_generate_development_task_content PASSED [ 89%]
tests/unit/test_github_app.py::TestGitHubApp::test_init PASSED           [ 89%]
tests/unit/test_github_app.py::TestGitHubApp::test_generate_jwt PASSED   [ 89%]
tests/unit/test_github_app.py::TestGitHubApp::test_generate_jwt_missing_credentials PASSED [ 90%]
tests/unit/test_github_app.py::TestGitHubApp::test_get_installation_token PASSED [ 90%]
tests/unit/test_github_app.py::TestGitHubApp::test_get_installation_token_cached PASSED [ 90%]
tests/unit/test_github_app.py::TestGitHubApp::test_verify_webhook_valid PASSED [ 91%]
tests/unit/test_github_app.py::TestGitHubApp::test_verify_webhook_invalid PASSED [ 91%]
tests/unit/test_github_app.py::TestGitHubApp::test_verify_webhook_no_secret PASSED [ 92%]
tests/unit/test_github_app.py::TestGitHubApp::test_create_pull_request PASSED [ 92%]
tests/unit/test_github_app.py::TestGitHubApp::test_create_check_run PASSED [ 92%]
tests/unit/test_github_app.py::TestGitHubApp::test_update_check_run PASSED [ 93%]
tests/unit/test_github_app.py::TestGitHubApp::test_get_file_contents PASSED [ 93%]
tests/unit/test_github_app.py::TestGitHubApp::test_create_or_update_file PASSED [ 93%]
tests/unit/test_github_app.py::TestGitHubApp::test_get_pull_request_diff PASSED [ 94%]
tests/unit/test_no_cors.py::test_cors_headers_not_present PASSED         [ 94%]
tests/unit/webhooks/test_github_webhook.py::TestGitHubWebhookHandler::test_verify_signature_valid PASSED [ 95%]
tests/unit/webhooks/test_github_webhook.py::TestGitHubWebhookHandler::test_verify_signature_invalid PASSED [ 95%]
tests/unit/webhooks/test_github_webhook.py::TestGitHubWebhookHandler::test_verify_signature_missing PASSED [ 95%]
tests/unit/webhooks/test_github_webhook.py::TestGitHubWebhookHandler::test_verify_signature_wrong_format PASSED [ 96%]
tests/unit/webhooks/test_github_webhook.py::TestGitHubWebhookHandler::test_extract_event_type PASSED [ 96%]
tests/unit/webhooks/test_github_webhook.py::TestGitHubWebhookHandler::test_extract_event_type_missing PASSED [ 96%]
tests/unit/webhooks/test_github_webhook.py::TestGitHubWebhookHandler::test_process_event_non_push PASSED [ 97%]
tests/unit/webhooks/test_github_webhook.py::TestGitHubWebhookHandler::test_process_push_event_success PASSED [ 97%]
tests/unit/webhooks/test_github_webhook.py::TestGitHubWebhookHandler::test_process_push_event_with_merge_commits PASSED [ 98%]
tests/unit/webhooks/test_github_webhook.py::TestGitHubWebhookHandler::test_process_push_event_analysis_failure PASSED [ 98%]
tests/unit/webhooks/test_github_webhook.py::TestGitHubWebhookHandler::test_process_push_event_exception PASSED [ 98%]
tests/unit/webhooks/test_github_webhook.py::TestGitHubWebhookHandler::test_process_push_event_no_commits PASSED [ 99%]
tests/unit/webhooks/test_github_webhook.py::TestGitHubWebhookHandler::test_convert_to_commit_payload PASSED [ 99%]
tests/unit/webhooks/test_github_webhook.py::TestGitHubWebhookHandler::test_convert_to_commit_payload_minimal PASSED [100%]

==================================== ERRORS ====================================
___________ ERROR at setup of test_process_commit_new_commit_success ___________
tests/unit/services/test_commit_analysis_service.py:89: in test_user
    user = User(
E   pydantic_core._pydantic_core.ValidationError: 2 validation errors for User
E   created_at
E     Field required [type=missing, input_value={'id': UUID('3914521c-16a...om', 'slack_id': 'U123'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   updated_at
E     Field required [type=missing, input_value={'id': UUID('3914521c-16a...om', 'slack_id': 'U123'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
---------------------------- Captured stderr setup -----------------------------
2025-09-05 12:00:31,969 - app.integrations.ai_integration_v2 - INFO - AIIntegrationV2 initialized. Model: gpt-5-2025-08-07
2025-09-05 12:00:31,972 - app.integrations.ai_integration_v2 - INFO - AIIntegrationV2 initialized. Model: gpt-5-2025-08-07
2025-09-05 12:00:31,975 - app.integrations.ai_integration_v2 - INFO - AIIntegrationV2 initialized. Model: gpt-5-2025-08-07
------------------------------ Captured log setup ------------------------------
INFO     app.integrations.ai_integration_v2:ai_integration_v2.py:36 AIIntegrationV2 initialized. Model: gpt-5-2025-08-07
INFO     app.integrations.ai_integration_v2:ai_integration_v2.py:36 AIIntegrationV2 initialized. Model: gpt-5-2025-08-07
INFO     app.integrations.ai_integration_v2:ai_integration_v2.py:36 AIIntegrationV2 initialized. Model: gpt-5-2025-08-07
________ ERROR at setup of test_process_commit_existing_needs_analysis _________
tests/unit/services/test_commit_analysis_service.py:89: in test_user
    user = User(
E   pydantic_core._pydantic_core.ValidationError: 2 validation errors for User
E   created_at
E     Field required [type=missing, input_value={'id': UUID('5c0c666a-b58...om', 'slack_id': 'U123'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   updated_at
E     Field required [type=missing, input_value={'id': UUID('5c0c666a-b58...om', 'slack_id': 'U123'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
---------------------------- Captured stderr setup -----------------------------
2025-09-05 12:00:31,982 - app.integrations.ai_integration_v2 - INFO - AIIntegrationV2 initialized. Model: gpt-5-2025-08-07
2025-09-05 12:00:31,985 - app.integrations.ai_integration_v2 - INFO - AIIntegrationV2 initialized. Model: gpt-5-2025-08-07
2025-09-05 12:00:31,988 - app.integrations.ai_integration_v2 - INFO - AIIntegrationV2 initialized. Model: gpt-5-2025-08-07
------------------------------ Captured log setup ------------------------------
INFO     app.integrations.ai_integration_v2:ai_integration_v2.py:36 AIIntegrationV2 initialized. Model: gpt-5-2025-08-07
INFO     app.integrations.ai_integration_v2:ai_integration_v2.py:36 AIIntegrationV2 initialized. Model: gpt-5-2025-08-07
INFO     app.integrations.ai_integration_v2:ai_integration_v2.py:36 AIIntegrationV2 initialized. Model: gpt-5-2025-08-07
___________ ERROR at setup of test_process_commit_already_processed ____________
tests/unit/services/test_commit_analysis_service.py:89: in test_user
    user = User(
E   pydantic_core._pydantic_core.ValidationError: 2 validation errors for User
E   created_at
E     Field required [type=missing, input_value={'id': UUID('656ff527-c40...om', 'slack_id': 'U123'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   updated_at
E     Field required [type=missing, input_value={'id': UUID('656ff527-c40...om', 'slack_id': 'U123'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
---------------------------- Captured stderr setup -----------------------------
2025-09-05 12:00:31,995 - app.integrations.ai_integration_v2 - INFO - AIIntegrationV2 initialized. Model: gpt-5-2025-08-07
2025-09-05 12:00:31,998 - app.integrations.ai_integration_v2 - INFO - AIIntegrationV2 initialized. Model: gpt-5-2025-08-07
2025-09-05 12:00:32,001 - app.integrations.ai_integration_v2 - INFO - AIIntegrationV2 initialized. Model: gpt-5-2025-08-07
------------------------------ Captured log setup ------------------------------
INFO     app.integrations.ai_integration_v2:ai_integration_v2.py:36 AIIntegrationV2 initialized. Model: gpt-5-2025-08-07
INFO     app.integrations.ai_integration_v2:ai_integration_v2.py:36 AIIntegrationV2 initialized. Model: gpt-5-2025-08-07
INFO     app.integrations.ai_integration_v2:ai_integration_v2.py:36 AIIntegrationV2 initialized. Model: gpt-5-2025-08-07
_____________ ERROR at setup of test_process_commit_user_not_found _____________
tests/unit/services/test_commit_analysis_service.py:89: in test_user
    user = User(
E   pydantic_core._pydantic_core.ValidationError: 2 validation errors for User
E   created_at
E     Field required [type=missing, input_value={'id': UUID('5599040d-979...om', 'slack_id': 'U123'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   updated_at
E     Field required [type=missing, input_value={'id': UUID('5599040d-979...om', 'slack_id': 'U123'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
---------------------------- Captured stderr setup -----------------------------
2025-09-05 12:00:32,007 - app.integrations.ai_integration_v2 - INFO - AIIntegrationV2 initialized. Model: gpt-5-2025-08-07
2025-09-05 12:00:32,011 - app.integrations.ai_integration_v2 - INFO - AIIntegrationV2 initialized. Model: gpt-5-2025-08-07
2025-09-05 12:00:32,014 - app.integrations.ai_integration_v2 - INFO - AIIntegrationV2 initialized. Model: gpt-5-2025-08-07
------------------------------ Captured log setup ------------------------------
INFO     app.integrations.ai_integration_v2:ai_integration_v2.py:36 AIIntegrationV2 initialized. Model: gpt-5-2025-08-07
INFO     app.integrations.ai_integration_v2:ai_integration_v2.py:36 AIIntegrationV2 initialized. Model: gpt-5-2025-08-07
INFO     app.integrations.ai_integration_v2:ai_integration_v2.py:36 AIIntegrationV2 initialized. Model: gpt-5-2025-08-07
______________ ERROR at setup of test_process_commit_create_fails ______________
tests/unit/services/test_commit_analysis_service.py:89: in test_user
    user = User(
E   pydantic_core._pydantic_core.ValidationError: 2 validation errors for User
E   created_at
E     Field required [type=missing, input_value={'id': UUID('1bd73634-60e...om', 'slack_id': 'U123'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   updated_at
E     Field required [type=missing, input_value={'id': UUID('1bd73634-60e...om', 'slack_id': 'U123'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
---------------------------- Captured stderr setup -----------------------------
2025-09-05 12:00:32,020 - app.integrations.ai_integration_v2 - INFO - AIIntegrationV2 initialized. Model: gpt-5-2025-08-07
2025-09-05 12:00:32,023 - app.integrations.ai_integration_v2 - INFO - AIIntegrationV2 initialized. Model: gpt-5-2025-08-07
2025-09-05 12:00:32,026 - app.integrations.ai_integration_v2 - INFO - AIIntegrationV2 initialized. Model: gpt-5-2025-08-07
------------------------------ Captured log setup ------------------------------
INFO     app.integrations.ai_integration_v2:ai_integration_v2.py:36 AIIntegrationV2 initialized. Model: gpt-5-2025-08-07
INFO     app.integrations.ai_integration_v2:ai_integration_v2.py:36 AIIntegrationV2 initialized. Model: gpt-5-2025-08-07
INFO     app.integrations.ai_integration_v2:ai_integration_v2.py:36 AIIntegrationV2 initialized. Model: gpt-5-2025-08-07
______________ ERROR at setup of test_process_commit_update_fails ______________
tests/unit/services/test_commit_analysis_service.py:89: in test_user
    user = User(
E   pydantic_core._pydantic_core.ValidationError: 2 validation errors for User
E   created_at
E     Field required [type=missing, input_value={'id': UUID('31455dc0-ff9...om', 'slack_id': 'U123'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   updated_at
E     Field required [type=missing, input_value={'id': UUID('31455dc0-ff9...om', 'slack_id': 'U123'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
---------------------------- Captured stderr setup -----------------------------
2025-09-05 12:00:32,033 - app.integrations.ai_integration_v2 - INFO - AIIntegrationV2 initialized. Model: gpt-5-2025-08-07
2025-09-05 12:00:32,036 - app.integrations.ai_integration_v2 - INFO - AIIntegrationV2 initialized. Model: gpt-5-2025-08-07
2025-09-05 12:00:32,039 - app.integrations.ai_integration_v2 - INFO - AIIntegrationV2 initialized. Model: gpt-5-2025-08-07
------------------------------ Captured log setup ------------------------------
INFO     app.integrations.ai_integration_v2:ai_integration_v2.py:36 AIIntegrationV2 initialized. Model: gpt-5-2025-08-07
INFO     app.integrations.ai_integration_v2:ai_integration_v2.py:36 AIIntegrationV2 initialized. Model: gpt-5-2025-08-07
INFO     app.integrations.ai_integration_v2:ai_integration_v2.py:36 AIIntegrationV2 initialized. Model: gpt-5-2025-08-07
____________ ERROR at setup of test_analyze_for_report_new_analysis ____________
tests/unit/services/test_daily_commit_analysis_service.py:86: in sample_daily_report
    return DailyReport(
E   pydantic_core._pydantic_core.ValidationError: 1 validation error for DailyReport
E   raw_text_input
E     Field required [type=missing, input_value={'id': UUID('935a2623-36f...etime.date(2025, 1, 15)}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
_________ ERROR at setup of test_analyze_for_report_existing_analysis __________
tests/unit/services/test_daily_commit_analysis_service.py:86: in sample_daily_report
    return DailyReport(
E   pydantic_core._pydantic_core.ValidationError: 1 validation error for DailyReport
E   raw_text_input
E     Field required [type=missing, input_value={'id': UUID('5b0f90f8-152...etime.date(2025, 1, 15)}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
_____________ ERROR at setup of test_analyze_for_report_no_commits _____________
tests/unit/services/test_daily_commit_analysis_service.py:86: in sample_daily_report
    return DailyReport(
E   pydantic_core._pydantic_core.ValidationError: 1 validation error for DailyReport
E   raw_text_input
E     Field required [type=missing, input_value={'id': UUID('bbe1849b-c3d...etime.date(2025, 1, 15)}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
_______________ ERROR at setup of test_prepare_analysis_context ________________
tests/unit/services/test_daily_commit_analysis_service.py:86: in sample_daily_report
    return DailyReport(
E   pydantic_core._pydantic_core.ValidationError: 1 validation error for DailyReport
E   raw_text_input
E     Field required [type=missing, input_value={'id': UUID('b0c3193b-222...etime.date(2025, 1, 15)}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
_ ERROR at setup of TestDeduplicationService.test_find_duplicates_high_confidence _
tests/unit/services/test_deduplication_service.py:54: in sample_commits
    Commit(
E   pydantic_core._pydantic_core.ValidationError: 1 validation error for Commit
E   commit_timestamp
E     Field required [type=missing, input_value={'id': UUID('027457f3-cad...tication', 'security']}}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
---------------------------- Captured stderr setup -----------------------------
2025-09-05 12:00:33,438 - app.integrations.ai_integration_v2 - INFO - AIIntegrationV2 initialized. Model: gpt-5-2025-08-07
------------------------------ Captured log setup ------------------------------
INFO     app.integrations.ai_integration_v2:ai_integration_v2.py:36 AIIntegrationV2 initialized. Model: gpt-5-2025-08-07
__ ERROR at setup of TestDeduplicationService.test_find_duplicates_no_matches __
tests/unit/services/test_deduplication_service.py:54: in sample_commits
    Commit(
E   pydantic_core._pydantic_core.ValidationError: 1 validation error for Commit
E   commit_timestamp
E     Field required [type=missing, input_value={'id': UUID('04247314-b45...tication', 'security']}}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
---------------------------- Captured stderr setup -----------------------------
2025-09-05 12:00:33,447 - app.integrations.ai_integration_v2 - INFO - AIIntegrationV2 initialized. Model: gpt-5-2025-08-07
------------------------------ Captured log setup ------------------------------
INFO     app.integrations.ai_integration_v2:ai_integration_v2.py:36 AIIntegrationV2 initialized. Model: gpt-5-2025-08-07
______ ERROR at setup of TestDeduplicationService.test_weekly_aggregation ______
tests/unit/services/test_deduplication_service.py:44: in sample_user
    return User(id=uuid4(), email="developer@test.com", name="Test Developer", role=UserRole.EMPLOYEE, is_active=True)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   pydantic_core._pydantic_core.ValidationError: 2 validation errors for User
E   created_at
E     Field required [type=missing, input_value={'id': UUID('17d8df54-937...ee'>, 'is_active': True}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   updated_at
E     Field required [type=missing, input_value={'id': UUID('17d8df54-937...ee'>, 'is_active': True}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
---------------------------- Captured stderr setup -----------------------------
2025-09-05 12:00:33,470 - app.integrations.ai_integration_v2 - INFO - AIIntegrationV2 initialized. Model: gpt-5-2025-08-07
------------------------------ Captured log setup ------------------------------
INFO     app.integrations.ai_integration_v2:ai_integration_v2.py:36 AIIntegrationV2 initialized. Model: gpt-5-2025-08-07
_ ERROR at setup of TestDeduplicationService.test_ai_similarity_error_handling _
tests/unit/services/test_deduplication_service.py:54: in sample_commits
    Commit(
E   pydantic_core._pydantic_core.ValidationError: 1 validation error for Commit
E   commit_timestamp
E     Field required [type=missing, input_value={'id': UUID('34241204-8ba...tication', 'security']}}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
---------------------------- Captured stderr setup -----------------------------
2025-09-05 12:00:33,488 - app.integrations.ai_integration_v2 - INFO - AIIntegrationV2 initialized. Model: gpt-5-2025-08-07
------------------------------ Captured log setup ------------------------------
INFO     app.integrations.ai_integration_v2:ai_integration_v2.py:36 AIIntegrationV2 initialized. Model: gpt-5-2025-08-07
=================================== FAILURES ===================================
__________________ TestRequestMetrics.test_metrics_collection __________________
tests/unit/api/test_api_gateway.py:190: in test_metrics_collection
    assert len(captured_middleware) > 0
E   assert 0 > 0
E    +  where 0 = len([])
----------------------------- Captured stderr call -----------------------------
2025-09-05 12:00:31,044 - app.middleware.request_metrics - INFO - Request: GET /test - Status: 200 - Duration: 0.5000s
2025-09-05 12:00:31,045 - httpx - INFO - HTTP Request: GET http://testserver/test "HTTP/1.1 200 OK"
------------------------------ Captured log call -------------------------------
INFO     app.middleware.request_metrics:request_metrics.py:50 Request: GET /test - Status: 200 - Duration: 0.5000s
INFO     httpx:_client.py:1025 HTTP Request: GET http://testserver/test "HTTP/1.1 200 OK"
________________ test_login_returns_token_with_mocked_supabase _________________
tests/unit/api/test_auth_endpoints.py:29: in test_login_returns_token_with_mocked_supabase
    assert resp.status_code == 200
E   assert 401 == 200
E    +  where 401 = <Response [401 Unauthorized]>.status_code
---------------------------- Captured stderr setup -----------------------------
2025-09-05 12:00:31,097 - app.main - INFO - Supabase client initialized
------------------------------ Captured log setup ------------------------------
INFO     app.main:main.py:133 Supabase client initialized
----------------------------- Captured stderr call -----------------------------
2025-09-05 12:00:31,120 - app.api.auth_endpoints - INFO - Attempting login for email: EMAIL_REDACTED
2025-09-05 12:00:31,461 - httpx - INFO - HTTP Request: POST https://xfnxafbsmqowzvuwmhvi.supabase.co//auth/v1/token?grant_type=password "HTTP/2 400 Bad Request"
2025-09-05 12:00:31,462 - app.api.auth_endpoints - WARNING - Invalid login credentials for EMAIL_REDACTED: Invalid login credentials
2025-09-05 12:00:31,463 - app.core.error_handlers - ERROR - Application error: Incorrect email or password
Traceback (most recent call last):
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/gotrue/_sync/gotrue_base_api.py", line 120, in _request
    response.raise_for_status()
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/httpx/_models.py", line 829, in raise_for_status
    raise HTTPStatusError(message, request=request, response=self)
httpx.HTTPStatusError: Client error '400 Bad Request' for url 'https://xfnxafbsmqowzvuwmhvi.supabase.co//auth/v1/token?grant_type=password'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/400

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/parkerbeard/golfdaddy-brain/backend/app/api/auth_endpoints.py", line 47, in login_user
    response = supabase.auth.sign_in_with_password({"email": request.email, "password": request.password})
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/gotrue/_sync/gotrue_client.py", line 271, in sign_in_with_password
    response = self._request(
        "POST",
    ...<12 lines>...
        xform=parse_auth_response,
    )
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/gotrue/_sync/gotrue_base_api.py", line 125, in _request
    raise handle_exception(e)
gotrue.errors.AuthApiError: Invalid login credentials

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/starlette/routing.py", line 75, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/fastapi/routing.py", line 302, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/fastapi/routing.py", line 213, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/parkerbeard/golfdaddy-brain/backend/app/api/auth_endpoints.py", line 67, in login_user
    raise AuthenticationError(message="Incorrect email or password")
app.core.exceptions.AuthenticationError: Incorrect email or password
2025-09-05 12:00:31,467 - app.middleware.request_metrics - INFO - Request: POST /auth/login - Status: 401 - Duration: 0.3687s
2025-09-05 12:00:31,467 - httpx - INFO - HTTP Request: POST http://testserver/auth/login "HTTP/1.1 401 Unauthorized"
------------------------------ Captured log call -------------------------------
INFO     app.api.auth_endpoints:auth_endpoints.py:45 Attempting login for email: EMAIL_REDACTED
INFO     httpx:_client.py:1025 HTTP Request: POST https://xfnxafbsmqowzvuwmhvi.supabase.co//auth/v1/token?grant_type=password "HTTP/2 400 Bad Request"
WARNING  app.api.auth_endpoints:auth_endpoints.py:66 Invalid login credentials for EMAIL_REDACTED: Invalid login credentials
ERROR    app.core.error_handlers:error_handlers.py:14 Application error: Incorrect email or password
Traceback (most recent call last):
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/gotrue/_sync/gotrue_base_api.py", line 120, in _request
    response.raise_for_status()
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/httpx/_models.py", line 829, in raise_for_status
    raise HTTPStatusError(message, request=request, response=self)
httpx.HTTPStatusError: Client error '400 Bad Request' for url 'https://xfnxafbsmqowzvuwmhvi.supabase.co//auth/v1/token?grant_type=password'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/400

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/parkerbeard/golfdaddy-brain/backend/app/api/auth_endpoints.py", line 47, in login_user
    response = supabase.auth.sign_in_with_password({"email": request.email, "password": request.password})
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/gotrue/_sync/gotrue_client.py", line 271, in sign_in_with_password
    response = self._request(
        "POST",
    ...<12 lines>...
        xform=parse_auth_response,
    )
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/gotrue/_sync/gotrue_base_api.py", line 125, in _request
    raise handle_exception(e)
gotrue.errors.AuthApiError: Invalid login credentials

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/starlette/routing.py", line 75, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/fastapi/routing.py", line 302, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/fastapi/routing.py", line 213, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/parkerbeard/golfdaddy-brain/backend/app/api/auth_endpoints.py", line 67, in login_user
    raise AuthenticationError(message="Incorrect email or password")
app.core.exceptions.AuthenticationError: Incorrect email or password
INFO     app.middleware.request_metrics:request_metrics.py:50 Request: POST /auth/login - Status: 401 - Duration: 0.3687s
INFO     httpx:_client.py:1025 HTTP Request: POST http://testserver/auth/login "HTTP/1.1 401 Unauthorized"
________ TestBasicAuth.test_api_endpoint_requires_api_key_when_enabled _________
tests/unit/api/test_basic_auth.py:43: in test_api_endpoint_requires_api_key_when_enabled
    assert response.status_code == 401
E   assert 422 == 401
E    +  where 422 = <Response [422 Unprocessable Entity]>.status_code
----------------------------- Captured stderr call -----------------------------
2025-09-05 12:00:31,489 - app.core.error_handlers - ERROR - Validation error: [{'type': 'missing', 'loc': ('header', 'authorization'), 'msg': 'Field required', 'input': None}]
Traceback (most recent call last):
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/starlette/routing.py", line 75, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/fastapi/routing.py", line 347, in app
    raise validation_error
fastapi.exceptions.RequestValidationError: [{'type': 'missing', 'loc': ('header', 'authorization'), 'msg': 'Field required', 'input': None}]
2025-09-05 12:00:31,492 - app.middleware.request_metrics - INFO - Request: GET /api/v1/users - Status: 422 - Duration: 0.0034s
2025-09-05 12:00:31,493 - httpx - INFO - HTTP Request: GET http://testserver/api/v1/users "HTTP/1.1 422 Unprocessable Entity"
------------------------------ Captured log call -------------------------------
ERROR    app.core.error_handlers:error_handlers.py:40 Validation error: [{'type': 'missing', 'loc': ('header', 'authorization'), 'msg': 'Field required', 'input': None}]
Traceback (most recent call last):
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/starlette/routing.py", line 75, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/fastapi/routing.py", line 347, in app
    raise validation_error
fastapi.exceptions.RequestValidationError: [{'type': 'missing', 'loc': ('header', 'authorization'), 'msg': 'Field required', 'input': None}]
INFO     app.middleware.request_metrics:request_metrics.py:50 Request: GET /api/v1/users - Status: 422 - Duration: 0.0034s
INFO     httpx:_client.py:1025 HTTP Request: GET http://testserver/api/v1/users "HTTP/1.1 422 Unprocessable Entity"
________________________ test_submit_eod_report_success ________________________
tests/unit/api/test_daily_report_endpoints.py:72: in test_submit_eod_report_success
    response = await async_client.post(f"{BASE_URL}/", json=report_create_data)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   TypeError: object Response can't be used in 'await' expression
---------------------------- Captured stderr setup -----------------------------
2025-09-05 12:00:31,537 - app.main - INFO - Supabase client initialized
------------------------------ Captured log setup ------------------------------
INFO     app.main:main.py:133 Supabase client initialized
----------------------------- Captured stderr call -----------------------------
2025-09-05 12:00:31,538 - app.core.error_handlers - ERROR - HTTP error: Not Found
Traceback (most recent call last):
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/starlette/routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/starlette/routing.py", line 766, in app
    await self.default(scope, receive, send)
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/starlette/routing.py", line 652, in not_found
    raise HTTPException(status_code=404)
starlette.exceptions.HTTPException: 404: Not Found
2025-09-05 12:00:31,542 - app.middleware.request_metrics - INFO - Request: POST /reports/daily/ - Status: 404 - Duration: 0.0048s
2025-09-05 12:00:31,543 - httpx - INFO - HTTP Request: POST http://testserver/reports/daily/ "HTTP/1.1 404 Not Found"
------------------------------ Captured log call -------------------------------
ERROR    app.core.error_handlers:error_handlers.py:27 HTTP error: Not Found
Traceback (most recent call last):
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/starlette/routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/starlette/routing.py", line 766, in app
    await self.default(scope, receive, send)
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/starlette/routing.py", line 652, in not_found
    raise HTTPException(status_code=404)
starlette.exceptions.HTTPException: 404: Not Found
INFO     app.middleware.request_metrics:request_metrics.py:50 Request: POST /reports/daily/ - Status: 404 - Duration: 0.0048s
INFO     httpx:_client.py:1025 HTTP Request: POST http://testserver/reports/daily/ "HTTP/1.1 404 Not Found"
___________________ test_submit_eod_report_service_exception ___________________
tests/unit/api/test_daily_report_endpoints.py:91: in test_submit_eod_report_service_exception
    response = await async_client.post(f"{BASE_URL}/", json=report_create_data)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   TypeError: object Response can't be used in 'await' expression
---------------------------- Captured stderr setup -----------------------------
2025-09-05 12:00:31,547 - app.main - INFO - Supabase client initialized
------------------------------ Captured log setup ------------------------------
INFO     app.main:main.py:133 Supabase client initialized
----------------------------- Captured stderr call -----------------------------
2025-09-05 12:00:31,547 - app.core.error_handlers - ERROR - HTTP error: Not Found
Traceback (most recent call last):
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/starlette/routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/starlette/routing.py", line 766, in app
    await self.default(scope, receive, send)
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/starlette/routing.py", line 652, in not_found
    raise HTTPException(status_code=404)
starlette.exceptions.HTTPException: 404: Not Found
2025-09-05 12:00:31,552 - app.middleware.request_metrics - INFO - Request: POST /reports/daily/ - Status: 404 - Duration: 0.0046s
2025-09-05 12:00:31,552 - httpx - INFO - HTTP Request: POST http://testserver/reports/daily/ "HTTP/1.1 404 Not Found"
------------------------------ Captured log call -------------------------------
ERROR    app.core.error_handlers:error_handlers.py:27 HTTP error: Not Found
Traceback (most recent call last):
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/starlette/routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/starlette/routing.py", line 766, in app
    await self.default(scope, receive, send)
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/starlette/routing.py", line 652, in not_found
    raise HTTPException(status_code=404)
starlette.exceptions.HTTPException: 404: Not Found
INFO     app.middleware.request_metrics:request_metrics.py:50 Request: POST /reports/daily/ - Status: 404 - Duration: 0.0046s
INFO     httpx:_client.py:1025 HTTP Request: POST http://testserver/reports/daily/ "HTTP/1.1 404 Not Found"
___________________ test_submit_eod_report_validation_error ____________________
tests/unit/api/test_daily_report_endpoints.py:100: in test_submit_eod_report_validation_error
    response = await async_client.post(f"{BASE_URL}/", json=invalid_payload)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   TypeError: object Response can't be used in 'await' expression
---------------------------- Captured stderr setup -----------------------------
2025-09-05 12:00:31,555 - app.main - INFO - Supabase client initialized
------------------------------ Captured log setup ------------------------------
INFO     app.main:main.py:133 Supabase client initialized
----------------------------- Captured stderr call -----------------------------
2025-09-05 12:00:31,556 - app.core.error_handlers - ERROR - HTTP error: Not Found
Traceback (most recent call last):
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/starlette/routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/starlette/routing.py", line 766, in app
    await self.default(scope, receive, send)
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/starlette/routing.py", line 652, in not_found
    raise HTTPException(status_code=404)
starlette.exceptions.HTTPException: 404: Not Found
2025-09-05 12:00:31,560 - app.middleware.request_metrics - INFO - Request: POST /reports/daily/ - Status: 404 - Duration: 0.0044s
2025-09-05 12:00:31,561 - httpx - INFO - HTTP Request: POST http://testserver/reports/daily/ "HTTP/1.1 404 Not Found"
------------------------------ Captured log call -------------------------------
ERROR    app.core.error_handlers:error_handlers.py:27 HTTP error: Not Found
Traceback (most recent call last):
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/starlette/routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/starlette/routing.py", line 766, in app
    await self.default(scope, receive, send)
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/starlette/routing.py", line 652, in not_found
    raise HTTPException(status_code=404)
starlette.exceptions.HTTPException: 404: Not Found
INFO     app.middleware.request_metrics:request_metrics.py:50 Request: POST /reports/daily/ - Status: 404 - Duration: 0.0044s
INFO     httpx:_client.py:1025 HTTP Request: POST http://testserver/reports/daily/ "HTTP/1.1 404 Not Found"
______________________ test_get_my_daily_reports_success _______________________
tests/unit/api/test_daily_report_endpoints.py:133: in test_get_my_daily_reports_success
    response = await async_client.get(f"{BASE_URL}/me")
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   TypeError: object Response can't be used in 'await' expression
---------------------------- Captured stderr setup -----------------------------
2025-09-05 12:00:31,564 - app.main - INFO - Supabase client initialized
------------------------------ Captured log setup ------------------------------
INFO     app.main:main.py:133 Supabase client initialized
----------------------------- Captured stderr call -----------------------------
2025-09-05 12:00:31,564 - app.core.error_handlers - ERROR - HTTP error: Not Found
Traceback (most recent call last):
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/starlette/routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/starlette/routing.py", line 766, in app
    await self.default(scope, receive, send)
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/starlette/routing.py", line 652, in not_found
    raise HTTPException(status_code=404)
starlette.exceptions.HTTPException: 404: Not Found
2025-09-05 12:00:31,569 - app.middleware.request_metrics - INFO - Request: GET /reports/daily/me - Status: 404 - Duration: 0.0042s
2025-09-05 12:00:31,569 - httpx - INFO - HTTP Request: GET http://testserver/reports/daily/me "HTTP/1.1 404 Not Found"
------------------------------ Captured log call -------------------------------
ERROR    app.core.error_handlers:error_handlers.py:27 HTTP error: Not Found
Traceback (most recent call last):
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/starlette/routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/starlette/routing.py", line 766, in app
    await self.default(scope, receive, send)
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/starlette/routing.py", line 652, in not_found
    raise HTTPException(status_code=404)
starlette.exceptions.HTTPException: 404: Not Found
INFO     app.middleware.request_metrics:request_metrics.py:50 Request: GET /reports/daily/me - Status: 404 - Duration: 0.0042s
INFO     httpx:_client.py:1025 HTTP Request: GET http://testserver/reports/daily/me "HTTP/1.1 404 Not Found"
__________________ test_get_my_daily_report_for_date_success ___________________
tests/unit/api/test_daily_report_endpoints.py:159: in test_get_my_daily_report_for_date_success
    response = await async_client.get(f"{BASE_URL}/me/{report_date_str}")
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   TypeError: object Response can't be used in 'await' expression
---------------------------- Captured stderr setup -----------------------------
2025-09-05 12:00:31,574 - app.main - INFO - Supabase client initialized
------------------------------ Captured log setup ------------------------------
INFO     app.main:main.py:133 Supabase client initialized
----------------------------- Captured stderr call -----------------------------
2025-09-05 12:00:31,574 - app.core.error_handlers - ERROR - HTTP error: Not Found
Traceback (most recent call last):
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/starlette/routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/starlette/routing.py", line 766, in app
    await self.default(scope, receive, send)
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/starlette/routing.py", line 652, in not_found
    raise HTTPException(status_code=404)
starlette.exceptions.HTTPException: 404: Not Found
2025-09-05 12:00:31,579 - app.middleware.request_metrics - INFO - Request: GET /reports/daily/me/2023-10-26 - Status: 404 - Duration: 0.0043s
2025-09-05 12:00:31,579 - httpx - INFO - HTTP Request: GET http://testserver/reports/daily/me/2023-10-26 "HTTP/1.1 404 Not Found"
------------------------------ Captured log call -------------------------------
ERROR    app.core.error_handlers:error_handlers.py:27 HTTP error: Not Found
Traceback (most recent call last):
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/starlette/routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/starlette/routing.py", line 766, in app
    await self.default(scope, receive, send)
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/starlette/routing.py", line 652, in not_found
    raise HTTPException(status_code=404)
starlette.exceptions.HTTPException: 404: Not Found
INFO     app.middleware.request_metrics:request_metrics.py:50 Request: GET /reports/daily/me/2023-10-26 - Status: 404 - Duration: 0.0043s
INFO     httpx:_client.py:1025 HTTP Request: GET http://testserver/reports/daily/me/2023-10-26 "HTTP/1.1 404 Not Found"
_________________ test_get_my_daily_report_for_date_not_found __________________
tests/unit/api/test_daily_report_endpoints.py:173: in test_get_my_daily_report_for_date_not_found
    response = await async_client.get(f"{BASE_URL}/me/{report_date_str}")
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   TypeError: object Response can't be used in 'await' expression
---------------------------- Captured stderr setup -----------------------------
2025-09-05 12:00:31,582 - app.main - INFO - Supabase client initialized
------------------------------ Captured log setup ------------------------------
INFO     app.main:main.py:133 Supabase client initialized
----------------------------- Captured stderr call -----------------------------
2025-09-05 12:00:31,583 - app.core.error_handlers - ERROR - HTTP error: Not Found
Traceback (most recent call last):
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/starlette/routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/starlette/routing.py", line 766, in app
    await self.default(scope, receive, send)
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/starlette/routing.py", line 652, in not_found
    raise HTTPException(status_code=404)
starlette.exceptions.HTTPException: 404: Not Found
2025-09-05 12:00:31,587 - app.middleware.request_metrics - INFO - Request: GET /reports/daily/me/2023-10-27 - Status: 404 - Duration: 0.0042s
2025-09-05 12:00:31,587 - httpx - INFO - HTTP Request: GET http://testserver/reports/daily/me/2023-10-27 "HTTP/1.1 404 Not Found"
------------------------------ Captured log call -------------------------------
ERROR    app.core.error_handlers:error_handlers.py:27 HTTP error: Not Found
Traceback (most recent call last):
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/starlette/routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/starlette/routing.py", line 766, in app
    await self.default(scope, receive, send)
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/starlette/routing.py", line 652, in not_found
    raise HTTPException(status_code=404)
starlette.exceptions.HTTPException: 404: Not Found
INFO     app.middleware.request_metrics:request_metrics.py:50 Request: GET /reports/daily/me/2023-10-27 - Status: 404 - Duration: 0.0042s
INFO     httpx:_client.py:1025 HTTP Request: GET http://testserver/reports/daily/me/2023-10-27 "HTTP/1.1 404 Not Found"
_______________ test_get_my_daily_report_for_date_invalid_format _______________
tests/unit/api/test_daily_report_endpoints.py:182: in test_get_my_daily_report_for_date_invalid_format
    response = await async_client.get(f"{BASE_URL}/me/invalid-date")
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   TypeError: object Response can't be used in 'await' expression
---------------------------- Captured stderr setup -----------------------------
2025-09-05 12:00:31,590 - app.main - INFO - Supabase client initialized
------------------------------ Captured log setup ------------------------------
INFO     app.main:main.py:133 Supabase client initialized
----------------------------- Captured stderr call -----------------------------
2025-09-05 12:00:31,591 - app.core.error_handlers - ERROR - HTTP error: Not Found
Traceback (most recent call last):
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/starlette/routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/starlette/routing.py", line 766, in app
    await self.default(scope, receive, send)
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/starlette/routing.py", line 652, in not_found
    raise HTTPException(status_code=404)
starlette.exceptions.HTTPException: 404: Not Found
2025-09-05 12:00:31,595 - app.middleware.request_metrics - INFO - Request: GET /reports/daily/me/invalid-date - Status: 404 - Duration: 0.0041s
2025-09-05 12:00:31,595 - httpx - INFO - HTTP Request: GET http://testserver/reports/daily/me/invalid-date "HTTP/1.1 404 Not Found"
------------------------------ Captured log call -------------------------------
ERROR    app.core.error_handlers:error_handlers.py:27 HTTP error: Not Found
Traceback (most recent call last):
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/starlette/routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/starlette/routing.py", line 766, in app
    await self.default(scope, receive, send)
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/starlette/routing.py", line 652, in not_found
    raise HTTPException(status_code=404)
starlette.exceptions.HTTPException: 404: Not Found
INFO     app.middleware.request_metrics:request_metrics.py:50 Request: GET /reports/daily/me/invalid-date - Status: 404 - Duration: 0.0041s
INFO     httpx:_client.py:1025 HTTP Request: GET http://testserver/reports/daily/me/invalid-date "HTTP/1.1 404 Not Found"
_____________________ test_get_daily_report_by_id_success ______________________
tests/unit/api/test_daily_report_endpoints.py:200: in test_get_daily_report_by_id_success
    response = await async_client.get(f"{BASE_URL}/{report_id}")
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   TypeError: object Response can't be used in 'await' expression
---------------------------- Captured stderr setup -----------------------------
2025-09-05 12:00:31,598 - app.main - INFO - Supabase client initialized
------------------------------ Captured log setup ------------------------------
INFO     app.main:main.py:133 Supabase client initialized
----------------------------- Captured stderr call -----------------------------
2025-09-05 12:00:31,599 - app.core.error_handlers - ERROR - HTTP error: Not Found
Traceback (most recent call last):
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/starlette/routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/starlette/routing.py", line 766, in app
    await self.default(scope, receive, send)
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/starlette/routing.py", line 652, in not_found
    raise HTTPException(status_code=404)
starlette.exceptions.HTTPException: 404: Not Found
2025-09-05 12:00:31,603 - app.middleware.request_metrics - INFO - Request: GET /reports/daily/UUID_REDACTED - Status: 404 - Duration: 0.0042s
2025-09-05 12:00:31,603 - httpx - INFO - HTTP Request: GET http://testserver/reports/daily/UUID_REDACTED "HTTP/1.1 404 Not Found"
------------------------------ Captured log call -------------------------------
ERROR    app.core.error_handlers:error_handlers.py:27 HTTP error: Not Found
Traceback (most recent call last):
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/starlette/routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/starlette/routing.py", line 766, in app
    await self.default(scope, receive, send)
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/starlette/routing.py", line 652, in not_found
    raise HTTPException(status_code=404)
starlette.exceptions.HTTPException: 404: Not Found
INFO     app.middleware.request_metrics:request_metrics.py:50 Request: GET /reports/daily/UUID_REDACTED - Status: 404 - Duration: 0.0042s
INFO     httpx:_client.py:1025 HTTP Request: GET http://testserver/reports/daily/UUID_REDACTED "HTTP/1.1 404 Not Found"
____________________ test_get_daily_report_by_id_not_found _____________________
tests/unit/api/test_daily_report_endpoints.py:211: in test_get_daily_report_by_id_not_found
    response = await async_client.get(f"{BASE_URL}/{report_id}")
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   TypeError: object Response can't be used in 'await' expression
---------------------------- Captured stderr setup -----------------------------
2025-09-05 12:00:31,606 - app.main - INFO - Supabase client initialized
------------------------------ Captured log setup ------------------------------
INFO     app.main:main.py:133 Supabase client initialized
----------------------------- Captured stderr call -----------------------------
2025-09-05 12:00:31,607 - app.core.error_handlers - ERROR - HTTP error: Not Found
Traceback (most recent call last):
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/starlette/routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/starlette/routing.py", line 766, in app
    await self.default(scope, receive, send)
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/starlette/routing.py", line 652, in not_found
    raise HTTPException(status_code=404)
starlette.exceptions.HTTPException: 404: Not Found
2025-09-05 12:00:31,611 - app.middleware.request_metrics - INFO - Request: GET /reports/daily/UUID_REDACTED - Status: 404 - Duration: 0.0041s
2025-09-05 12:00:31,612 - httpx - INFO - HTTP Request: GET http://testserver/reports/daily/UUID_REDACTED "HTTP/1.1 404 Not Found"
------------------------------ Captured log call -------------------------------
ERROR    app.core.error_handlers:error_handlers.py:27 HTTP error: Not Found
Traceback (most recent call last):
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/starlette/routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/starlette/routing.py", line 766, in app
    await self.default(scope, receive, send)
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/starlette/routing.py", line 652, in not_found
    raise HTTPException(status_code=404)
starlette.exceptions.HTTPException: 404: Not Found
INFO     app.middleware.request_metrics:request_metrics.py:50 Request: GET /reports/daily/UUID_REDACTED - Status: 404 - Duration: 0.0041s
INFO     httpx:_client.py:1025 HTTP Request: GET http://testserver/reports/daily/UUID_REDACTED "HTTP/1.1 404 Not Found"
___________________ test_get_daily_report_by_id_invalid_uuid ___________________
tests/unit/api/test_daily_report_endpoints.py:218: in test_get_daily_report_by_id_invalid_uuid
    response = await async_client.get(f"{BASE_URL}/{invalid_uuid}")
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   TypeError: object Response can't be used in 'await' expression
---------------------------- Captured stderr setup -----------------------------
2025-09-05 12:00:31,615 - app.main - INFO - Supabase client initialized
------------------------------ Captured log setup ------------------------------
INFO     app.main:main.py:133 Supabase client initialized
----------------------------- Captured stderr call -----------------------------
2025-09-05 12:00:31,615 - app.core.error_handlers - ERROR - HTTP error: Not Found
Traceback (most recent call last):
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/starlette/routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/starlette/routing.py", line 766, in app
    await self.default(scope, receive, send)
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/starlette/routing.py", line 652, in not_found
    raise HTTPException(status_code=404)
starlette.exceptions.HTTPException: 404: Not Found
2025-09-05 12:00:31,619 - app.middleware.request_metrics - INFO - Request: GET /reports/daily/not-a-uuid - Status: 404 - Duration: 0.0041s
2025-09-05 12:00:31,620 - httpx - INFO - HTTP Request: GET http://testserver/reports/daily/not-a-uuid "HTTP/1.1 404 Not Found"
------------------------------ Captured log call -------------------------------
ERROR    app.core.error_handlers:error_handlers.py:27 HTTP error: Not Found
Traceback (most recent call last):
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/starlette/routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/starlette/routing.py", line 766, in app
    await self.default(scope, receive, send)
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/starlette/routing.py", line 652, in not_found
    raise HTTPException(status_code=404)
starlette.exceptions.HTTPException: 404: Not Found
INFO     app.middleware.request_metrics:request_metrics.py:50 Request: GET /reports/daily/not-a-uuid - Status: 404 - Duration: 0.0041s
INFO     httpx:_client.py:1025 HTTP Request: GET http://testserver/reports/daily/not-a-uuid "HTTP/1.1 404 Not Found"
_______________ TestHealthChecker.test_check_github_api_success ________________
tests/unit/api/test_health.py:61: in test_check_github_api_success
    with patch("app.api.health.settings") as mock_settings, patch("app.api.health.Github") as mock_github_class:
                                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/unittest/mock.py:1497: in __enter__
    original, local = self.get_original()
                      ^^^^^^^^^^^^^^^^^^^
/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/unittest/mock.py:1467: in get_original
    raise AttributeError(
E   AttributeError: <module 'app.api.health' from '/Users/parkerbeard/golfdaddy-brain/backend/app/api/health.py'> does not have the attribute 'Github'
_______________ TestHealthChecker.test_check_github_api_degraded _______________
tests/unit/api/test_health.py:99: in test_check_github_api_degraded
    with patch("app.api.health.settings") as mock_settings, patch("app.api.health.Github") as mock_github_class:
                                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/unittest/mock.py:1497: in __enter__
    original, local = self.get_original()
                      ^^^^^^^^^^^^^^^^^^^
/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/unittest/mock.py:1467: in get_original
    raise AttributeError(
E   AttributeError: <module 'app.api.health' from '/Users/parkerbeard/golfdaddy-brain/backend/app/api/health.py'> does not have the attribute 'Github'
_______________ TestHealthChecker.test_check_openai_api_success ________________
tests/unit/api/test_health.py:121: in test_check_openai_api_success
    with patch("app.api.health.settings") as mock_settings, patch("app.api.health.OpenAI") as mock_openai_class:
                                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/unittest/mock.py:1497: in __enter__
    original, local = self.get_original()
                      ^^^^^^^^^^^^^^^^^^^
/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/unittest/mock.py:1467: in get_original
    raise AttributeError(
E   AttributeError: <module 'app.api.health' from '/Users/parkerbeard/golfdaddy-brain/backend/app/api/health.py'> does not have the attribute 'OpenAI'
_______________ TestHealthEndpoints.test_detailed_health_success _______________
tests/unit/api/test_health.py:276: in test_detailed_health_success
    assert "checks" in data
E   AssertionError: assert 'checks' in {'status': 'healthy', 'message': 'Detailed health checks disabled', 'timestamp': '2025-09-05T12:00:31.690920'}
----------------------------- Captured stderr call -----------------------------
2025-09-05 12:00:31,691 - httpx - INFO - HTTP Request: GET http://testserver/health/detailed "HTTP/1.1 200 OK"
------------------------------ Captured log call -------------------------------
INFO     httpx:_client.py:1025 HTTP Request: GET http://testserver/health/detailed "HTTP/1.1 200 OK"
______________ TestHealthEndpoints.test_detailed_health_degraded _______________
tests/unit/api/test_health.py:302: in test_detailed_health_degraded
    assert data["status"] == "degraded"  # Overall status should be degraded
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   AssertionError: assert 'healthy' == 'degraded'
E     
E     - degraded
E     + healthy
----------------------------- Captured stderr call -----------------------------
2025-09-05 12:00:31,694 - httpx - INFO - HTTP Request: GET http://testserver/health/detailed "HTTP/1.1 200 OK"
------------------------------ Captured log call -------------------------------
INFO     httpx:_client.py:1025 HTTP Request: GET http://testserver/health/detailed "HTTP/1.1 200 OK"
___________ TestHealthEndpoints.test_reset_circuit_breaker_not_found ___________
tests/unit/api/test_health.py:351: in test_reset_circuit_breaker_not_found
    assert response.status_code == 404
E   assert 500 == 404
E    +  where 500 = <Response [500 Internal Server Error]>.status_code
----------------------------- Captured stderr call -----------------------------
2025-09-05 12:00:31,700 - app.api.health - ERROR - Failed to reset circuit breaker nonexistent: 404: Circuit breaker 'nonexistent' not found
2025-09-05 12:00:31,701 - httpx - INFO - HTTP Request: POST http://testserver/health/circuit-breakers/nonexistent/reset "HTTP/1.1 500 Internal Server Error"
------------------------------ Captured log call -------------------------------
ERROR    app.api.health:health.py:325 Failed to reset circuit breaker nonexistent: 404: Circuit breaker 'nonexistent' not found
INFO     httpx:_client.py:1025 HTTP Request: POST http://testserver/health/circuit-breakers/nonexistent/reset "HTTP/1.1 500 Internal Server Error"
_______________ TestWebhookEndpoints.test_github_webhook_success _______________
async def functions are not natively supported.
You need to install a suitable plugin for your async framework, for example:
  - anyio
  - pytest-asyncio
  - pytest-tornasync
  - pytest-trio
  - pytest-twisted
________ TestWebhookEndpoints.test_github_webhook_no_secret_configured _________
async def functions are not natively supported.
You need to install a suitable plugin for your async framework, for example:
  - anyio
  - pytest-asyncio
  - pytest-tornasync
  - pytest-trio
  - pytest-twisted
__________ TestWebhookEndpoints.test_github_webhook_invalid_signature __________
async def functions are not natively supported.
You need to install a suitable plugin for your async framework, for example:
  - anyio
  - pytest-asyncio
  - pytest-tornasync
  - pytest-trio
  - pytest-twisted
__________ TestWebhookEndpoints.test_github_webhook_missing_signature __________
async def functions are not natively supported.
You need to install a suitable plugin for your async framework, for example:
  - anyio
  - pytest-asyncio
  - pytest-tornasync
  - pytest-trio
  - pytest-twisted
____________ TestWebhookEndpoints.test_github_webhook_invalid_json _____________
async def functions are not natively supported.
You need to install a suitable plugin for your async framework, for example:
  - anyio
  - pytest-asyncio
  - pytest-tornasync
  - pytest-trio
  - pytest-twisted
__________ TestWebhookEndpoints.test_github_webhook_processing_error ___________
async def functions are not natively supported.
You need to install a suitable plugin for your async framework, for example:
  - anyio
  - pytest-asyncio
  - pytest-tornasync
  - pytest-trio
  - pytest-twisted
__________ TestWebhookEndpoints.test_github_webhook_status_configured __________
async def functions are not natively supported.
You need to install a suitable plugin for your async framework, for example:
  - anyio
  - pytest-asyncio
  - pytest-tornasync
  - pytest-trio
  - pytest-twisted
________ TestWebhookEndpoints.test_github_webhook_status_not_configured ________
async def functions are not natively supported.
You need to install a suitable plugin for your async framework, for example:
  - anyio
  - pytest-asyncio
  - pytest-tornasync
  - pytest-trio
  - pytest-twisted
_______________ TestCircuitBreaker.test_circuit_recovery_attempt _______________
tests/unit/core/test_circuit_breaker.py:156: in test_circuit_recovery_attempt
    assert breaker.state == CircuitState.CLOSED
E   AssertionError: assert <CircuitState.HALF_OPEN: 'half_open'> == <CircuitState.CLOSED: 'closed'>
E    +  where <CircuitState.HALF_OPEN: 'half_open'> = <app.core.circuit_breaker.CircuitBreaker object at 0x119a71370>.state
E    +  and   <CircuitState.CLOSED: 'closed'> = CircuitState.CLOSED
---------------------------- Captured stderr setup -----------------------------
2025-09-05 12:00:31,715 - app.core.circuit_breaker - INFO - Initialized circuit breaker 'test_breaker' with failure_threshold=3, timeout=5s
------------------------------ Captured log setup ------------------------------
INFO     app.core.circuit_breaker:circuit_breaker.py:68 Initialized circuit breaker 'test_breaker' with failure_threshold=3, timeout=5s
----------------------------- Captured stderr call -----------------------------
2025-09-05 12:00:31,716 - app.core.circuit_breaker - INFO - Circuit breaker 'test_breaker' moved to HALF_OPEN
------------------------------ Captured log call -------------------------------
INFO     app.core.circuit_breaker:circuit_breaker.py:94 Circuit breaker 'test_breaker' moved to HALF_OPEN
________ TestGlobalCircuitManager.test_github_circuit_breaker_creation _________
tests/unit/core/test_circuit_breaker.py:352: in test_github_circuit_breaker_creation
    with patch("app.core.circuit_breaker.settings") as mock_settings:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/unittest/mock.py:1497: in __enter__
    original, local = self.get_original()
                      ^^^^^^^^^^^^^^^^^^^
/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/unittest/mock.py:1467: in get_original
    raise AttributeError(
E   AttributeError: <module 'app.core.circuit_breaker' from '/Users/parkerbeard/golfdaddy-brain/backend/app/core/circuit_breaker.py'> does not have the attribute 'settings'
________ TestGlobalCircuitManager.test_openai_circuit_breaker_creation _________
tests/unit/core/test_circuit_breaker.py:366: in test_openai_circuit_breaker_creation
    with patch("app.core.circuit_breaker.settings") as mock_settings:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/unittest/mock.py:1497: in __enter__
    original, local = self.get_original()
                      ^^^^^^^^^^^^^^^^^^^
/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/unittest/mock.py:1467: in get_original
    raise AttributeError(
E   AttributeError: <module 'app.core.circuit_breaker' from '/Users/parkerbeard/golfdaddy-brain/backend/app/core/circuit_breaker.py'> does not have the attribute 'settings'
_________ TestCommitAnalyzerImpact.test_analyze_commit_impact_scoring __________
tests/unit/integrations/test_commit_analyzer_impact.py:111: in test_analyze_commit_impact_scoring
    assert result["business_value"] == 8
           ^^^^^^^^^^^^^^^^^^^^^^^^
E   KeyError: 'business_value'
----------------------------- Captured stdout call -----------------------------
OpenAI API Error: 'property' object is not callable
______ TestCommitAnalyzerImpact.test_analyze_commit_diff_combined_scoring ______
tests/unit/integrations/test_commit_analyzer_impact.py:162: in test_analyze_commit_diff_combined_scoring
    assert result["complexity_score"] == 6
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
E   KeyError: 'complexity_score'
----------------------------- Captured stdout call -----------------------------
OpenAI API Error: 'property' object is not callable
____________ TestCommitAnalyzerImpact.test_impact_score_calculation ____________
tests/unit/integrations/test_commit_analyzer_impact.py:205: in test_impact_score_calculation
    assert result["impact_score"] == 60.0
           ^^^^^^^^^^^^^^^^^^^^^^
E   KeyError: 'impact_score'
----------------------------- Captured stdout call -----------------------------
OpenAI API Error: 'property' object is not callable
_________________ TestCommitAnalyzerImpact.test_error_handling _________________
tests/unit/integrations/test_commit_analyzer_impact.py:217: in test_error_handling
    assert "API Error" in result["message"]
E   assert 'API Error' in "'property' object is not callable"
----------------------------- Captured stdout call -----------------------------
OpenAI API Error: 'property' object is not callable
__________________________ test_commit_and_push_event __________________________
tests/unit/models/test_github_event_schemas.py:96: in test_commit_and_push_event
    with pytest.raises(ValidationError):
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   Failed: DID NOT RAISE <class 'pydantic_core._pydantic_core.ValidationError'>
_________________ test_get_existing_commit_hashes_single_batch _________________
tests/unit/repositories/test_commit_repository.py:78: in test_get_existing_commit_hashes_single_batch
    result = await repo.get_existing_commit_hashes(commit_hashes)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
app/repositories/commit_repository.py:445: in get_existing_commit_hashes
    self._handle_supabase_error(response, "Error checking commit existence")
app/repositories/commit_repository.py:41: in _handle_supabase_error
    raise DatabaseError(f"{context_message}: {response.error.message}")
E   app.core.exceptions.DatabaseError: Error checking commit existence: <MagicMock name='to_thread().error.message' id='4723104064'>
----------------------------- Captured stderr call -----------------------------
2025-09-05 12:00:31,807 - app.repositories.commit_repository - INFO - Checking existence of 3 commits
2025-09-05 12:00:31,807 - app.repositories.commit_repository - ERROR - Error checking commit existence: Supabase error code <MagicMock name='to_thread().error.code' id='4723104736'> - <MagicMock name='to_thread().error.message' id='4723104064'>
NoneType: None
------------------------------ Captured log call -------------------------------
INFO     app.repositories.commit_repository:commit_repository.py:432 Checking existence of 3 commits
ERROR    app.repositories.commit_repository:commit_repository.py:38 Error checking commit existence: Supabase error code <MagicMock name='to_thread().error.code' id='4723104736'> - <MagicMock name='to_thread().error.message' id='4723104064'>
NoneType: None
_______________ test_get_existing_commit_hashes_multiple_batches _______________
tests/unit/repositories/test_commit_repository.py:109: in test_get_existing_commit_hashes_multiple_batches
    result = await repo.get_existing_commit_hashes(commit_hashes)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
app/repositories/commit_repository.py:445: in get_existing_commit_hashes
    self._handle_supabase_error(response, "Error checking commit existence")
app/repositories/commit_repository.py:41: in _handle_supabase_error
    raise DatabaseError(f"{context_message}: {response.error.message}")
E   app.core.exceptions.DatabaseError: Error checking commit existence: <MagicMock name='mock.error.message' id='4713537152'>
----------------------------- Captured stderr call -----------------------------
2025-09-05 12:00:31,815 - app.repositories.commit_repository - INFO - Checking existence of 250 commits
2025-09-05 12:00:31,815 - app.repositories.commit_repository - ERROR - Error checking commit existence: Supabase error code <MagicMock name='mock.error.code' id='4713538496'> - <MagicMock name='mock.error.message' id='4713537152'>
NoneType: None
------------------------------ Captured log call -------------------------------
INFO     app.repositories.commit_repository:commit_repository.py:432 Checking existence of 250 commits
ERROR    app.repositories.commit_repository:commit_repository.py:38 Error checking commit existence: Supabase error code <MagicMock name='mock.error.code' id='4713538496'> - <MagicMock name='mock.error.message' id='4713537152'>
NoneType: None
____________________ test_get_commits_with_analysis_success ____________________
tests/unit/repositories/test_commit_repository.py:178: in test_get_commits_with_analysis_success
    result = await repo.get_commits_with_analysis(commit_hashes)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
app/repositories/commit_repository.py:494: in get_commits_with_analysis
    self._handle_supabase_error(response, "Error fetching commits with analysis")
app/repositories/commit_repository.py:41: in _handle_supabase_error
    raise DatabaseError(f"{context_message}: {response.error.message}")
E   app.core.exceptions.DatabaseError: Error fetching commits with analysis: <MagicMock name='to_thread().error.message' id='4726381872'>
----------------------------- Captured stderr call -----------------------------
2025-09-05 12:00:31,823 - app.repositories.commit_repository - INFO - Fetching 2 commits with analysis data
2025-09-05 12:00:31,823 - app.repositories.commit_repository - ERROR - Error fetching commits with analysis: Supabase error code <MagicMock name='to_thread().error.code' id='4726378512'> - <MagicMock name='to_thread().error.message' id='4726381872'>
NoneType: None
------------------------------ Captured log call -------------------------------
INFO     app.repositories.commit_repository:commit_repository.py:481 Fetching 2 commits with analysis data
ERROR    app.repositories.commit_repository:commit_repository.py:38 Error fetching commits with analysis: Supabase error code <MagicMock name='to_thread().error.code' id='4726378512'> - <MagicMock name='to_thread().error.message' id='4726381872'>
NoneType: None
____________ test_get_commits_with_analysis_with_decimal_conversion ____________
tests/unit/repositories/test_commit_repository.py:218: in test_get_commits_with_analysis_with_decimal_conversion
    result = await repo.get_commits_with_analysis(commit_hashes)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
app/repositories/commit_repository.py:494: in get_commits_with_analysis
    self._handle_supabase_error(response, "Error fetching commits with analysis")
app/repositories/commit_repository.py:41: in _handle_supabase_error
    raise DatabaseError(f"{context_message}: {response.error.message}")
E   app.core.exceptions.DatabaseError: Error fetching commits with analysis: <MagicMock name='to_thread().error.message' id='4726389600'>
----------------------------- Captured stderr call -----------------------------
2025-09-05 12:00:31,831 - app.repositories.commit_repository - INFO - Fetching 1 commits with analysis data
2025-09-05 12:00:31,831 - app.repositories.commit_repository - ERROR - Error fetching commits with analysis: Supabase error code <MagicMock name='to_thread().error.code' id='4726388928'> - <MagicMock name='to_thread().error.message' id='4726389600'>
NoneType: None
------------------------------ Captured log call -------------------------------
INFO     app.repositories.commit_repository:commit_repository.py:481 Fetching 1 commits with analysis data
ERROR    app.repositories.commit_repository:commit_repository.py:38 Error fetching commits with analysis: Supabase error code <MagicMock name='to_thread().error.code' id='4726388928'> - <MagicMock name='to_thread().error.message' id='4726389600'>
NoneType: None
_________________ test_convert_commit_to_analysis_from_seeder __________________
tests/unit/repositories/test_commit_repository.py:251: in test_convert_commit_to_analysis_from_seeder
    from backend.scripts.seed_historical_commits import HistoricalCommitSeeder
E   ModuleNotFoundError: No module named 'backend'
________________ test_convert_commit_to_analysis_malformed_json ________________
tests/unit/repositories/test_commit_repository.py:302: in test_convert_commit_to_analysis_malformed_json
    from backend.scripts.seed_historical_commits import HistoricalCommitSeeder
E   ModuleNotFoundError: No module named 'backend'
_________________________ test_get_daily_report_by_id __________________________
app/repositories/daily_report_repository.py:169: in get_daily_report_by_id
    return self._db_to_model(response.data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
app/repositories/daily_report_repository.py:88: in _db_to_model
    return DailyReport(**db_data)
           ^^^^^^^^^^^^^^^^^^^^^^
E   pydantic_core._pydantic_core.ValidationError: 2 validation errors for DailyReport
E   user_id
E     Field required [type=missing, input_value={}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   raw_text_input
E     Field required [type=missing, input_value={}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing

During handling of the above exception, another exception occurred:
tests/unit/repositories/test_daily_report_repository.py:93: in test_get_daily_report_by_id
    retrieved_report = await report_repository.get_daily_report_by_id(report_id)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
app/repositories/daily_report_repository.py:180: in get_daily_report_by_id
    raise DatabaseError(f"Unexpected error getting daily report by ID {report_id}: {str(e)}")
E   app.core.exceptions.DatabaseError: Unexpected error getting daily report by ID c0237496-d050-4dd2-98fa-11531ee599b3: 2 validation errors for DailyReport
E   user_id
E     Field required [type=missing, input_value={}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   raw_text_input
E     Field required [type=missing, input_value={}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
----------------------------- Captured stderr call -----------------------------
2025-09-05 12:00:31,850 - app.repositories.daily_report_repository - INFO - Successfully created daily report: UUID_REDACTED
2025-09-05 12:00:31,851 - app.repositories.daily_report_repository - ERROR - Unexpected error getting daily report by ID UUID_REDACTED: 2 validation errors for DailyReport
user_id
  Field required [type=missing, input_value={}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
raw_text_input
  Field required [type=missing, input_value={}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
Traceback (most recent call last):
  File "/Users/parkerbeard/golfdaddy-brain/backend/app/repositories/daily_report_repository.py", line 169, in get_daily_report_by_id
    return self._db_to_model(response.data)
           ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "/Users/parkerbeard/golfdaddy-brain/backend/app/repositories/daily_report_repository.py", line 88, in _db_to_model
    return DailyReport(**db_data)
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/pydantic/main.py", line 253, in __init__
    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)
pydantic_core._pydantic_core.ValidationError: 2 validation errors for DailyReport
user_id
  Field required [type=missing, input_value={}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
raw_text_input
  Field required [type=missing, input_value={}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
------------------------------ Captured log call -------------------------------
INFO     app.repositories.daily_report_repository:daily_report_repository.py:152 Successfully created daily report: UUID_REDACTED
ERROR    app.repositories.daily_report_repository:daily_report_repository.py:179 Unexpected error getting daily report by ID UUID_REDACTED: 2 validation errors for DailyReport
user_id
  Field required [type=missing, input_value={}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
raw_text_input
  Field required [type=missing, input_value={}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
Traceback (most recent call last):
  File "/Users/parkerbeard/golfdaddy-brain/backend/app/repositories/daily_report_repository.py", line 169, in get_daily_report_by_id
    return self._db_to_model(response.data)
           ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "/Users/parkerbeard/golfdaddy-brain/backend/app/repositories/daily_report_repository.py", line 88, in _db_to_model
    return DailyReport(**db_data)
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/pydantic/main.py", line 253, in __init__
    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)
pydantic_core._pydantic_core.ValidationError: 2 validation errors for DailyReport
user_id
  Field required [type=missing, input_value={}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
raw_text_input
  Field required [type=missing, input_value={}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
____________________ test_get_daily_report_by_id_not_found _____________________
app/repositories/daily_report_repository.py:169: in get_daily_report_by_id
    return self._db_to_model(response.data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
app/repositories/daily_report_repository.py:88: in _db_to_model
    return DailyReport(**db_data)
           ^^^^^^^^^^^^^^^^^^^^^^
E   pydantic_core._pydantic_core.ValidationError: 2 validation errors for DailyReport
E   user_id
E     Field required [type=missing, input_value={}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   raw_text_input
E     Field required [type=missing, input_value={}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing

During handling of the above exception, another exception occurred:
tests/unit/repositories/test_daily_report_repository.py:101: in test_get_daily_report_by_id_not_found
    retrieved_report = await report_repository.get_daily_report_by_id(non_existent_id)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
app/repositories/daily_report_repository.py:180: in get_daily_report_by_id
    raise DatabaseError(f"Unexpected error getting daily report by ID {report_id}: {str(e)}")
E   app.core.exceptions.DatabaseError: Unexpected error getting daily report by ID 39818939-da6d-4032-8534-53aa672d2d71: 2 validation errors for DailyReport
E   user_id
E     Field required [type=missing, input_value={}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   raw_text_input
E     Field required [type=missing, input_value={}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
----------------------------- Captured stderr call -----------------------------
2025-09-05 12:00:31,867 - app.repositories.daily_report_repository - ERROR - Unexpected error getting daily report by ID UUID_REDACTED: 2 validation errors for DailyReport
user_id
  Field required [type=missing, input_value={}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
raw_text_input
  Field required [type=missing, input_value={}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
Traceback (most recent call last):
  File "/Users/parkerbeard/golfdaddy-brain/backend/app/repositories/daily_report_repository.py", line 169, in get_daily_report_by_id
    return self._db_to_model(response.data)
           ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "/Users/parkerbeard/golfdaddy-brain/backend/app/repositories/daily_report_repository.py", line 88, in _db_to_model
    return DailyReport(**db_data)
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/pydantic/main.py", line 253, in __init__
    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)
pydantic_core._pydantic_core.ValidationError: 2 validation errors for DailyReport
user_id
  Field required [type=missing, input_value={}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
raw_text_input
  Field required [type=missing, input_value={}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
------------------------------ Captured log call -------------------------------
ERROR    app.repositories.daily_report_repository:daily_report_repository.py:179 Unexpected error getting daily report by ID UUID_REDACTED: 2 validation errors for DailyReport
user_id
  Field required [type=missing, input_value={}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
raw_text_input
  Field required [type=missing, input_value={}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
Traceback (most recent call last):
  File "/Users/parkerbeard/golfdaddy-brain/backend/app/repositories/daily_report_repository.py", line 169, in get_daily_report_by_id
    return self._db_to_model(response.data)
           ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "/Users/parkerbeard/golfdaddy-brain/backend/app/repositories/daily_report_repository.py", line 88, in _db_to_model
    return DailyReport(**db_data)
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/pydantic/main.py", line 253, in __init__
    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)
pydantic_core._pydantic_core.ValidationError: 2 validation errors for DailyReport
user_id
  Field required [type=missing, input_value={}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
raw_text_input
  Field required [type=missing, input_value={}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
______________________ test_get_daily_reports_by_user_id _______________________
tests/unit/repositories/test_daily_report_repository.py:113: in test_get_daily_reports_by_user_id
    await report_repository.create_daily_report(report1_create)
app/repositories/daily_report_repository.py:150: in create_daily_report
    self._handle_supabase_error(response, "Failed to create daily report")
app/repositories/daily_report_repository.py:28: in _handle_supabase_error
    raise DatabaseError(f"{context_message}: {response.error.message}")
E   app.core.exceptions.DatabaseError: Failed to create daily report: <MagicMock name='mock.execute().error.message' id='4723105072'>
----------------------------- Captured stderr call -----------------------------
2025-09-05 12:00:31,882 - app.repositories.daily_report_repository - ERROR - Failed to create daily report: Supabase error code <MagicMock name='mock.execute().error.code' id='4723106752'> - <MagicMock name='mock.execute().error.message' id='4723105072'>
NoneType: None
------------------------------ Captured log call -------------------------------
ERROR    app.repositories.daily_report_repository:daily_report_repository.py:24 Failed to create daily report: Supabase error code <MagicMock name='mock.execute().error.code' id='4723106752'> - <MagicMock name='mock.execute().error.message' id='4723105072'>
NoneType: None
___________________ test_get_daily_reports_by_user_and_date ____________________
tests/unit/repositories/test_daily_report_repository.py:137: in test_get_daily_reports_by_user_and_date
    from app.repositories.daily_report_repository import _daily_reports_db
E   ImportError: cannot import name '_daily_reports_db' from 'app.repositories.daily_report_repository' (/Users/parkerbeard/golfdaddy-brain/backend/app/repositories/daily_report_repository.py)
___________________________ test_update_daily_report ___________________________
tests/unit/repositories/test_daily_report_repository.py:174: in test_update_daily_report
    created_report = await report_repository.create_daily_report(sample_report_create)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
app/repositories/daily_report_repository.py:150: in create_daily_report
    self._handle_supabase_error(response, "Failed to create daily report")
app/repositories/daily_report_repository.py:28: in _handle_supabase_error
    raise DatabaseError(f"{context_message}: {response.error.message}")
E   app.core.exceptions.DatabaseError: Failed to create daily report: <MagicMock name='mock.execute().error.message' id='4750467024'>
----------------------------- Captured stderr call -----------------------------
2025-09-05 12:00:31,892 - app.repositories.daily_report_repository - ERROR - Failed to create daily report: Supabase error code <MagicMock name='mock.execute().error.code' id='4750466352'> - <MagicMock name='mock.execute().error.message' id='4750467024'>
NoneType: None
------------------------------ Captured log call -------------------------------
ERROR    app.repositories.daily_report_repository:daily_report_repository.py:24 Failed to create daily report: Supabase error code <MagicMock name='mock.execute().error.code' id='4750466352'> - <MagicMock name='mock.execute().error.message' id='4750467024'>
NoneType: None
_______________________ test_update_daily_report_partial _______________________
tests/unit/repositories/test_daily_report_repository.py:211: in test_update_daily_report_partial
    created_report = await report_repository.create_daily_report(sample_report_create)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
app/repositories/daily_report_repository.py:150: in create_daily_report
    self._handle_supabase_error(response, "Failed to create daily report")
app/repositories/daily_report_repository.py:28: in _handle_supabase_error
    raise DatabaseError(f"{context_message}: {response.error.message}")
E   app.core.exceptions.DatabaseError: Failed to create daily report: <MagicMock name='mock.execute().error.message' id='4750473744'>
----------------------------- Captured stderr call -----------------------------
2025-09-05 12:00:31,899 - app.repositories.daily_report_repository - ERROR - Failed to create daily report: Supabase error code <MagicMock name='mock.execute().error.code' id='4750473072'> - <MagicMock name='mock.execute().error.message' id='4750473744'>
NoneType: None
------------------------------ Captured log call -------------------------------
ERROR    app.repositories.daily_report_repository:daily_report_repository.py:24 Failed to create daily report: Supabase error code <MagicMock name='mock.execute().error.code' id='4750473072'> - <MagicMock name='mock.execute().error.message' id='4750473744'>
NoneType: None
______________________ test_update_daily_report_not_found ______________________
app/repositories/daily_report_repository.py:302: in update_daily_report
    return self._db_to_model(response.data[0])
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
app/repositories/daily_report_repository.py:88: in _db_to_model
    return DailyReport(**db_data)
           ^^^^^^^^^^^^^^^^^^^^^^
E   pydantic_core._pydantic_core.ValidationError: 2 validation errors for DailyReport
E   user_id
E     Field required [type=missing, input_value={}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   raw_text_input
E     Field required [type=missing, input_value={}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing

During handling of the above exception, another exception occurred:
tests/unit/repositories/test_daily_report_repository.py:223: in test_update_daily_report_not_found
    updated_report = await report_repository.update_daily_report(non_existent_id, update_payload)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
app/repositories/daily_report_repository.py:318: in update_daily_report
    raise DatabaseError(f"Unexpected error updating daily report {report_id}: {str(e)}")
E   app.core.exceptions.DatabaseError: Unexpected error updating daily report b4823841-86d7-43c2-8065-739e8d2f4d9d: 2 validation errors for DailyReport
E   user_id
E     Field required [type=missing, input_value={}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   raw_text_input
E     Field required [type=missing, input_value={}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
----------------------------- Captured stderr call -----------------------------
2025-09-05 12:00:31,907 - app.repositories.daily_report_repository - INFO - Successfully updated daily report: UUID_REDACTED
2025-09-05 12:00:31,908 - app.repositories.daily_report_repository - ERROR - Unexpected error updating daily report UUID_REDACTED: 2 validation errors for DailyReport
user_id
  Field required [type=missing, input_value={}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
raw_text_input
  Field required [type=missing, input_value={}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
Traceback (most recent call last):
  File "/Users/parkerbeard/golfdaddy-brain/backend/app/repositories/daily_report_repository.py", line 302, in update_daily_report
    return self._db_to_model(response.data[0])
           ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/Users/parkerbeard/golfdaddy-brain/backend/app/repositories/daily_report_repository.py", line 88, in _db_to_model
    return DailyReport(**db_data)
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/pydantic/main.py", line 253, in __init__
    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)
pydantic_core._pydantic_core.ValidationError: 2 validation errors for DailyReport
user_id
  Field required [type=missing, input_value={}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
raw_text_input
  Field required [type=missing, input_value={}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
------------------------------ Captured log call -------------------------------
INFO     app.repositories.daily_report_repository:daily_report_repository.py:301 Successfully updated daily report: UUID_REDACTED
ERROR    app.repositories.daily_report_repository:daily_report_repository.py:317 Unexpected error updating daily report UUID_REDACTED: 2 validation errors for DailyReport
user_id
  Field required [type=missing, input_value={}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
raw_text_input
  Field required [type=missing, input_value={}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
Traceback (most recent call last):
  File "/Users/parkerbeard/golfdaddy-brain/backend/app/repositories/daily_report_repository.py", line 302, in update_daily_report
    return self._db_to_model(response.data[0])
           ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/Users/parkerbeard/golfdaddy-brain/backend/app/repositories/daily_report_repository.py", line 88, in _db_to_model
    return DailyReport(**db_data)
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/pydantic/main.py", line 253, in __init__
    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)
pydantic_core._pydantic_core.ValidationError: 2 validation errors for DailyReport
user_id
  Field required [type=missing, input_value={}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
raw_text_input
  Field required [type=missing, input_value={}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
___________________________ test_delete_daily_report ___________________________
tests/unit/repositories/test_daily_report_repository.py:228: in test_delete_daily_report
    created_report = await report_repository.create_daily_report(sample_report_create)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
app/repositories/daily_report_repository.py:150: in create_daily_report
    self._handle_supabase_error(response, "Failed to create daily report")
app/repositories/daily_report_repository.py:28: in _handle_supabase_error
    raise DatabaseError(f"{context_message}: {response.error.message}")
E   app.core.exceptions.DatabaseError: Failed to create daily report: <MagicMock name='mock.execute().error.message' id='4725513184'>
----------------------------- Captured stderr call -----------------------------
2025-09-05 12:00:31,922 - app.repositories.daily_report_repository - ERROR - Failed to create daily report: Supabase error code <MagicMock name='mock.execute().error.code' id='4725513856'> - <MagicMock name='mock.execute().error.message' id='4725513184'>
NoneType: None
------------------------------ Captured log call -------------------------------
ERROR    app.repositories.daily_report_repository:daily_report_repository.py:24 Failed to create daily report: Supabase error code <MagicMock name='mock.execute().error.code' id='4725513856'> - <MagicMock name='mock.execute().error.message' id='4725513184'>
NoneType: None
______________________ test_delete_daily_report_not_found ______________________
app/repositories/daily_report_repository.py:169: in get_daily_report_by_id
    return self._db_to_model(response.data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
app/repositories/daily_report_repository.py:88: in _db_to_model
    return DailyReport(**db_data)
           ^^^^^^^^^^^^^^^^^^^^^^
E   pydantic_core._pydantic_core.ValidationError: 2 validation errors for DailyReport
E   user_id
E     Field required [type=missing, input_value={}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   raw_text_input
E     Field required [type=missing, input_value={}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing

During handling of the above exception, another exception occurred:
tests/unit/repositories/test_daily_report_repository.py:247: in test_delete_daily_report_not_found
    delete_result = await report_repository.delete_daily_report(non_existent_id)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
app/repositories/daily_report_repository.py:322: in delete_daily_report
    existing_report = await self.get_daily_report_by_id(report_id)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
app/repositories/daily_report_repository.py:180: in get_daily_report_by_id
    raise DatabaseError(f"Unexpected error getting daily report by ID {report_id}: {str(e)}")
E   app.core.exceptions.DatabaseError: Unexpected error getting daily report by ID 003f1fd7-08e5-48a2-80bb-0c9394383b82: 2 validation errors for DailyReport
E   user_id
E     Field required [type=missing, input_value={}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   raw_text_input
E     Field required [type=missing, input_value={}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
----------------------------- Captured stderr call -----------------------------
2025-09-05 12:00:31,930 - app.repositories.daily_report_repository - ERROR - Unexpected error getting daily report by ID UUID_REDACTED: 2 validation errors for DailyReport
user_id
  Field required [type=missing, input_value={}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
raw_text_input
  Field required [type=missing, input_value={}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
Traceback (most recent call last):
  File "/Users/parkerbeard/golfdaddy-brain/backend/app/repositories/daily_report_repository.py", line 169, in get_daily_report_by_id
    return self._db_to_model(response.data)
           ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "/Users/parkerbeard/golfdaddy-brain/backend/app/repositories/daily_report_repository.py", line 88, in _db_to_model
    return DailyReport(**db_data)
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/pydantic/main.py", line 253, in __init__
    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)
pydantic_core._pydantic_core.ValidationError: 2 validation errors for DailyReport
user_id
  Field required [type=missing, input_value={}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
raw_text_input
  Field required [type=missing, input_value={}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
------------------------------ Captured log call -------------------------------
ERROR    app.repositories.daily_report_repository:daily_report_repository.py:179 Unexpected error getting daily report by ID UUID_REDACTED: 2 validation errors for DailyReport
user_id
  Field required [type=missing, input_value={}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
raw_text_input
  Field required [type=missing, input_value={}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
Traceback (most recent call last):
  File "/Users/parkerbeard/golfdaddy-brain/backend/app/repositories/daily_report_repository.py", line 169, in get_daily_report_by_id
    return self._db_to_model(response.data)
           ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "/Users/parkerbeard/golfdaddy-brain/backend/app/repositories/daily_report_repository.py", line 88, in _db_to_model
    return DailyReport(**db_data)
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/pydantic/main.py", line 253, in __init__
    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)
pydantic_core._pydantic_core.ValidationError: 2 validation errors for DailyReport
user_id
  Field required [type=missing, input_value={}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
raw_text_input
  Field required [type=missing, input_value={}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
__________________________ test_get_all_daily_reports __________________________
tests/unit/repositories/test_daily_report_repository.py:252: in test_get_all_daily_reports
    await report_repository.create_daily_report(DailyReportCreate(user_id=sample_user_id, raw_text_input="R1"))
app/repositories/daily_report_repository.py:150: in create_daily_report
    self._handle_supabase_error(response, "Failed to create daily report")
app/repositories/daily_report_repository.py:28: in _handle_supabase_error
    raise DatabaseError(f"{context_message}: {response.error.message}")
E   app.core.exceptions.DatabaseError: Failed to create daily report: <MagicMock name='mock.execute().error.message' id='4752051568'>
----------------------------- Captured stderr call -----------------------------
2025-09-05 12:00:31,945 - app.repositories.daily_report_repository - ERROR - Failed to create daily report: Supabase error code <MagicMock name='mock.execute().error.code' id='4752050896'> - <MagicMock name='mock.execute().error.message' id='4752051568'>
NoneType: None
------------------------------ Captured log call -------------------------------
ERROR    app.repositories.daily_report_repository:daily_report_repository.py:24 Failed to create daily report: Supabase error code <MagicMock name='mock.execute().error.code' id='4752050896'> - <MagicMock name='mock.execute().error.message' id='4752051568'>
NoneType: None
_______________________________ test_create_user _______________________________
tests/unit/repositories/test_user_repository.py:28: in test_create_user
    user_data_to_create = User(
E   pydantic_core._pydantic_core.ValidationError: 2 validation errors for User
E   created_at
E     Field required [type=missing, input_value={'id': UUID('3420c189-091..., 'team': 'Engineering'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   updated_at
E     Field required [type=missing, input_value={'id': UUID('3420c189-091..., 'team': 'Engineering'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
_____________________________ test_get_user_by_id ______________________________
tests/unit/repositories/test_user_repository.py:69: in test_get_user_by_id
    assert found_user.id == test_user_id
           ^^^^^^^^^^^^^
E   AttributeError: 'coroutine' object has no attribute 'id'
__________________________ test_get_user_by_slack_id ___________________________
tests/unit/repositories/test_user_repository.py:101: in test_get_user_by_slack_id
    assert found_user.slack_id == test_slack_id
           ^^^^^^^^^^^^^^^^^^^
E   AttributeError: 'coroutine' object has no attribute 'slack_id'
___________________________ test_list_users_by_role ____________________________
tests/unit/repositories/test_user_repository.py:135: in test_list_users_by_role
    assert len(developers) == 2
           ^^^^^^^^^^^^^^^
E   TypeError: object of type 'coroutine' has no len()
_______________________________ test_update_user _______________________________
tests/unit/repositories/test_user_repository.py:172: in test_update_user
    assert updated_user.id == user_id_to_update
           ^^^^^^^^^^^^^^^
E   AttributeError: 'coroutine' object has no attribute 'id'
_______________________ test_analyze_for_date_automatic ________________________
tests/unit/services/test_daily_commit_analysis_service.py:239: in test_analyze_for_date_automatic
    return_value=DailyCommitAnalysis(
E   pydantic_core._pydantic_core.ValidationError: 2 validation errors for DailyCommitAnalysis
E   created_at
E     Field required [type=missing, input_value={'id': UUID('8009d9c9-418...nt new API endpoints']}}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   updated_at
E     Field required [type=missing, input_value={'id': UUID('8009d9c9-418...nt new API endpoints']}}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
__________________________ test_run_midnight_analysis __________________________
tests/unit/services/test_daily_commit_analysis_service.py:282: in test_run_midnight_analysis
    result = await service.run_midnight_analysis()
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
app/services/daily_commit_analysis_service.py:149: in run_midnight_analysis
    users_needing_analysis = await self.repository.get_users_without_analysis(yesterday)
                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   TypeError: object list can't be used in 'await' expression
----------------------------- Captured stderr call -----------------------------
2025-09-05 12:00:32,052 - app.services.daily_commit_analysis_service - INFO - Running midnight analysis for 2025-09-04
2025-09-05 12:00:32,052 - app.services.daily_commit_analysis_service - ERROR - Error in midnight analysis: object list can't be used in 'await' expression
Traceback (most recent call last):
  File "/Users/parkerbeard/golfdaddy-brain/backend/app/services/daily_commit_analysis_service.py", line 149, in run_midnight_analysis
    users_needing_analysis = await self.repository.get_users_without_analysis(yesterday)
                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: object list can't be used in 'await' expression
------------------------------ Captured log call -------------------------------
INFO     app.services.daily_commit_analysis_service:daily_commit_analysis_service.py:146 Running midnight analysis for 2025-09-04
ERROR    app.services.daily_commit_analysis_service:daily_commit_analysis_service.py:174 Error in midnight analysis: object list can't be used in 'await' expression
Traceback (most recent call last):
  File "/Users/parkerbeard/golfdaddy-brain/backend/app/services/daily_commit_analysis_service.py", line 149, in run_midnight_analysis
    users_needing_analysis = await self.repository.get_users_without_analysis(yesterday)
                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: object list can't be used in 'await' expression
________________________ test_get_user_analysis_history ________________________
tests/unit/services/test_daily_commit_analysis_service.py:333: in test_get_user_analysis_history
    result = await service.get_user_analysis_history(sample_user_id, start_date, end_date)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
app/services/daily_commit_analysis_service.py:182: in get_user_analysis_history
    return await self.repository.get_user_analyses_in_range(user_id, start_date, end_date)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   TypeError: object list can't be used in 'await' expression
----------------------------- Captured stderr call -----------------------------
2025-09-05 12:00:32,060 - app.services.daily_commit_analysis_service - ERROR - Error fetching analysis history: object list can't be used in 'await' expression
Traceback (most recent call last):
  File "/Users/parkerbeard/golfdaddy-brain/backend/app/services/daily_commit_analysis_service.py", line 182, in get_user_analysis_history
    return await self.repository.get_user_analyses_in_range(user_id, start_date, end_date)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: object list can't be used in 'await' expression
------------------------------ Captured log call -------------------------------
ERROR    app.services.daily_commit_analysis_service:daily_commit_analysis_service.py:184 Error fetching analysis history: object list can't be used in 'await' expression
Traceback (most recent call last):
  File "/Users/parkerbeard/golfdaddy-brain/backend/app/services/daily_commit_analysis_service.py", line 182, in get_user_analysis_history
    return await self.repository.get_user_analyses_in_range(user_id, start_date, end_date)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: object list can't be used in 'await' expression
_________________________ test_submit_daily_report_new _________________________
/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/unittest/mock.py:958: in assert_called_once
    raise AssertionError(msg)
E   AssertionError: Expected 'update_daily_report' to have been called once. Called 0 times.

During handling of the above exception, another exception occurred:
tests/unit/services/test_daily_report_service.py:94: in test_submit_daily_report_new
    mock_report_repository.update_daily_report.assert_called_once()
E   AssertionError: Expected 'update_daily_report' to have been called once. Called 0 times.
---------------------------- Captured stderr setup -----------------------------
2025-09-05 12:00:32,069 - app.integrations.ai_integration_v2 - INFO - AIIntegrationV2 initialized. Model: gpt-5-2025-08-07
2025-09-05 12:00:32,072 - app.integrations.ai_integration_v2 - INFO - AIIntegrationV2 initialized. Model: gpt-5-2025-08-07
------------------------------ Captured log setup ------------------------------
INFO     app.integrations.ai_integration_v2:ai_integration_v2.py:36 AIIntegrationV2 initialized. Model: gpt-5-2025-08-07
INFO     app.integrations.ai_integration_v2:ai_integration_v2.py:36 AIIntegrationV2 initialized. Model: gpt-5-2025-08-07
----------------------------- Captured stderr call -----------------------------
2025-09-05 12:00:32,072 - app.services.daily_report_service - INFO - Performing AI analysis on EOD report UUID_REDACTED
2025-09-05 12:00:32,282 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-09-05 12:00:32,284 - app.integrations.ai_integration_v2 - ERROR - OpenAI API error: Error code: 400 - {'error': {'message': "Unsupported value: 'temperature' does not support 0.3 with this model. Only the default (1) value is supported.", 'type': 'invalid_request_error', 'param': 'temperature', 'code': 'unsupported_value'}}
Traceback (most recent call last):
  File "/Users/parkerbeard/golfdaddy-brain/backend/app/integrations/ai_integration_v2.py", line 76, in _make_completion_request
    response = await self.client.chat.completions.create(**params)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/openai/resources/chat/completions/completions.py", line 2454, in create
    return await self._post(
           ^^^^^^^^^^^^^^^^^
    ...<45 lines>...
    )
    ^
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/openai/_base_client.py", line 1791, in post
    return await self.request(cast_to, opts, stream=stream, stream_cls=stream_cls)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/openai/_base_client.py", line 1591, in request
    raise self._make_status_error_from_response(err.response) from None
openai.BadRequestError: Error code: 400 - {'error': {'message': "Unsupported value: 'temperature' does not support 0.3 with this model. Only the default (1) value is supported.", 'type': 'invalid_request_error', 'param': 'temperature', 'code': 'unsupported_value'}}
2025-09-05 12:00:32,299 - app.services.daily_report_service - ERROR - AI analysis for EOD report UUID_REDACTED returned an error: Failed to analyze report
------------------------------ Captured log call -------------------------------
INFO     app.services.daily_report_service:daily_report_service.py:180 Performing AI analysis on EOD report UUID_REDACTED
INFO     httpx:_client.py:1740 HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
ERROR    app.integrations.ai_integration_v2:ai_integration_v2.py:86 OpenAI API error: Error code: 400 - {'error': {'message': "Unsupported value: 'temperature' does not support 0.3 with this model. Only the default (1) value is supported.", 'type': 'invalid_request_error', 'param': 'temperature', 'code': 'unsupported_value'}}
Traceback (most recent call last):
  File "/Users/parkerbeard/golfdaddy-brain/backend/app/integrations/ai_integration_v2.py", line 76, in _make_completion_request
    response = await self.client.chat.completions.create(**params)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/openai/resources/chat/completions/completions.py", line 2454, in create
    return await self._post(
           ^^^^^^^^^^^^^^^^^
    ...<45 lines>...
    )
    ^
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/openai/_base_client.py", line 1791, in post
    return await self.request(cast_to, opts, stream=stream, stream_cls=stream_cls)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/openai/_base_client.py", line 1591, in request
    raise self._make_status_error_from_response(err.response) from None
openai.BadRequestError: Error code: 400 - {'error': {'message': "Unsupported value: 'temperature' does not support 0.3 with this model. Only the default (1) value is supported.", 'type': 'invalid_request_error', 'param': 'temperature', 'code': 'unsupported_value'}}
ERROR    app.services.daily_report_service:daily_report_service.py:184 AI analysis for EOD report UUID_REDACTED returned an error: Failed to analyze report
______________________ test_submit_daily_report_existing _______________________
tests/unit/services/test_daily_report_service.py:143: in test_submit_daily_report_existing
    report = await daily_report_service.submit_daily_report(sample_daily_report_create_data, sample_user_id)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
app/services/daily_report_service.py:48: in submit_daily_report
    raise BadRequestError(
E   app.core.exceptions.BadRequestError: A report for today already exists. Use the update functionality to add more details.
---------------------------- Captured stderr setup -----------------------------
2025-09-05 12:00:32,324 - app.integrations.ai_integration_v2 - INFO - AIIntegrationV2 initialized. Model: gpt-5-2025-08-07
2025-09-05 12:00:32,328 - app.integrations.ai_integration_v2 - INFO - AIIntegrationV2 initialized. Model: gpt-5-2025-08-07
------------------------------ Captured log setup ------------------------------
INFO     app.integrations.ai_integration_v2:ai_integration_v2.py:36 AIIntegrationV2 initialized. Model: gpt-5-2025-08-07
INFO     app.integrations.ai_integration_v2:ai_integration_v2.py:36 AIIntegrationV2 initialized. Model: gpt-5-2025-08-07
_________________ test_submit_daily_report_ai_processing_fails _________________
/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/unittest/mock.py:958: in assert_called_once
    raise AssertionError(msg)
E   AssertionError: Expected 'update_daily_report' to have been called once. Called 0 times.

During handling of the above exception, another exception occurred:
tests/unit/services/test_daily_report_service.py:186: in test_submit_daily_report_ai_processing_fails
    mock_report_repository.update_daily_report.assert_called_once()  # Called for AI data
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   AssertionError: Expected 'update_daily_report' to have been called once. Called 0 times.
---------------------------- Captured stderr setup -----------------------------
2025-09-05 12:00:32,339 - app.integrations.ai_integration_v2 - INFO - AIIntegrationV2 initialized. Model: gpt-5-2025-08-07
2025-09-05 12:00:32,342 - app.integrations.ai_integration_v2 - INFO - AIIntegrationV2 initialized. Model: gpt-5-2025-08-07
------------------------------ Captured log setup ------------------------------
INFO     app.integrations.ai_integration_v2:ai_integration_v2.py:36 AIIntegrationV2 initialized. Model: gpt-5-2025-08-07
INFO     app.integrations.ai_integration_v2:ai_integration_v2.py:36 AIIntegrationV2 initialized. Model: gpt-5-2025-08-07
----------------------------- Captured stderr call -----------------------------
2025-09-05 12:00:32,343 - app.services.daily_report_service - INFO - Performing AI analysis on EOD report UUID_REDACTED
2025-09-05 12:00:32,512 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-09-05 12:00:32,513 - app.integrations.ai_integration_v2 - ERROR - OpenAI API error: Error code: 400 - {'error': {'message': "Unsupported value: 'temperature' does not support 0.3 with this model. Only the default (1) value is supported.", 'type': 'invalid_request_error', 'param': 'temperature', 'code': 'unsupported_value'}}
Traceback (most recent call last):
  File "/Users/parkerbeard/golfdaddy-brain/backend/app/integrations/ai_integration_v2.py", line 76, in _make_completion_request
    response = await self.client.chat.completions.create(**params)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/openai/resources/chat/completions/completions.py", line 2454, in create
    return await self._post(
           ^^^^^^^^^^^^^^^^^
    ...<45 lines>...
    )
    ^
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/openai/_base_client.py", line 1791, in post
    return await self.request(cast_to, opts, stream=stream, stream_cls=stream_cls)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/openai/_base_client.py", line 1591, in request
    raise self._make_status_error_from_response(err.response) from None
openai.BadRequestError: Error code: 400 - {'error': {'message': "Unsupported value: 'temperature' does not support 0.3 with this model. Only the default (1) value is supported.", 'type': 'invalid_request_error', 'param': 'temperature', 'code': 'unsupported_value'}}
2025-09-05 12:00:32,527 - app.services.daily_report_service - ERROR - AI analysis for EOD report UUID_REDACTED returned an error: Failed to analyze report
------------------------------ Captured log call -------------------------------
INFO     app.services.daily_report_service:daily_report_service.py:180 Performing AI analysis on EOD report UUID_REDACTED
INFO     httpx:_client.py:1740 HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
ERROR    app.integrations.ai_integration_v2:ai_integration_v2.py:86 OpenAI API error: Error code: 400 - {'error': {'message': "Unsupported value: 'temperature' does not support 0.3 with this model. Only the default (1) value is supported.", 'type': 'invalid_request_error', 'param': 'temperature', 'code': 'unsupported_value'}}
Traceback (most recent call last):
  File "/Users/parkerbeard/golfdaddy-brain/backend/app/integrations/ai_integration_v2.py", line 76, in _make_completion_request
    response = await self.client.chat.completions.create(**params)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/openai/resources/chat/completions/completions.py", line 2454, in create
    return await self._post(
           ^^^^^^^^^^^^^^^^^
    ...<45 lines>...
    )
    ^
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/openai/_base_client.py", line 1791, in post
    return await self.request(cast_to, opts, stream=stream, stream_cls=stream_cls)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/openai/_base_client.py", line 1591, in request
    raise self._make_status_error_from_response(err.response) from None
openai.BadRequestError: Error code: 400 - {'error': {'message': "Unsupported value: 'temperature' does not support 0.3 with this model. Only the default (1) value is supported.", 'type': 'invalid_request_error', 'param': 'temperature', 'code': 'unsupported_value'}}
ERROR    app.services.daily_report_service:daily_report_service.py:184 AI analysis for EOD report UUID_REDACTED returned an error: Failed to analyze report
___________ test_submit_daily_report_update_fails_after_get_existing ___________
tests/unit/services/test_daily_report_service.py:358: in test_submit_daily_report_update_fails_after_get_existing
    await daily_report_service.submit_daily_report(sample_daily_report_create_data, sample_user_id)
app/services/daily_report_service.py:48: in submit_daily_report
    raise BadRequestError(
E   app.core.exceptions.BadRequestError: A report for today already exists. Use the update functionality to add more details.

During handling of the above exception, another exception occurred:
tests/unit/services/test_daily_report_service.py:357: in test_submit_daily_report_update_fails_after_get_existing
    with pytest.raises(Exception, match="Failed to update existing report"):
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   AssertionError: Regex pattern did not match.
E    Regex: 'Failed to update existing report'
E    Input: 'A report for today already exists. Use the update functionality to add more details.'
---------------------------- Captured stderr setup -----------------------------
2025-09-05 12:00:32,614 - app.integrations.ai_integration_v2 - INFO - AIIntegrationV2 initialized. Model: gpt-5-2025-08-07
2025-09-05 12:00:32,617 - app.integrations.ai_integration_v2 - INFO - AIIntegrationV2 initialized. Model: gpt-5-2025-08-07
------------------------------ Captured log setup ------------------------------
INFO     app.integrations.ai_integration_v2:ai_integration_v2.py:36 AIIntegrationV2 initialized. Model: gpt-5-2025-08-07
INFO     app.integrations.ai_integration_v2:ai_integration_v2.py:36 AIIntegrationV2 initialized. Model: gpt-5-2025-08-07
____ test_submit_daily_report_ai_update_fails_after_successful_first_update ____
tests/unit/services/test_daily_report_service.py:386: in test_submit_daily_report_ai_update_fails_after_successful_first_update
    returned_report = await daily_report_service.submit_daily_report(sample_daily_report_create_data, sample_user_id)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
app/services/daily_report_service.py:48: in submit_daily_report
    raise BadRequestError(
E   app.core.exceptions.BadRequestError: A report for today already exists. Use the update functionality to add more details.
---------------------------- Captured stderr setup -----------------------------
2025-09-05 12:00:32,625 - app.integrations.ai_integration_v2 - INFO - AIIntegrationV2 initialized. Model: gpt-5-2025-08-07
2025-09-05 12:00:32,628 - app.integrations.ai_integration_v2 - INFO - AIIntegrationV2 initialized. Model: gpt-5-2025-08-07
------------------------------ Captured log setup ------------------------------
INFO     app.integrations.ai_integration_v2:ai_integration_v2.py:36 AIIntegrationV2 initialized. Model: gpt-5-2025-08-07
INFO     app.integrations.ai_integration_v2:ai_integration_v2.py:36 AIIntegrationV2 initialized. Model: gpt-5-2025-08-07
________________ test_submit_daily_report_ai_service_exception _________________
/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/unittest/mock.py:958: in assert_called_once
    raise AssertionError(msg)
E   AssertionError: Expected 'update_daily_report' to have been called once. Called 0 times.

During handling of the above exception, another exception occurred:
tests/unit/services/test_daily_report_service.py:421: in test_submit_daily_report_ai_service_exception
    mock_report_repository.update_daily_report.assert_called_once()  # Attempted but raised exception
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   AssertionError: Expected 'update_daily_report' to have been called once. Called 0 times.
---------------------------- Captured stderr setup -----------------------------
2025-09-05 12:00:32,636 - app.integrations.ai_integration_v2 - INFO - AIIntegrationV2 initialized. Model: gpt-5-2025-08-07
2025-09-05 12:00:32,639 - app.integrations.ai_integration_v2 - INFO - AIIntegrationV2 initialized. Model: gpt-5-2025-08-07
------------------------------ Captured log setup ------------------------------
INFO     app.integrations.ai_integration_v2:ai_integration_v2.py:36 AIIntegrationV2 initialized. Model: gpt-5-2025-08-07
INFO     app.integrations.ai_integration_v2:ai_integration_v2.py:36 AIIntegrationV2 initialized. Model: gpt-5-2025-08-07
----------------------------- Captured stderr call -----------------------------
2025-09-05 12:00:32,640 - app.services.daily_report_service - INFO - Performing AI analysis on EOD report UUID_REDACTED
2025-09-05 12:00:33,385 - httpx - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
2025-09-05 12:00:33,388 - app.integrations.ai_integration_v2 - ERROR - OpenAI API error: Error code: 400 - {'error': {'message': "Unsupported value: 'temperature' does not support 0.3 with this model. Only the default (1) value is supported.", 'type': 'invalid_request_error', 'param': 'temperature', 'code': 'unsupported_value'}}
Traceback (most recent call last):
  File "/Users/parkerbeard/golfdaddy-brain/backend/app/integrations/ai_integration_v2.py", line 76, in _make_completion_request
    response = await self.client.chat.completions.create(**params)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/openai/resources/chat/completions/completions.py", line 2454, in create
    return await self._post(
           ^^^^^^^^^^^^^^^^^
    ...<45 lines>...
    )
    ^
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/openai/_base_client.py", line 1791, in post
    return await self.request(cast_to, opts, stream=stream, stream_cls=stream_cls)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/openai/_base_client.py", line 1591, in request
    raise self._make_status_error_from_response(err.response) from None
openai.BadRequestError: Error code: 400 - {'error': {'message': "Unsupported value: 'temperature' does not support 0.3 with this model. Only the default (1) value is supported.", 'type': 'invalid_request_error', 'param': 'temperature', 'code': 'unsupported_value'}}
2025-09-05 12:00:33,409 - app.services.daily_report_service - ERROR - AI analysis for EOD report UUID_REDACTED returned an error: Failed to analyze report
------------------------------ Captured log call -------------------------------
INFO     app.services.daily_report_service:daily_report_service.py:180 Performing AI analysis on EOD report UUID_REDACTED
INFO     httpx:_client.py:1740 HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 400 Bad Request"
ERROR    app.integrations.ai_integration_v2:ai_integration_v2.py:86 OpenAI API error: Error code: 400 - {'error': {'message': "Unsupported value: 'temperature' does not support 0.3 with this model. Only the default (1) value is supported.", 'type': 'invalid_request_error', 'param': 'temperature', 'code': 'unsupported_value'}}
Traceback (most recent call last):
  File "/Users/parkerbeard/golfdaddy-brain/backend/app/integrations/ai_integration_v2.py", line 76, in _make_completion_request
    response = await self.client.chat.completions.create(**params)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/openai/resources/chat/completions/completions.py", line 2454, in create
    return await self._post(
           ^^^^^^^^^^^^^^^^^
    ...<45 lines>...
    )
    ^
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/openai/_base_client.py", line 1791, in post
    return await self.request(cast_to, opts, stream=stream, stream_cls=stream_cls)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/openai/_base_client.py", line 1591, in request
    raise self._make_status_error_from_response(err.response) from None
openai.BadRequestError: Error code: 400 - {'error': {'message': "Unsupported value: 'temperature' does not support 0.3 with this model. Only the default (1) value is supported.", 'type': 'invalid_request_error', 'param': 'temperature', 'code': 'unsupported_value'}}
ERROR    app.services.daily_report_service:daily_report_service.py:184 AI analysis for EOD report UUID_REDACTED returned an error: Failed to analyze report
___________ TestDeduplicationService.test_apply_deduplication_rules ____________
tests/unit/services/test_deduplication_service.py:169: in test_apply_deduplication_rules
    pattern="implement user authentication", work_type=WorkType.FEATURE, confidence_boost=0.2
                                                       ^^^^^^^^^^^^^^^^
E   AttributeError: type object 'WorkType' has no attribute 'FEATURE'
---------------------------- Captured stderr setup -----------------------------
2025-09-05 12:00:33,454 - app.integrations.ai_integration_v2 - INFO - AIIntegrationV2 initialized. Model: gpt-5-2025-08-07
------------------------------ Captured log setup ------------------------------
INFO     app.integrations.ai_integration_v2:ai_integration_v2.py:36 AIIntegrationV2 initialized. Model: gpt-5-2025-08-07
______ TestDeduplicationService.test_deduplication_with_time_correlation _______
tests/unit/services/test_deduplication_service.py:194: in test_deduplication_with_time_correlation
    recent_commit = Commit(
E   pydantic_core._pydantic_core.ValidationError: 1 validation error for Commit
E   commit_timestamp
E     Field required [type=missing, input_value={'id': UUID('d02eff71-90f...d0c-9d5c-172d6fe42b81')}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
---------------------------- Captured stderr setup -----------------------------
2025-09-05 12:00:33,463 - app.integrations.ai_integration_v2 - INFO - AIIntegrationV2 initialized. Model: gpt-5-2025-08-07
------------------------------ Captured log setup ------------------------------
INFO     app.integrations.ai_integration_v2:ai_integration_v2.py:36 AIIntegrationV2 initialized. Model: gpt-5-2025-08-07
________ TestDeduplicationService.test_deduplication_result_persistence ________
tests/unit/services/test_deduplication_service.py:300: in test_deduplication_result_persistence
    result = DeduplicationResult(
E   TypeError: DeduplicationResult.__init__() got an unexpected keyword argument 'duplicates'
---------------------------- Captured stderr setup -----------------------------
2025-09-05 12:00:33,476 - app.integrations.ai_integration_v2 - INFO - AIIntegrationV2 initialized. Model: gpt-5-2025-08-07
------------------------------ Captured log setup ------------------------------
INFO     app.integrations.ai_integration_v2:ai_integration_v2.py:36 AIIntegrationV2 initialized. Model: gpt-5-2025-08-07
______________ TestDeduplicationService.test_handle_empty_inputs _______________
tests/unit/services/test_deduplication_service.py:320: in test_handle_empty_inputs
    report = DailyReport(
E   pydantic_core._pydantic_core.ValidationError: 1 validation error for DailyReport
E   raw_text_input
E     Field required [type=missing, input_value={'id': UUID('d50d08d4-24f...=datetime.timezone.utc)}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
---------------------------- Captured stderr setup -----------------------------
2025-09-05 12:00:33,482 - app.integrations.ai_integration_v2 - INFO - AIIntegrationV2 initialized. Model: gpt-5-2025-08-07
------------------------------ Captured log setup ------------------------------
INFO     app.integrations.ai_integration_v2:ai_integration_v2.py:36 AIIntegrationV2 initialized. Model: gpt-5-2025-08-07
_________ TestDeduplicationService.test_complex_deduplication_scenario _________
tests/unit/services/test_deduplication_service.py:355: in test_complex_deduplication_scenario
    Commit(
E   pydantic_core._pydantic_core.ValidationError: 1 validation error for Commit
E   commit_timestamp
E     Field required [type=missing, input_value={'id': UUID('12fa0547-4c9...5bc-9c72-19b7c710efe0')}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
---------------------------- Captured stderr setup -----------------------------
2025-09-05 12:00:33,494 - app.integrations.ai_integration_v2 - INFO - AIIntegrationV2 initialized. Model: gpt-5-2025-08-07
------------------------------ Captured log setup ------------------------------
INFO     app.integrations.ai_integration_v2:ai_integration_v2.py:36 AIIntegrationV2 initialized. Model: gpt-5-2025-08-07
_ TestUnifiedDailyAnalysisService.test_analyze_daily_work_with_commits_and_report _
tests/unit/services/test_unified_daily_analysis_service.py:204: in test_analyze_daily_work_with_commits_and_report
    expected_analysis = DailyWorkAnalysis(
                        ^^^^^^^^^^^^^^^^^
E   NameError: name 'DailyWorkAnalysis' is not defined
---------------------------- Captured stderr setup -----------------------------
2025-09-05 12:00:33,499 - app.integrations.ai_integration_v2 - INFO - AIIntegrationV2 initialized. Model: gpt-5-2025-08-07
------------------------------ Captured log setup ------------------------------
INFO     app.integrations.ai_integration_v2:ai_integration_v2.py:36 AIIntegrationV2 initialized. Model: gpt-5-2025-08-07
_____ TestUnifiedDailyAnalysisService.test_analyze_daily_work_commits_only _____
tests/unit/services/test_unified_daily_analysis_service.py:293: in test_analyze_daily_work_commits_only
    expected_analysis = DailyWorkAnalysis(
                        ^^^^^^^^^^^^^^^^^
E   NameError: name 'DailyWorkAnalysis' is not defined
---------------------------- Captured stderr setup -----------------------------
2025-09-05 12:00:33,508 - app.integrations.ai_integration_v2 - INFO - AIIntegrationV2 initialized. Model: gpt-5-2025-08-07
------------------------------ Captured log setup ------------------------------
INFO     app.integrations.ai_integration_v2:ai_integration_v2.py:36 AIIntegrationV2 initialized. Model: gpt-5-2025-08-07
_____ TestUnifiedDailyAnalysisService.test_analyze_daily_work_report_only ______
tests/unit/services/test_unified_daily_analysis_service.py:384: in test_analyze_daily_work_report_only
    expected_analysis = DailyWorkAnalysis(
                        ^^^^^^^^^^^^^^^^^
E   NameError: name 'DailyWorkAnalysis' is not defined
---------------------------- Captured stderr setup -----------------------------
2025-09-05 12:00:33,514 - app.integrations.ai_integration_v2 - INFO - AIIntegrationV2 initialized. Model: gpt-5-2025-08-07
------------------------------ Captured log setup ------------------------------
INFO     app.integrations.ai_integration_v2:ai_integration_v2.py:36 AIIntegrationV2 initialized. Model: gpt-5-2025-08-07
_____ TestUnifiedDailyAnalysisService.test_analyze_daily_work_no_activity ______
app/repositories/daily_commit_analysis_repository.py:93: in get_by_user_and_date
    .execute()
     ^^^^^^^^^
venv/lib/python3.13/site-packages/postgrest/_sync/request_builder.py:140: in execute
    raise APIError(
E   postgrest.exceptions.APIError: {'message': 'Missing response', 'code': '204', 'hint': 'Please check traceback of the code', 'details': "Postgrest couldn't retrieve response, please check traceback of the code. Please create an issue in `supabase-community/postgrest-py` if needed."}

During handling of the above exception, another exception occurred:
app/services/daily_commit_analysis_service.py:47: in analyze
    existing = await self.repository.get_by_user_and_date(user_id, analysis_date)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
app/repositories/daily_commit_analysis_repository.py:105: in get_by_user_and_date
    raise DatabaseError(f"Error fetching daily analysis: {str(e)}")
E   app.core.exceptions.DatabaseError: Error fetching daily analysis: {'message': 'Missing response', 'code': '204', 'hint': 'Please check traceback of the code', 'details': "Postgrest couldn't retrieve response, please check traceback of the code. Please create an issue in `supabase-community/postgrest-py` if needed."}

During handling of the above exception, another exception occurred:
app/services/unified_daily_analysis_service.py:51: in analyze_daily_work
    return await self._delegate.analyze(user_id=user_id, analysis_date=analysis_date, force_reanalysis=force_reanalysis)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
app/services/daily_commit_analysis_service.py:116: in analyze
    raise ExternalServiceError(
E   app.core.exceptions.ExternalServiceError: An error occurred while communicating with Daily Work Analysis. Details: Failed to analyze daily work: Error fetching daily analysis: {'message': 'Missing response', 'code': '204', 'hint': 'Please check traceback of the code', 'details': "Postgrest couldn't retrieve response, please check traceback of the code. Please create an issue in `supabase-community/postgrest-py` if needed."}

During handling of the above exception, another exception occurred:
tests/unit/services/test_unified_daily_analysis_service.py:421: in test_analyze_daily_work_no_activity
    result = await service.analyze_daily_work(sample_user_id, sample_date)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
app/services/unified_daily_analysis_service.py:54: in analyze_daily_work
    raise ExternalServiceError(
E   app.core.exceptions.ExternalServiceError: An error occurred while communicating with Unified Daily Analysis. Details: Failed to analyze daily work: An error occurred while communicating with Daily Work Analysis. Details: Failed to analyze daily work: Error fetching daily analysis: {'message': 'Missing response', 'code': '204', 'hint': 'Please check traceback of the code', 'details': "Postgrest couldn't retrieve response, please check traceback of the code. Please create an issue in `supabase-community/postgrest-py` if needed."}
---------------------------- Captured stderr setup -----------------------------
2025-09-05 12:00:33,521 - app.integrations.ai_integration_v2 - INFO - AIIntegrationV2 initialized. Model: gpt-5-2025-08-07
------------------------------ Captured log setup ------------------------------
INFO     app.integrations.ai_integration_v2:ai_integration_v2.py:36 AIIntegrationV2 initialized. Model: gpt-5-2025-08-07
----------------------------- Captured stderr call -----------------------------
2025-09-05 12:00:33,522 - app.services.unified_daily_analysis_service - INFO - Delegating unified daily analysis for user UUID_REDACTED on 2024-01-15 (force=False)
2025-09-05 12:00:33,523 - app.services.daily_commit_analysis_service - INFO - Starting unified daily analysis for user UUID_REDACTED on 2024-01-15 (force=False)
2025-09-05 12:00:33,523 - app.repositories.daily_commit_analysis_repository - INFO - Fetching daily analysis for user UUID_REDACTED on 2024-01-15
2025-09-05 12:00:33,740 - httpx - INFO - HTTP Request: GET https://xfnxafbsmqowzvuwmhvi.supabase.co//rest/v1/daily_commit_analysis?select=%2A&user_id=eq.UUID_REDACTED&analysis_date=eq.2024-01-15 "HTTP/2 404 Not Found"
2025-09-05 12:00:33,743 - app.repositories.daily_commit_analysis_repository - ERROR - Error fetching daily analysis: {'message': 'Missing response', 'code': '204', 'hint': 'Please check traceback of the code', 'details': "Postgrest couldn't retrieve response, please check traceback of the code. Please create an issue in `supabase-community/postgrest-py` if needed."}
Traceback (most recent call last):
  File "/Users/parkerbeard/golfdaddy-brain/backend/app/repositories/daily_commit_analysis_repository.py", line 93, in get_by_user_and_date
    .execute()
     ~~~~~~~^^
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/postgrest/_sync/request_builder.py", line 140, in execute
    raise APIError(
    ...<6 lines>...
    )
postgrest.exceptions.APIError: {'message': 'Missing response', 'code': '204', 'hint': 'Please check traceback of the code', 'details': "Postgrest couldn't retrieve response, please check traceback of the code. Please create an issue in `supabase-community/postgrest-py` if needed."}
2025-09-05 12:00:33,753 - app.services.daily_commit_analysis_service - ERROR - Error in unified daily analysis: Error fetching daily analysis: {'message': 'Missing response', 'code': '204', 'hint': 'Please check traceback of the code', 'details': "Postgrest couldn't retrieve response, please check traceback of the code. Please create an issue in `supabase-community/postgrest-py` if needed."}
Traceback (most recent call last):
  File "/Users/parkerbeard/golfdaddy-brain/backend/app/repositories/daily_commit_analysis_repository.py", line 93, in get_by_user_and_date
    .execute()
     ~~~~~~~^^
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/postgrest/_sync/request_builder.py", line 140, in execute
    raise APIError(
    ...<6 lines>...
    )
postgrest.exceptions.APIError: {'message': 'Missing response', 'code': '204', 'hint': 'Please check traceback of the code', 'details': "Postgrest couldn't retrieve response, please check traceback of the code. Please create an issue in `supabase-community/postgrest-py` if needed."}

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/parkerbeard/golfdaddy-brain/backend/app/services/daily_commit_analysis_service.py", line 47, in analyze
    existing = await self.repository.get_by_user_and_date(user_id, analysis_date)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/parkerbeard/golfdaddy-brain/backend/app/repositories/daily_commit_analysis_repository.py", line 105, in get_by_user_and_date
    raise DatabaseError(f"Error fetching daily analysis: {str(e)}")
app.core.exceptions.DatabaseError: Error fetching daily analysis: {'message': 'Missing response', 'code': '204', 'hint': 'Please check traceback of the code', 'details': "Postgrest couldn't retrieve response, please check traceback of the code. Please create an issue in `supabase-community/postgrest-py` if needed."}
2025-09-05 12:00:33,767 - app.services.unified_daily_analysis_service - ERROR - Error delegating unified daily analysis: An error occurred while communicating with Daily Work Analysis. Details: Failed to analyze daily work: Error fetching daily analysis: {'message': 'Missing response', 'code': '204', 'hint': 'Please check traceback of the code', 'details': "Postgrest couldn't retrieve response, please check traceback of the code. Please create an issue in `supabase-community/postgrest-py` if needed."}
Traceback (most recent call last):
  File "/Users/parkerbeard/golfdaddy-brain/backend/app/repositories/daily_commit_analysis_repository.py", line 93, in get_by_user_and_date
    .execute()
     ~~~~~~~^^
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/postgrest/_sync/request_builder.py", line 140, in execute
    raise APIError(
    ...<6 lines>...
    )
postgrest.exceptions.APIError: {'message': 'Missing response', 'code': '204', 'hint': 'Please check traceback of the code', 'details': "Postgrest couldn't retrieve response, please check traceback of the code. Please create an issue in `supabase-community/postgrest-py` if needed."}

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/parkerbeard/golfdaddy-brain/backend/app/services/daily_commit_analysis_service.py", line 47, in analyze
    existing = await self.repository.get_by_user_and_date(user_id, analysis_date)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/parkerbeard/golfdaddy-brain/backend/app/repositories/daily_commit_analysis_repository.py", line 105, in get_by_user_and_date
    raise DatabaseError(f"Error fetching daily analysis: {str(e)}")
app.core.exceptions.DatabaseError: Error fetching daily analysis: {'message': 'Missing response', 'code': '204', 'hint': 'Please check traceback of the code', 'details': "Postgrest couldn't retrieve response, please check traceback of the code. Please create an issue in `supabase-community/postgrest-py` if needed."}

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/parkerbeard/golfdaddy-brain/backend/app/services/unified_daily_analysis_service.py", line 51, in analyze_daily_work
    return await self._delegate.analyze(user_id=user_id, analysis_date=analysis_date, force_reanalysis=force_reanalysis)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/parkerbeard/golfdaddy-brain/backend/app/services/daily_commit_analysis_service.py", line 116, in analyze
    raise ExternalServiceError(
        service_name="Daily Work Analysis", original_message=f"Failed to analyze daily work: {str(e)}"
    )
app.core.exceptions.ExternalServiceError: An error occurred while communicating with Daily Work Analysis. Details: Failed to analyze daily work: Error fetching daily analysis: {'message': 'Missing response', 'code': '204', 'hint': 'Please check traceback of the code', 'details': "Postgrest couldn't retrieve response, please check traceback of the code. Please create an issue in `supabase-community/postgrest-py` if needed."}
------------------------------ Captured log call -------------------------------
INFO     app.services.unified_daily_analysis_service:unified_daily_analysis_service.py:48 Delegating unified daily analysis for user UUID_REDACTED on 2024-01-15 (force=False)
INFO     app.services.daily_commit_analysis_service:daily_commit_analysis_service.py:41 Starting unified daily analysis for user UUID_REDACTED on 2024-01-15 (force=False)
INFO     app.repositories.daily_commit_analysis_repository:daily_commit_analysis_repository.py:85 Fetching daily analysis for user UUID_REDACTED on 2024-01-15
INFO     httpx:_client.py:1025 HTTP Request: GET https://xfnxafbsmqowzvuwmhvi.supabase.co//rest/v1/daily_commit_analysis?select=%2A&user_id=eq.UUID_REDACTED&analysis_date=eq.2024-01-15 "HTTP/2 404 Not Found"
ERROR    app.repositories.daily_commit_analysis_repository:daily_commit_analysis_repository.py:104 Error fetching daily analysis: {'message': 'Missing response', 'code': '204', 'hint': 'Please check traceback of the code', 'details': "Postgrest couldn't retrieve response, please check traceback of the code. Please create an issue in `supabase-community/postgrest-py` if needed."}
Traceback (most recent call last):
  File "/Users/parkerbeard/golfdaddy-brain/backend/app/repositories/daily_commit_analysis_repository.py", line 93, in get_by_user_and_date
    .execute()
     ~~~~~~~^^
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/postgrest/_sync/request_builder.py", line 140, in execute
    raise APIError(
    ...<6 lines>...
    )
postgrest.exceptions.APIError: {'message': 'Missing response', 'code': '204', 'hint': 'Please check traceback of the code', 'details': "Postgrest couldn't retrieve response, please check traceback of the code. Please create an issue in `supabase-community/postgrest-py` if needed."}
ERROR    app.services.daily_commit_analysis_service:daily_commit_analysis_service.py:115 Error in unified daily analysis: Error fetching daily analysis: {'message': 'Missing response', 'code': '204', 'hint': 'Please check traceback of the code', 'details': "Postgrest couldn't retrieve response, please check traceback of the code. Please create an issue in `supabase-community/postgrest-py` if needed."}
Traceback (most recent call last):
  File "/Users/parkerbeard/golfdaddy-brain/backend/app/repositories/daily_commit_analysis_repository.py", line 93, in get_by_user_and_date
    .execute()
     ~~~~~~~^^
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/postgrest/_sync/request_builder.py", line 140, in execute
    raise APIError(
    ...<6 lines>...
    )
postgrest.exceptions.APIError: {'message': 'Missing response', 'code': '204', 'hint': 'Please check traceback of the code', 'details': "Postgrest couldn't retrieve response, please check traceback of the code. Please create an issue in `supabase-community/postgrest-py` if needed."}

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/parkerbeard/golfdaddy-brain/backend/app/services/daily_commit_analysis_service.py", line 47, in analyze
    existing = await self.repository.get_by_user_and_date(user_id, analysis_date)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/parkerbeard/golfdaddy-brain/backend/app/repositories/daily_commit_analysis_repository.py", line 105, in get_by_user_and_date
    raise DatabaseError(f"Error fetching daily analysis: {str(e)}")
app.core.exceptions.DatabaseError: Error fetching daily analysis: {'message': 'Missing response', 'code': '204', 'hint': 'Please check traceback of the code', 'details': "Postgrest couldn't retrieve response, please check traceback of the code. Please create an issue in `supabase-community/postgrest-py` if needed."}
ERROR    app.services.unified_daily_analysis_service:unified_daily_analysis_service.py:53 Error delegating unified daily analysis: An error occurred while communicating with Daily Work Analysis. Details: Failed to analyze daily work: Error fetching daily analysis: {'message': 'Missing response', 'code': '204', 'hint': 'Please check traceback of the code', 'details': "Postgrest couldn't retrieve response, please check traceback of the code. Please create an issue in `supabase-community/postgrest-py` if needed."}
Traceback (most recent call last):
  File "/Users/parkerbeard/golfdaddy-brain/backend/app/repositories/daily_commit_analysis_repository.py", line 93, in get_by_user_and_date
    .execute()
     ~~~~~~~^^
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/postgrest/_sync/request_builder.py", line 140, in execute
    raise APIError(
    ...<6 lines>...
    )
postgrest.exceptions.APIError: {'message': 'Missing response', 'code': '204', 'hint': 'Please check traceback of the code', 'details': "Postgrest couldn't retrieve response, please check traceback of the code. Please create an issue in `supabase-community/postgrest-py` if needed."}

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/parkerbeard/golfdaddy-brain/backend/app/services/daily_commit_analysis_service.py", line 47, in analyze
    existing = await self.repository.get_by_user_and_date(user_id, analysis_date)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/parkerbeard/golfdaddy-brain/backend/app/repositories/daily_commit_analysis_repository.py", line 105, in get_by_user_and_date
    raise DatabaseError(f"Error fetching daily analysis: {str(e)}")
app.core.exceptions.DatabaseError: Error fetching daily analysis: {'message': 'Missing response', 'code': '204', 'hint': 'Please check traceback of the code', 'details': "Postgrest couldn't retrieve response, please check traceback of the code. Please create an issue in `supabase-community/postgrest-py` if needed."}

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/parkerbeard/golfdaddy-brain/backend/app/services/unified_daily_analysis_service.py", line 51, in analyze_daily_work
    return await self._delegate.analyze(user_id=user_id, analysis_date=analysis_date, force_reanalysis=force_reanalysis)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/parkerbeard/golfdaddy-brain/backend/app/services/daily_commit_analysis_service.py", line 116, in analyze
    raise ExternalServiceError(
        service_name="Daily Work Analysis", original_message=f"Failed to analyze daily work: {str(e)}"
    )
app.core.exceptions.ExternalServiceError: An error occurred while communicating with Daily Work Analysis. Details: Failed to analyze daily work: Error fetching daily analysis: {'message': 'Missing response', 'code': '204', 'hint': 'Please check traceback of the code', 'details': "Postgrest couldn't retrieve response, please check traceback of the code. Please create an issue in `supabase-community/postgrest-py` if needed."}
__ TestUnifiedDailyAnalysisService.test_analyze_daily_work_existing_analysis ___
tests/unit/services/test_unified_daily_analysis_service.py:438: in test_analyze_daily_work_existing_analysis
    existing_analysis = DailyWorkAnalysis(
                        ^^^^^^^^^^^^^^^^^
E   NameError: name 'DailyWorkAnalysis' is not defined
---------------------------- Captured stderr setup -----------------------------
2025-09-05 12:00:33,837 - app.integrations.ai_integration_v2 - INFO - AIIntegrationV2 initialized. Model: gpt-5-2025-08-07
------------------------------ Captured log setup ------------------------------
INFO     app.integrations.ai_integration_v2:ai_integration_v2.py:36 AIIntegrationV2 initialized. Model: gpt-5-2025-08-07
___ TestUnifiedDailyAnalysisService.test_analyze_daily_work_force_reanalysis ___
tests/unit/services/test_unified_daily_analysis_service.py:466: in test_analyze_daily_work_force_reanalysis
    existing_analysis = DailyWorkAnalysis(
                        ^^^^^^^^^^^^^^^^^
E   NameError: name 'DailyWorkAnalysis' is not defined
---------------------------- Captured stderr setup -----------------------------
2025-09-05 12:00:33,844 - app.integrations.ai_integration_v2 - INFO - AIIntegrationV2 initialized. Model: gpt-5-2025-08-07
------------------------------ Captured log setup ------------------------------
INFO     app.integrations.ai_integration_v2:ai_integration_v2.py:36 AIIntegrationV2 initialized. Model: gpt-5-2025-08-07
______ TestUnifiedDailyAnalysisService.test_parse_ai_response_validation _______
tests/unit/services/test_unified_daily_analysis_service.py:518: in test_parse_ai_response_validation
    assert parsed["total_productive_hours"] == 24.0  # Capped at 24
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   KeyError: 'total_productive_hours'
---------------------------- Captured stderr setup -----------------------------
2025-09-05 12:00:33,851 - app.integrations.ai_integration_v2 - INFO - AIIntegrationV2 initialized. Model: gpt-5-2025-08-07
------------------------------ Captured log setup ------------------------------
INFO     app.integrations.ai_integration_v2:ai_integration_v2.py:36 AIIntegrationV2 initialized. Model: gpt-5-2025-08-07
____________ TestUnifiedDailyAnalysisService.test_ai_error_handling ____________
app/repositories/daily_commit_analysis_repository.py:93: in get_by_user_and_date
    .execute()
     ^^^^^^^^^
venv/lib/python3.13/site-packages/postgrest/_sync/request_builder.py:140: in execute
    raise APIError(
E   postgrest.exceptions.APIError: {'message': 'Missing response', 'code': '204', 'hint': 'Please check traceback of the code', 'details': "Postgrest couldn't retrieve response, please check traceback of the code. Please create an issue in `supabase-community/postgrest-py` if needed."}

During handling of the above exception, another exception occurred:
app/services/daily_commit_analysis_service.py:47: in analyze
    existing = await self.repository.get_by_user_and_date(user_id, analysis_date)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
app/repositories/daily_commit_analysis_repository.py:105: in get_by_user_and_date
    raise DatabaseError(f"Error fetching daily analysis: {str(e)}")
E   app.core.exceptions.DatabaseError: Error fetching daily analysis: {'message': 'Missing response', 'code': '204', 'hint': 'Please check traceback of the code', 'details': "Postgrest couldn't retrieve response, please check traceback of the code. Please create an issue in `supabase-community/postgrest-py` if needed."}

During handling of the above exception, another exception occurred:
app/services/unified_daily_analysis_service.py:51: in analyze_daily_work
    return await self._delegate.analyze(user_id=user_id, analysis_date=analysis_date, force_reanalysis=force_reanalysis)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
app/services/daily_commit_analysis_service.py:116: in analyze
    raise ExternalServiceError(
E   app.core.exceptions.ExternalServiceError: An error occurred while communicating with Daily Work Analysis. Details: Failed to analyze daily work: Error fetching daily analysis: {'message': 'Missing response', 'code': '204', 'hint': 'Please check traceback of the code', 'details': "Postgrest couldn't retrieve response, please check traceback of the code. Please create an issue in `supabase-community/postgrest-py` if needed."}

During handling of the above exception, another exception occurred:
tests/unit/services/test_unified_daily_analysis_service.py:535: in test_ai_error_handling
    await service.analyze_daily_work(sample_user_id, sample_date)
app/services/unified_daily_analysis_service.py:54: in analyze_daily_work
    raise ExternalServiceError(
E   app.core.exceptions.ExternalServiceError: An error occurred while communicating with Unified Daily Analysis. Details: Failed to analyze daily work: An error occurred while communicating with Daily Work Analysis. Details: Failed to analyze daily work: Error fetching daily analysis: {'message': 'Missing response', 'code': '204', 'hint': 'Please check traceback of the code', 'details': "Postgrest couldn't retrieve response, please check traceback of the code. Please create an issue in `supabase-community/postgrest-py` if needed."}
---------------------------- Captured stderr setup -----------------------------
2025-09-05 12:00:33,857 - app.integrations.ai_integration_v2 - INFO - AIIntegrationV2 initialized. Model: gpt-5-2025-08-07
------------------------------ Captured log setup ------------------------------
INFO     app.integrations.ai_integration_v2:ai_integration_v2.py:36 AIIntegrationV2 initialized. Model: gpt-5-2025-08-07
----------------------------- Captured stderr call -----------------------------
2025-09-05 12:00:33,858 - app.services.unified_daily_analysis_service - INFO - Delegating unified daily analysis for user UUID_REDACTED on 2024-01-15 (force=False)
2025-09-05 12:00:33,858 - app.services.daily_commit_analysis_service - INFO - Starting unified daily analysis for user UUID_REDACTED on 2024-01-15 (force=False)
2025-09-05 12:00:33,858 - app.repositories.daily_commit_analysis_repository - INFO - Fetching daily analysis for user UUID_REDACTED on 2024-01-15
2025-09-05 12:00:34,012 - httpx - INFO - HTTP Request: GET https://xfnxafbsmqowzvuwmhvi.supabase.co//rest/v1/daily_commit_analysis?select=%2A&user_id=eq.UUID_REDACTED&analysis_date=eq.2024-01-15 "HTTP/2 404 Not Found"
2025-09-05 12:00:34,013 - app.repositories.daily_commit_analysis_repository - ERROR - Error fetching daily analysis: {'message': 'Missing response', 'code': '204', 'hint': 'Please check traceback of the code', 'details': "Postgrest couldn't retrieve response, please check traceback of the code. Please create an issue in `supabase-community/postgrest-py` if needed."}
Traceback (most recent call last):
  File "/Users/parkerbeard/golfdaddy-brain/backend/app/repositories/daily_commit_analysis_repository.py", line 93, in get_by_user_and_date
    .execute()
     ~~~~~~~^^
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/postgrest/_sync/request_builder.py", line 140, in execute
    raise APIError(
    ...<6 lines>...
    )
postgrest.exceptions.APIError: {'message': 'Missing response', 'code': '204', 'hint': 'Please check traceback of the code', 'details': "Postgrest couldn't retrieve response, please check traceback of the code. Please create an issue in `supabase-community/postgrest-py` if needed."}
2025-09-05 12:00:34,020 - app.services.daily_commit_analysis_service - ERROR - Error in unified daily analysis: Error fetching daily analysis: {'message': 'Missing response', 'code': '204', 'hint': 'Please check traceback of the code', 'details': "Postgrest couldn't retrieve response, please check traceback of the code. Please create an issue in `supabase-community/postgrest-py` if needed."}
Traceback (most recent call last):
  File "/Users/parkerbeard/golfdaddy-brain/backend/app/repositories/daily_commit_analysis_repository.py", line 93, in get_by_user_and_date
    .execute()
     ~~~~~~~^^
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/postgrest/_sync/request_builder.py", line 140, in execute
    raise APIError(
    ...<6 lines>...
    )
postgrest.exceptions.APIError: {'message': 'Missing response', 'code': '204', 'hint': 'Please check traceback of the code', 'details': "Postgrest couldn't retrieve response, please check traceback of the code. Please create an issue in `supabase-community/postgrest-py` if needed."}

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/parkerbeard/golfdaddy-brain/backend/app/services/daily_commit_analysis_service.py", line 47, in analyze
    existing = await self.repository.get_by_user_and_date(user_id, analysis_date)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/parkerbeard/golfdaddy-brain/backend/app/repositories/daily_commit_analysis_repository.py", line 105, in get_by_user_and_date
    raise DatabaseError(f"Error fetching daily analysis: {str(e)}")
app.core.exceptions.DatabaseError: Error fetching daily analysis: {'message': 'Missing response', 'code': '204', 'hint': 'Please check traceback of the code', 'details': "Postgrest couldn't retrieve response, please check traceback of the code. Please create an issue in `supabase-community/postgrest-py` if needed."}
2025-09-05 12:00:34,033 - app.services.unified_daily_analysis_service - ERROR - Error delegating unified daily analysis: An error occurred while communicating with Daily Work Analysis. Details: Failed to analyze daily work: Error fetching daily analysis: {'message': 'Missing response', 'code': '204', 'hint': 'Please check traceback of the code', 'details': "Postgrest couldn't retrieve response, please check traceback of the code. Please create an issue in `supabase-community/postgrest-py` if needed."}
Traceback (most recent call last):
  File "/Users/parkerbeard/golfdaddy-brain/backend/app/repositories/daily_commit_analysis_repository.py", line 93, in get_by_user_and_date
    .execute()
     ~~~~~~~^^
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/postgrest/_sync/request_builder.py", line 140, in execute
    raise APIError(
    ...<6 lines>...
    )
postgrest.exceptions.APIError: {'message': 'Missing response', 'code': '204', 'hint': 'Please check traceback of the code', 'details': "Postgrest couldn't retrieve response, please check traceback of the code. Please create an issue in `supabase-community/postgrest-py` if needed."}

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/parkerbeard/golfdaddy-brain/backend/app/services/daily_commit_analysis_service.py", line 47, in analyze
    existing = await self.repository.get_by_user_and_date(user_id, analysis_date)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/parkerbeard/golfdaddy-brain/backend/app/repositories/daily_commit_analysis_repository.py", line 105, in get_by_user_and_date
    raise DatabaseError(f"Error fetching daily analysis: {str(e)}")
app.core.exceptions.DatabaseError: Error fetching daily analysis: {'message': 'Missing response', 'code': '204', 'hint': 'Please check traceback of the code', 'details': "Postgrest couldn't retrieve response, please check traceback of the code. Please create an issue in `supabase-community/postgrest-py` if needed."}

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/parkerbeard/golfdaddy-brain/backend/app/services/unified_daily_analysis_service.py", line 51, in analyze_daily_work
    return await self._delegate.analyze(user_id=user_id, analysis_date=analysis_date, force_reanalysis=force_reanalysis)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/parkerbeard/golfdaddy-brain/backend/app/services/daily_commit_analysis_service.py", line 116, in analyze
    raise ExternalServiceError(
        service_name="Daily Work Analysis", original_message=f"Failed to analyze daily work: {str(e)}"
    )
app.core.exceptions.ExternalServiceError: An error occurred while communicating with Daily Work Analysis. Details: Failed to analyze daily work: Error fetching daily analysis: {'message': 'Missing response', 'code': '204', 'hint': 'Please check traceback of the code', 'details': "Postgrest couldn't retrieve response, please check traceback of the code. Please create an issue in `supabase-community/postgrest-py` if needed."}
------------------------------ Captured log call -------------------------------
INFO     app.services.unified_daily_analysis_service:unified_daily_analysis_service.py:48 Delegating unified daily analysis for user UUID_REDACTED on 2024-01-15 (force=False)
INFO     app.services.daily_commit_analysis_service:daily_commit_analysis_service.py:41 Starting unified daily analysis for user UUID_REDACTED on 2024-01-15 (force=False)
INFO     app.repositories.daily_commit_analysis_repository:daily_commit_analysis_repository.py:85 Fetching daily analysis for user UUID_REDACTED on 2024-01-15
INFO     httpx:_client.py:1025 HTTP Request: GET https://xfnxafbsmqowzvuwmhvi.supabase.co//rest/v1/daily_commit_analysis?select=%2A&user_id=eq.UUID_REDACTED&analysis_date=eq.2024-01-15 "HTTP/2 404 Not Found"
ERROR    app.repositories.daily_commit_analysis_repository:daily_commit_analysis_repository.py:104 Error fetching daily analysis: {'message': 'Missing response', 'code': '204', 'hint': 'Please check traceback of the code', 'details': "Postgrest couldn't retrieve response, please check traceback of the code. Please create an issue in `supabase-community/postgrest-py` if needed."}
Traceback (most recent call last):
  File "/Users/parkerbeard/golfdaddy-brain/backend/app/repositories/daily_commit_analysis_repository.py", line 93, in get_by_user_and_date
    .execute()
     ~~~~~~~^^
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/postgrest/_sync/request_builder.py", line 140, in execute
    raise APIError(
    ...<6 lines>...
    )
postgrest.exceptions.APIError: {'message': 'Missing response', 'code': '204', 'hint': 'Please check traceback of the code', 'details': "Postgrest couldn't retrieve response, please check traceback of the code. Please create an issue in `supabase-community/postgrest-py` if needed."}
ERROR    app.services.daily_commit_analysis_service:daily_commit_analysis_service.py:115 Error in unified daily analysis: Error fetching daily analysis: {'message': 'Missing response', 'code': '204', 'hint': 'Please check traceback of the code', 'details': "Postgrest couldn't retrieve response, please check traceback of the code. Please create an issue in `supabase-community/postgrest-py` if needed."}
Traceback (most recent call last):
  File "/Users/parkerbeard/golfdaddy-brain/backend/app/repositories/daily_commit_analysis_repository.py", line 93, in get_by_user_and_date
    .execute()
     ~~~~~~~^^
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/postgrest/_sync/request_builder.py", line 140, in execute
    raise APIError(
    ...<6 lines>...
    )
postgrest.exceptions.APIError: {'message': 'Missing response', 'code': '204', 'hint': 'Please check traceback of the code', 'details': "Postgrest couldn't retrieve response, please check traceback of the code. Please create an issue in `supabase-community/postgrest-py` if needed."}

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/parkerbeard/golfdaddy-brain/backend/app/services/daily_commit_analysis_service.py", line 47, in analyze
    existing = await self.repository.get_by_user_and_date(user_id, analysis_date)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/parkerbeard/golfdaddy-brain/backend/app/repositories/daily_commit_analysis_repository.py", line 105, in get_by_user_and_date
    raise DatabaseError(f"Error fetching daily analysis: {str(e)}")
app.core.exceptions.DatabaseError: Error fetching daily analysis: {'message': 'Missing response', 'code': '204', 'hint': 'Please check traceback of the code', 'details': "Postgrest couldn't retrieve response, please check traceback of the code. Please create an issue in `supabase-community/postgrest-py` if needed."}
ERROR    app.services.unified_daily_analysis_service:unified_daily_analysis_service.py:53 Error delegating unified daily analysis: An error occurred while communicating with Daily Work Analysis. Details: Failed to analyze daily work: Error fetching daily analysis: {'message': 'Missing response', 'code': '204', 'hint': 'Please check traceback of the code', 'details': "Postgrest couldn't retrieve response, please check traceback of the code. Please create an issue in `supabase-community/postgrest-py` if needed."}
Traceback (most recent call last):
  File "/Users/parkerbeard/golfdaddy-brain/backend/app/repositories/daily_commit_analysis_repository.py", line 93, in get_by_user_and_date
    .execute()
     ~~~~~~~^^
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/postgrest/_sync/request_builder.py", line 140, in execute
    raise APIError(
    ...<6 lines>...
    )
postgrest.exceptions.APIError: {'message': 'Missing response', 'code': '204', 'hint': 'Please check traceback of the code', 'details': "Postgrest couldn't retrieve response, please check traceback of the code. Please create an issue in `supabase-community/postgrest-py` if needed."}

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/parkerbeard/golfdaddy-brain/backend/app/services/daily_commit_analysis_service.py", line 47, in analyze
    existing = await self.repository.get_by_user_and_date(user_id, analysis_date)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/parkerbeard/golfdaddy-brain/backend/app/repositories/daily_commit_analysis_repository.py", line 105, in get_by_user_and_date
    raise DatabaseError(f"Error fetching daily analysis: {str(e)}")
app.core.exceptions.DatabaseError: Error fetching daily analysis: {'message': 'Missing response', 'code': '204', 'hint': 'Please check traceback of the code', 'details': "Postgrest couldn't retrieve response, please check traceback of the code. Please create an issue in `supabase-community/postgrest-py` if needed."}

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/parkerbeard/golfdaddy-brain/backend/app/services/unified_daily_analysis_service.py", line 51, in analyze_daily_work
    return await self._delegate.analyze(user_id=user_id, analysis_date=analysis_date, force_reanalysis=force_reanalysis)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/parkerbeard/golfdaddy-brain/backend/app/services/daily_commit_analysis_service.py", line 116, in analyze
    raise ExternalServiceError(
        service_name="Daily Work Analysis", original_message=f"Failed to analyze daily work: {str(e)}"
    )
app.core.exceptions.ExternalServiceError: An error occurred while communicating with Daily Work Analysis. Details: Failed to analyze daily work: Error fetching daily analysis: {'message': 'Missing response', 'code': '204', 'hint': 'Please check traceback of the code', 'details': "Postgrest couldn't retrieve response, please check traceback of the code. Please create an issue in `supabase-community/postgrest-py` if needed."}
__________ TestUnifiedDailyAnalysisService.test_get_weekly_aggregate ___________
tests/unit/services/test_unified_daily_analysis_service.py:548: in test_get_weekly_aggregate
    analysis = DailyWorkAnalysis(
               ^^^^^^^^^^^^^^^^^
E   NameError: name 'DailyWorkAnalysis' is not defined
---------------------------- Captured stderr setup -----------------------------
2025-09-05 12:00:34,069 - app.integrations.ai_integration_v2 - INFO - AIIntegrationV2 initialized. Model: gpt-5-2025-08-07
------------------------------ Captured log setup ------------------------------
INFO     app.integrations.ai_integration_v2:ai_integration_v2.py:36 AIIntegrationV2 initialized. Model: gpt-5-2025-08-07
_______ TestUnifiedDailyAnalysisService.test_handle_clarification_needed _______
tests/unit/services/test_unified_daily_analysis_service.py:595: in test_handle_clarification_needed
    existing_analysis = DailyWorkAnalysis(
                        ^^^^^^^^^^^^^^^^^
E   NameError: name 'DailyWorkAnalysis' is not defined
---------------------------- Captured stderr setup -----------------------------
2025-09-05 12:00:34,076 - app.integrations.ai_integration_v2 - INFO - AIIntegrationV2 initialized. Model: gpt-5-2025-08-07
------------------------------ Captured log setup ------------------------------
INFO     app.integrations.ai_integration_v2:ai_integration_v2.py:36 AIIntegrationV2 initialized. Model: gpt-5-2025-08-07
__________ TestUnifiedDailyAnalysisService.test_provide_clarification __________
tests/unit/services/test_unified_daily_analysis_service.py:631: in test_provide_clarification
    pending_analysis = DailyWorkAnalysis(
                       ^^^^^^^^^^^^^^^^^
E   NameError: name 'DailyWorkAnalysis' is not defined
---------------------------- Captured stderr setup -----------------------------
2025-09-05 12:00:34,084 - app.integrations.ai_integration_v2 - INFO - AIIntegrationV2 initialized. Model: gpt-5-2025-08-07
------------------------------ Captured log setup ------------------------------
INFO     app.integrations.ai_integration_v2:ai_integration_v2.py:36 AIIntegrationV2 initialized. Model: gpt-5-2025-08-07
_________ TestUnifiedDailyAnalysisService.test_deduplication_in_prompt _________
app/repositories/daily_commit_analysis_repository.py:93: in get_by_user_and_date
    .execute()
     ^^^^^^^^^
venv/lib/python3.13/site-packages/postgrest/_sync/request_builder.py:140: in execute
    raise APIError(
E   postgrest.exceptions.APIError: {'message': 'Missing response', 'code': '204', 'hint': 'Please check traceback of the code', 'details': "Postgrest couldn't retrieve response, please check traceback of the code. Please create an issue in `supabase-community/postgrest-py` if needed."}

During handling of the above exception, another exception occurred:
app/services/daily_commit_analysis_service.py:47: in analyze
    existing = await self.repository.get_by_user_and_date(user_id, analysis_date)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
app/repositories/daily_commit_analysis_repository.py:105: in get_by_user_and_date
    raise DatabaseError(f"Error fetching daily analysis: {str(e)}")
E   app.core.exceptions.DatabaseError: Error fetching daily analysis: {'message': 'Missing response', 'code': '204', 'hint': 'Please check traceback of the code', 'details': "Postgrest couldn't retrieve response, please check traceback of the code. Please create an issue in `supabase-community/postgrest-py` if needed."}

During handling of the above exception, another exception occurred:
app/services/unified_daily_analysis_service.py:51: in analyze_daily_work
    return await self._delegate.analyze(user_id=user_id, analysis_date=analysis_date, force_reanalysis=force_reanalysis)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
app/services/daily_commit_analysis_service.py:116: in analyze
    raise ExternalServiceError(
E   app.core.exceptions.ExternalServiceError: An error occurred while communicating with Daily Work Analysis. Details: Failed to analyze daily work: Error fetching daily analysis: {'message': 'Missing response', 'code': '204', 'hint': 'Please check traceback of the code', 'details': "Postgrest couldn't retrieve response, please check traceback of the code. Please create an issue in `supabase-community/postgrest-py` if needed."}

During handling of the above exception, another exception occurred:
tests/unit/services/test_unified_daily_analysis_service.py:695: in test_deduplication_in_prompt
    await service.analyze_daily_work(sample_user_id, sample_date)
app/services/unified_daily_analysis_service.py:54: in analyze_daily_work
    raise ExternalServiceError(
E   app.core.exceptions.ExternalServiceError: An error occurred while communicating with Unified Daily Analysis. Details: Failed to analyze daily work: An error occurred while communicating with Daily Work Analysis. Details: Failed to analyze daily work: Error fetching daily analysis: {'message': 'Missing response', 'code': '204', 'hint': 'Please check traceback of the code', 'details': "Postgrest couldn't retrieve response, please check traceback of the code. Please create an issue in `supabase-community/postgrest-py` if needed."}
---------------------------- Captured stderr setup -----------------------------
2025-09-05 12:00:34,093 - app.integrations.ai_integration_v2 - INFO - AIIntegrationV2 initialized. Model: gpt-5-2025-08-07
------------------------------ Captured log setup ------------------------------
INFO     app.integrations.ai_integration_v2:ai_integration_v2.py:36 AIIntegrationV2 initialized. Model: gpt-5-2025-08-07
----------------------------- Captured stderr call -----------------------------
2025-09-05 12:00:34,094 - app.services.unified_daily_analysis_service - INFO - Delegating unified daily analysis for user UUID_REDACTED on 2024-01-15 (force=False)
2025-09-05 12:00:34,094 - app.services.daily_commit_analysis_service - INFO - Starting unified daily analysis for user UUID_REDACTED on 2024-01-15 (force=False)
2025-09-05 12:00:34,095 - app.repositories.daily_commit_analysis_repository - INFO - Fetching daily analysis for user UUID_REDACTED on 2024-01-15
2025-09-05 12:00:34,236 - httpx - INFO - HTTP Request: GET https://xfnxafbsmqowzvuwmhvi.supabase.co//rest/v1/daily_commit_analysis?select=%2A&user_id=eq.UUID_REDACTED&analysis_date=eq.2024-01-15 "HTTP/2 404 Not Found"
2025-09-05 12:00:34,238 - app.repositories.daily_commit_analysis_repository - ERROR - Error fetching daily analysis: {'message': 'Missing response', 'code': '204', 'hint': 'Please check traceback of the code', 'details': "Postgrest couldn't retrieve response, please check traceback of the code. Please create an issue in `supabase-community/postgrest-py` if needed."}
Traceback (most recent call last):
  File "/Users/parkerbeard/golfdaddy-brain/backend/app/repositories/daily_commit_analysis_repository.py", line 93, in get_by_user_and_date
    .execute()
     ~~~~~~~^^
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/postgrest/_sync/request_builder.py", line 140, in execute
    raise APIError(
    ...<6 lines>...
    )
postgrest.exceptions.APIError: {'message': 'Missing response', 'code': '204', 'hint': 'Please check traceback of the code', 'details': "Postgrest couldn't retrieve response, please check traceback of the code. Please create an issue in `supabase-community/postgrest-py` if needed."}
2025-09-05 12:00:34,245 - app.services.daily_commit_analysis_service - ERROR - Error in unified daily analysis: Error fetching daily analysis: {'message': 'Missing response', 'code': '204', 'hint': 'Please check traceback of the code', 'details': "Postgrest couldn't retrieve response, please check traceback of the code. Please create an issue in `supabase-community/postgrest-py` if needed."}
Traceback (most recent call last):
  File "/Users/parkerbeard/golfdaddy-brain/backend/app/repositories/daily_commit_analysis_repository.py", line 93, in get_by_user_and_date
    .execute()
     ~~~~~~~^^
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/postgrest/_sync/request_builder.py", line 140, in execute
    raise APIError(
    ...<6 lines>...
    )
postgrest.exceptions.APIError: {'message': 'Missing response', 'code': '204', 'hint': 'Please check traceback of the code', 'details': "Postgrest couldn't retrieve response, please check traceback of the code. Please create an issue in `supabase-community/postgrest-py` if needed."}

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/parkerbeard/golfdaddy-brain/backend/app/services/daily_commit_analysis_service.py", line 47, in analyze
    existing = await self.repository.get_by_user_and_date(user_id, analysis_date)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/parkerbeard/golfdaddy-brain/backend/app/repositories/daily_commit_analysis_repository.py", line 105, in get_by_user_and_date
    raise DatabaseError(f"Error fetching daily analysis: {str(e)}")
app.core.exceptions.DatabaseError: Error fetching daily analysis: {'message': 'Missing response', 'code': '204', 'hint': 'Please check traceback of the code', 'details': "Postgrest couldn't retrieve response, please check traceback of the code. Please create an issue in `supabase-community/postgrest-py` if needed."}
2025-09-05 12:00:34,257 - app.services.unified_daily_analysis_service - ERROR - Error delegating unified daily analysis: An error occurred while communicating with Daily Work Analysis. Details: Failed to analyze daily work: Error fetching daily analysis: {'message': 'Missing response', 'code': '204', 'hint': 'Please check traceback of the code', 'details': "Postgrest couldn't retrieve response, please check traceback of the code. Please create an issue in `supabase-community/postgrest-py` if needed."}
Traceback (most recent call last):
  File "/Users/parkerbeard/golfdaddy-brain/backend/app/repositories/daily_commit_analysis_repository.py", line 93, in get_by_user_and_date
    .execute()
     ~~~~~~~^^
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/postgrest/_sync/request_builder.py", line 140, in execute
    raise APIError(
    ...<6 lines>...
    )
postgrest.exceptions.APIError: {'message': 'Missing response', 'code': '204', 'hint': 'Please check traceback of the code', 'details': "Postgrest couldn't retrieve response, please check traceback of the code. Please create an issue in `supabase-community/postgrest-py` if needed."}

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/parkerbeard/golfdaddy-brain/backend/app/services/daily_commit_analysis_service.py", line 47, in analyze
    existing = await self.repository.get_by_user_and_date(user_id, analysis_date)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/parkerbeard/golfdaddy-brain/backend/app/repositories/daily_commit_analysis_repository.py", line 105, in get_by_user_and_date
    raise DatabaseError(f"Error fetching daily analysis: {str(e)}")
app.core.exceptions.DatabaseError: Error fetching daily analysis: {'message': 'Missing response', 'code': '204', 'hint': 'Please check traceback of the code', 'details': "Postgrest couldn't retrieve response, please check traceback of the code. Please create an issue in `supabase-community/postgrest-py` if needed."}

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/parkerbeard/golfdaddy-brain/backend/app/services/unified_daily_analysis_service.py", line 51, in analyze_daily_work
    return await self._delegate.analyze(user_id=user_id, analysis_date=analysis_date, force_reanalysis=force_reanalysis)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/parkerbeard/golfdaddy-brain/backend/app/services/daily_commit_analysis_service.py", line 116, in analyze
    raise ExternalServiceError(
        service_name="Daily Work Analysis", original_message=f"Failed to analyze daily work: {str(e)}"
    )
app.core.exceptions.ExternalServiceError: An error occurred while communicating with Daily Work Analysis. Details: Failed to analyze daily work: Error fetching daily analysis: {'message': 'Missing response', 'code': '204', 'hint': 'Please check traceback of the code', 'details': "Postgrest couldn't retrieve response, please check traceback of the code. Please create an issue in `supabase-community/postgrest-py` if needed."}
------------------------------ Captured log call -------------------------------
INFO     app.services.unified_daily_analysis_service:unified_daily_analysis_service.py:48 Delegating unified daily analysis for user UUID_REDACTED on 2024-01-15 (force=False)
INFO     app.services.daily_commit_analysis_service:daily_commit_analysis_service.py:41 Starting unified daily analysis for user UUID_REDACTED on 2024-01-15 (force=False)
INFO     app.repositories.daily_commit_analysis_repository:daily_commit_analysis_repository.py:85 Fetching daily analysis for user UUID_REDACTED on 2024-01-15
INFO     httpx:_client.py:1025 HTTP Request: GET https://xfnxafbsmqowzvuwmhvi.supabase.co//rest/v1/daily_commit_analysis?select=%2A&user_id=eq.UUID_REDACTED&analysis_date=eq.2024-01-15 "HTTP/2 404 Not Found"
ERROR    app.repositories.daily_commit_analysis_repository:daily_commit_analysis_repository.py:104 Error fetching daily analysis: {'message': 'Missing response', 'code': '204', 'hint': 'Please check traceback of the code', 'details': "Postgrest couldn't retrieve response, please check traceback of the code. Please create an issue in `supabase-community/postgrest-py` if needed."}
Traceback (most recent call last):
  File "/Users/parkerbeard/golfdaddy-brain/backend/app/repositories/daily_commit_analysis_repository.py", line 93, in get_by_user_and_date
    .execute()
     ~~~~~~~^^
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/postgrest/_sync/request_builder.py", line 140, in execute
    raise APIError(
    ...<6 lines>...
    )
postgrest.exceptions.APIError: {'message': 'Missing response', 'code': '204', 'hint': 'Please check traceback of the code', 'details': "Postgrest couldn't retrieve response, please check traceback of the code. Please create an issue in `supabase-community/postgrest-py` if needed."}
ERROR    app.services.daily_commit_analysis_service:daily_commit_analysis_service.py:115 Error in unified daily analysis: Error fetching daily analysis: {'message': 'Missing response', 'code': '204', 'hint': 'Please check traceback of the code', 'details': "Postgrest couldn't retrieve response, please check traceback of the code. Please create an issue in `supabase-community/postgrest-py` if needed."}
Traceback (most recent call last):
  File "/Users/parkerbeard/golfdaddy-brain/backend/app/repositories/daily_commit_analysis_repository.py", line 93, in get_by_user_and_date
    .execute()
     ~~~~~~~^^
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/postgrest/_sync/request_builder.py", line 140, in execute
    raise APIError(
    ...<6 lines>...
    )
postgrest.exceptions.APIError: {'message': 'Missing response', 'code': '204', 'hint': 'Please check traceback of the code', 'details': "Postgrest couldn't retrieve response, please check traceback of the code. Please create an issue in `supabase-community/postgrest-py` if needed."}

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/parkerbeard/golfdaddy-brain/backend/app/services/daily_commit_analysis_service.py", line 47, in analyze
    existing = await self.repository.get_by_user_and_date(user_id, analysis_date)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/parkerbeard/golfdaddy-brain/backend/app/repositories/daily_commit_analysis_repository.py", line 105, in get_by_user_and_date
    raise DatabaseError(f"Error fetching daily analysis: {str(e)}")
app.core.exceptions.DatabaseError: Error fetching daily analysis: {'message': 'Missing response', 'code': '204', 'hint': 'Please check traceback of the code', 'details': "Postgrest couldn't retrieve response, please check traceback of the code. Please create an issue in `supabase-community/postgrest-py` if needed."}
ERROR    app.services.unified_daily_analysis_service:unified_daily_analysis_service.py:53 Error delegating unified daily analysis: An error occurred while communicating with Daily Work Analysis. Details: Failed to analyze daily work: Error fetching daily analysis: {'message': 'Missing response', 'code': '204', 'hint': 'Please check traceback of the code', 'details': "Postgrest couldn't retrieve response, please check traceback of the code. Please create an issue in `supabase-community/postgrest-py` if needed."}
Traceback (most recent call last):
  File "/Users/parkerbeard/golfdaddy-brain/backend/app/repositories/daily_commit_analysis_repository.py", line 93, in get_by_user_and_date
    .execute()
     ~~~~~~~^^
  File "/Users/parkerbeard/golfdaddy-brain/backend/venv/lib/python3.13/site-packages/postgrest/_sync/request_builder.py", line 140, in execute
    raise APIError(
    ...<6 lines>...
    )
postgrest.exceptions.APIError: {'message': 'Missing response', 'code': '204', 'hint': 'Please check traceback of the code', 'details': "Postgrest couldn't retrieve response, please check traceback of the code. Please create an issue in `supabase-community/postgrest-py` if needed."}

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/parkerbeard/golfdaddy-brain/backend/app/services/daily_commit_analysis_service.py", line 47, in analyze
    existing = await self.repository.get_by_user_and_date(user_id, analysis_date)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/parkerbeard/golfdaddy-brain/backend/app/repositories/daily_commit_analysis_repository.py", line 105, in get_by_user_and_date
    raise DatabaseError(f"Error fetching daily analysis: {str(e)}")
app.core.exceptions.DatabaseError: Error fetching daily analysis: {'message': 'Missing response', 'code': '204', 'hint': 'Please check traceback of the code', 'details': "Postgrest couldn't retrieve response, please check traceback of the code. Please create an issue in `supabase-community/postgrest-py` if needed."}

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/parkerbeard/golfdaddy-brain/backend/app/services/unified_daily_analysis_service.py", line 51, in analyze_daily_work
    return await self._delegate.analyze(user_id=user_id, analysis_date=analysis_date, force_reanalysis=force_reanalysis)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/parkerbeard/golfdaddy-brain/backend/app/services/daily_commit_analysis_service.py", line 116, in analyze
    raise ExternalServiceError(
        service_name="Daily Work Analysis", original_message=f"Failed to analyze daily work: {str(e)}"
    )
app.core.exceptions.ExternalServiceError: An error occurred while communicating with Daily Work Analysis. Details: Failed to analyze daily work: Error fetching daily analysis: {'message': 'Missing response', 'code': '204', 'hint': 'Please check traceback of the code', 'details': "Postgrest couldn't retrieve response, please check traceback of the code. Please create an issue in `supabase-community/postgrest-py` if needed."}
=========================== short test summary info ============================
FAILED tests/unit/api/test_api_gateway.py::TestRequestMetrics::test_metrics_collection - assert 0 > 0
 +  where 0 = len([])
FAILED tests/unit/api/test_auth_endpoints.py::test_login_returns_token_with_mocked_supabase - assert 401 == 200
 +  where 401 = <Response [401 Unauthorized]>.status_code
FAILED tests/unit/api/test_basic_auth.py::TestBasicAuth::test_api_endpoint_requires_api_key_when_enabled - assert 422 == 401
 +  where 422 = <Response [422 Unprocessable Entity]>.status_code
FAILED tests/unit/api/test_daily_report_endpoints.py::test_submit_eod_report_success - TypeError: object Response can't be used in 'await' expression
FAILED tests/unit/api/test_daily_report_endpoints.py::test_submit_eod_report_service_exception - TypeError: object Response can't be used in 'await' expression
FAILED tests/unit/api/test_daily_report_endpoints.py::test_submit_eod_report_validation_error - TypeError: object Response can't be used in 'await' expression
FAILED tests/unit/api/test_daily_report_endpoints.py::test_get_my_daily_reports_success - TypeError: object Response can't be used in 'await' expression
FAILED tests/unit/api/test_daily_report_endpoints.py::test_get_my_daily_report_for_date_success - TypeError: object Response can't be used in 'await' expression
FAILED tests/unit/api/test_daily_report_endpoints.py::test_get_my_daily_report_for_date_not_found - TypeError: object Response can't be used in 'await' expression
FAILED tests/unit/api/test_daily_report_endpoints.py::test_get_my_daily_report_for_date_invalid_format - TypeError: object Response can't be used in 'await' expression
FAILED tests/unit/api/test_daily_report_endpoints.py::test_get_daily_report_by_id_success - TypeError: object Response can't be used in 'await' expression
FAILED tests/unit/api/test_daily_report_endpoints.py::test_get_daily_report_by_id_not_found - TypeError: object Response can't be used in 'await' expression
FAILED tests/unit/api/test_daily_report_endpoints.py::test_get_daily_report_by_id_invalid_uuid - TypeError: object Response can't be used in 'await' expression
FAILED tests/unit/api/test_health.py::TestHealthChecker::test_check_github_api_success - AttributeError: <module 'app.api.health' from '/Users/parkerbeard/golfdaddy-brain/backend/app/api/health.py'> does not have the attribute 'Github'
FAILED tests/unit/api/test_health.py::TestHealthChecker::test_check_github_api_degraded - AttributeError: <module 'app.api.health' from '/Users/parkerbeard/golfdaddy-brain/backend/app/api/health.py'> does not have the attribute 'Github'
FAILED tests/unit/api/test_health.py::TestHealthChecker::test_check_openai_api_success - AttributeError: <module 'app.api.health' from '/Users/parkerbeard/golfdaddy-brain/backend/app/api/health.py'> does not have the attribute 'OpenAI'
FAILED tests/unit/api/test_health.py::TestHealthEndpoints::test_detailed_health_success - AssertionError: assert 'checks' in {'status': 'healthy', 'message': 'Detailed health checks disabled', 'timestamp': '2025-09-05T12:00:31.690920'}
FAILED tests/unit/api/test_health.py::TestHealthEndpoints::test_detailed_health_degraded - AssertionError: assert 'healthy' == 'degraded'
  
  - degraded
  + healthy
FAILED tests/unit/api/test_health.py::TestHealthEndpoints::test_reset_circuit_breaker_not_found - assert 500 == 404
 +  where 500 = <Response [500 Internal Server Error]>.status_code
FAILED tests/unit/api/test_webhooks.py::TestWebhookEndpoints::test_github_webhook_success - Failed: async def functions are not natively supported.
You need to install a suitable plugin for your async framework, for example:
  - anyio
  - pytest-asyncio
  - pytest-tornasync
  - pytest-trio
  - pytest-twisted
FAILED tests/unit/api/test_webhooks.py::TestWebhookEndpoints::test_github_webhook_no_secret_configured - Failed: async def functions are not natively supported.
You need to install a suitable plugin for your async framework, for example:
  - anyio
  - pytest-asyncio
  - pytest-tornasync
  - pytest-trio
  - pytest-twisted
FAILED tests/unit/api/test_webhooks.py::TestWebhookEndpoints::test_github_webhook_invalid_signature - Failed: async def functions are not natively supported.
You need to install a suitable plugin for your async framework, for example:
  - anyio
  - pytest-asyncio
  - pytest-tornasync
  - pytest-trio
  - pytest-twisted
FAILED tests/unit/api/test_webhooks.py::TestWebhookEndpoints::test_github_webhook_missing_signature - Failed: async def functions are not natively supported.
You need to install a suitable plugin for your async framework, for example:
  - anyio
  - pytest-asyncio
  - pytest-tornasync
  - pytest-trio
  - pytest-twisted
FAILED tests/unit/api/test_webhooks.py::TestWebhookEndpoints::test_github_webhook_invalid_json - Failed: async def functions are not natively supported.
You need to install a suitable plugin for your async framework, for example:
  - anyio
  - pytest-asyncio
  - pytest-tornasync
  - pytest-trio
  - pytest-twisted
FAILED tests/unit/api/test_webhooks.py::TestWebhookEndpoints::test_github_webhook_processing_error - Failed: async def functions are not natively supported.
You need to install a suitable plugin for your async framework, for example:
  - anyio
  - pytest-asyncio
  - pytest-tornasync
  - pytest-trio
  - pytest-twisted
FAILED tests/unit/api/test_webhooks.py::TestWebhookEndpoints::test_github_webhook_status_configured - Failed: async def functions are not natively supported.
You need to install a suitable plugin for your async framework, for example:
  - anyio
  - pytest-asyncio
  - pytest-tornasync
  - pytest-trio
  - pytest-twisted
FAILED tests/unit/api/test_webhooks.py::TestWebhookEndpoints::test_github_webhook_status_not_configured - Failed: async def functions are not natively supported.
You need to install a suitable plugin for your async framework, for example:
  - anyio
  - pytest-asyncio
  - pytest-tornasync
  - pytest-trio
  - pytest-twisted
FAILED tests/unit/core/test_circuit_breaker.py::TestCircuitBreaker::test_circuit_recovery_attempt - AssertionError: assert <CircuitState.HALF_OPEN: 'half_open'> == <CircuitState.CLOSED: 'closed'>
 +  where <CircuitState.HALF_OPEN: 'half_open'> = <app.core.circuit_breaker.CircuitBreaker object at 0x119a71370>.state
 +  and   <CircuitState.CLOSED: 'closed'> = CircuitState.CLOSED
FAILED tests/unit/core/test_circuit_breaker.py::TestGlobalCircuitManager::test_github_circuit_breaker_creation - AttributeError: <module 'app.core.circuit_breaker' from '/Users/parkerbeard/golfdaddy-brain/backend/app/core/circuit_breaker.py'> does not have the attribute 'settings'
FAILED tests/unit/core/test_circuit_breaker.py::TestGlobalCircuitManager::test_openai_circuit_breaker_creation - AttributeError: <module 'app.core.circuit_breaker' from '/Users/parkerbeard/golfdaddy-brain/backend/app/core/circuit_breaker.py'> does not have the attribute 'settings'
FAILED tests/unit/integrations/test_commit_analyzer_impact.py::TestCommitAnalyzerImpact::test_analyze_commit_impact_scoring - KeyError: 'business_value'
FAILED tests/unit/integrations/test_commit_analyzer_impact.py::TestCommitAnalyzerImpact::test_analyze_commit_diff_combined_scoring - KeyError: 'complexity_score'
FAILED tests/unit/integrations/test_commit_analyzer_impact.py::TestCommitAnalyzerImpact::test_impact_score_calculation - KeyError: 'impact_score'
FAILED tests/unit/integrations/test_commit_analyzer_impact.py::TestCommitAnalyzerImpact::test_error_handling - assert 'API Error' in "'property' object is not callable"
FAILED tests/unit/models/test_github_event_schemas.py::test_commit_and_push_event - Failed: DID NOT RAISE <class 'pydantic_core._pydantic_core.ValidationError'>
FAILED tests/unit/repositories/test_commit_repository.py::test_get_existing_commit_hashes_single_batch - app.core.exceptions.DatabaseError: Error checking commit existence: <MagicMock name='to_thread().error.message' id='4723104064'>
FAILED tests/unit/repositories/test_commit_repository.py::test_get_existing_commit_hashes_multiple_batches - app.core.exceptions.DatabaseError: Error checking commit existence: <MagicMock name='mock.error.message' id='4713537152'>
FAILED tests/unit/repositories/test_commit_repository.py::test_get_commits_with_analysis_success - app.core.exceptions.DatabaseError: Error fetching commits with analysis: <MagicMock name='to_thread().error.message' id='4726381872'>
FAILED tests/unit/repositories/test_commit_repository.py::test_get_commits_with_analysis_with_decimal_conversion - app.core.exceptions.DatabaseError: Error fetching commits with analysis: <MagicMock name='to_thread().error.message' id='4726389600'>
FAILED tests/unit/repositories/test_commit_repository.py::test_convert_commit_to_analysis_from_seeder - ModuleNotFoundError: No module named 'backend'
FAILED tests/unit/repositories/test_commit_repository.py::test_convert_commit_to_analysis_malformed_json - ModuleNotFoundError: No module named 'backend'
FAILED tests/unit/repositories/test_daily_report_repository.py::test_get_daily_report_by_id - app.core.exceptions.DatabaseError: Unexpected error getting daily report by ID c0237496-d050-4dd2-98fa-11531ee599b3: 2 validation errors for DailyReport
user_id
  Field required [type=missing, input_value={}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
raw_text_input
  Field required [type=missing, input_value={}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
FAILED tests/unit/repositories/test_daily_report_repository.py::test_get_daily_report_by_id_not_found - app.core.exceptions.DatabaseError: Unexpected error getting daily report by ID 39818939-da6d-4032-8534-53aa672d2d71: 2 validation errors for DailyReport
user_id
  Field required [type=missing, input_value={}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
raw_text_input
  Field required [type=missing, input_value={}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
FAILED tests/unit/repositories/test_daily_report_repository.py::test_get_daily_reports_by_user_id - app.core.exceptions.DatabaseError: Failed to create daily report: <MagicMock name='mock.execute().error.message' id='4723105072'>
FAILED tests/unit/repositories/test_daily_report_repository.py::test_get_daily_reports_by_user_and_date - ImportError: cannot import name '_daily_reports_db' from 'app.repositories.daily_report_repository' (/Users/parkerbeard/golfdaddy-brain/backend/app/repositories/daily_report_repository.py)
FAILED tests/unit/repositories/test_daily_report_repository.py::test_update_daily_report - app.core.exceptions.DatabaseError: Failed to create daily report: <MagicMock name='mock.execute().error.message' id='4750467024'>
FAILED tests/unit/repositories/test_daily_report_repository.py::test_update_daily_report_partial - app.core.exceptions.DatabaseError: Failed to create daily report: <MagicMock name='mock.execute().error.message' id='4750473744'>
FAILED tests/unit/repositories/test_daily_report_repository.py::test_update_daily_report_not_found - app.core.exceptions.DatabaseError: Unexpected error updating daily report b4823841-86d7-43c2-8065-739e8d2f4d9d: 2 validation errors for DailyReport
user_id
  Field required [type=missing, input_value={}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
raw_text_input
  Field required [type=missing, input_value={}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
FAILED tests/unit/repositories/test_daily_report_repository.py::test_delete_daily_report - app.core.exceptions.DatabaseError: Failed to create daily report: <MagicMock name='mock.execute().error.message' id='4725513184'>
FAILED tests/unit/repositories/test_daily_report_repository.py::test_delete_daily_report_not_found - app.core.exceptions.DatabaseError: Unexpected error getting daily report by ID 003f1fd7-08e5-48a2-80bb-0c9394383b82: 2 validation errors for DailyReport
user_id
  Field required [type=missing, input_value={}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
raw_text_input
  Field required [type=missing, input_value={}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
FAILED tests/unit/repositories/test_daily_report_repository.py::test_get_all_daily_reports - app.core.exceptions.DatabaseError: Failed to create daily report: <MagicMock name='mock.execute().error.message' id='4752051568'>
FAILED tests/unit/repositories/test_user_repository.py::test_create_user - pydantic_core._pydantic_core.ValidationError: 2 validation errors for User
created_at
  Field required [type=missing, input_value={'id': UUID('3420c189-091..., 'team': 'Engineering'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
updated_at
  Field required [type=missing, input_value={'id': UUID('3420c189-091..., 'team': 'Engineering'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
FAILED tests/unit/repositories/test_user_repository.py::test_get_user_by_id - AttributeError: 'coroutine' object has no attribute 'id'
FAILED tests/unit/repositories/test_user_repository.py::test_get_user_by_slack_id - AttributeError: 'coroutine' object has no attribute 'slack_id'
FAILED tests/unit/repositories/test_user_repository.py::test_list_users_by_role - TypeError: object of type 'coroutine' has no len()
FAILED tests/unit/repositories/test_user_repository.py::test_update_user - AttributeError: 'coroutine' object has no attribute 'id'
FAILED tests/unit/services/test_daily_commit_analysis_service.py::test_analyze_for_date_automatic - pydantic_core._pydantic_core.ValidationError: 2 validation errors for DailyCommitAnalysis
created_at
  Field required [type=missing, input_value={'id': UUID('8009d9c9-418...nt new API endpoints']}}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
updated_at
  Field required [type=missing, input_value={'id': UUID('8009d9c9-418...nt new API endpoints']}}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
FAILED tests/unit/services/test_daily_commit_analysis_service.py::test_run_midnight_analysis - TypeError: object list can't be used in 'await' expression
FAILED tests/unit/services/test_daily_commit_analysis_service.py::test_get_user_analysis_history - TypeError: object list can't be used in 'await' expression
FAILED tests/unit/services/test_daily_report_service.py::test_submit_daily_report_new - AssertionError: Expected 'update_daily_report' to have been called once. Called 0 times.
FAILED tests/unit/services/test_daily_report_service.py::test_submit_daily_report_existing - app.core.exceptions.BadRequestError: A report for today already exists. Use the update functionality to add more details.
FAILED tests/unit/services/test_daily_report_service.py::test_submit_daily_report_ai_processing_fails - AssertionError: Expected 'update_daily_report' to have been called once. Called 0 times.
FAILED tests/unit/services/test_daily_report_service.py::test_submit_daily_report_update_fails_after_get_existing - AssertionError: Regex pattern did not match.
 Regex: 'Failed to update existing report'
 Input: 'A report for today already exists. Use the update functionality to add more details.'
FAILED tests/unit/services/test_daily_report_service.py::test_submit_daily_report_ai_update_fails_after_successful_first_update - app.core.exceptions.BadRequestError: A report for today already exists. Use the update functionality to add more details.
FAILED tests/unit/services/test_daily_report_service.py::test_submit_daily_report_ai_service_exception - AssertionError: Expected 'update_daily_report' to have been called once. Called 0 times.
FAILED tests/unit/services/test_deduplication_service.py::TestDeduplicationService::test_apply_deduplication_rules - AttributeError: type object 'WorkType' has no attribute 'FEATURE'
FAILED tests/unit/services/test_deduplication_service.py::TestDeduplicationService::test_deduplication_with_time_correlation - pydantic_core._pydantic_core.ValidationError: 1 validation error for Commit
commit_timestamp
  Field required [type=missing, input_value={'id': UUID('d02eff71-90f...d0c-9d5c-172d6fe42b81')}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
FAILED tests/unit/services/test_deduplication_service.py::TestDeduplicationService::test_deduplication_result_persistence - TypeError: DeduplicationResult.__init__() got an unexpected keyword argument 'duplicates'
FAILED tests/unit/services/test_deduplication_service.py::TestDeduplicationService::test_handle_empty_inputs - pydantic_core._pydantic_core.ValidationError: 1 validation error for DailyReport
raw_text_input
  Field required [type=missing, input_value={'id': UUID('d50d08d4-24f...=datetime.timezone.utc)}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
FAILED tests/unit/services/test_deduplication_service.py::TestDeduplicationService::test_complex_deduplication_scenario - pydantic_core._pydantic_core.ValidationError: 1 validation error for Commit
commit_timestamp
  Field required [type=missing, input_value={'id': UUID('12fa0547-4c9...5bc-9c72-19b7c710efe0')}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
FAILED tests/unit/services/test_unified_daily_analysis_service.py::TestUnifiedDailyAnalysisService::test_analyze_daily_work_with_commits_and_report - NameError: name 'DailyWorkAnalysis' is not defined
FAILED tests/unit/services/test_unified_daily_analysis_service.py::TestUnifiedDailyAnalysisService::test_analyze_daily_work_commits_only - NameError: name 'DailyWorkAnalysis' is not defined
FAILED tests/unit/services/test_unified_daily_analysis_service.py::TestUnifiedDailyAnalysisService::test_analyze_daily_work_report_only - NameError: name 'DailyWorkAnalysis' is not defined
FAILED tests/unit/services/test_unified_daily_analysis_service.py::TestUnifiedDailyAnalysisService::test_analyze_daily_work_no_activity - app.core.exceptions.ExternalServiceError: An error occurred while communicating with Unified Daily Analysis. Details: Failed to analyze daily work: An error occurred while communicating with Daily Work Analysis. Details: Failed to analyze daily work: Error fetching daily analysis: {'message': 'Missing response', 'code': '204', 'hint': 'Please check traceback of the code', 'details': "Postgrest couldn't retrieve response, please check traceback of the code. Please create an issue in `supabase-community/postgrest-py` if needed."}
FAILED tests/unit/services/test_unified_daily_analysis_service.py::TestUnifiedDailyAnalysisService::test_analyze_daily_work_existing_analysis - NameError: name 'DailyWorkAnalysis' is not defined
FAILED tests/unit/services/test_unified_daily_analysis_service.py::TestUnifiedDailyAnalysisService::test_analyze_daily_work_force_reanalysis - NameError: name 'DailyWorkAnalysis' is not defined
FAILED tests/unit/services/test_unified_daily_analysis_service.py::TestUnifiedDailyAnalysisService::test_parse_ai_response_validation - KeyError: 'total_productive_hours'
FAILED tests/unit/services/test_unified_daily_analysis_service.py::TestUnifiedDailyAnalysisService::test_ai_error_handling - app.core.exceptions.ExternalServiceError: An error occurred while communicating with Unified Daily Analysis. Details: Failed to analyze daily work: An error occurred while communicating with Daily Work Analysis. Details: Failed to analyze daily work: Error fetching daily analysis: {'message': 'Missing response', 'code': '204', 'hint': 'Please check traceback of the code', 'details': "Postgrest couldn't retrieve response, please check traceback of the code. Please create an issue in `supabase-community/postgrest-py` if needed."}
FAILED tests/unit/services/test_unified_daily_analysis_service.py::TestUnifiedDailyAnalysisService::test_get_weekly_aggregate - NameError: name 'DailyWorkAnalysis' is not defined
FAILED tests/unit/services/test_unified_daily_analysis_service.py::TestUnifiedDailyAnalysisService::test_handle_clarification_needed - NameError: name 'DailyWorkAnalysis' is not defined
FAILED tests/unit/services/test_unified_daily_analysis_service.py::TestUnifiedDailyAnalysisService::test_provide_clarification - NameError: name 'DailyWorkAnalysis' is not defined
FAILED tests/unit/services/test_unified_daily_analysis_service.py::TestUnifiedDailyAnalysisService::test_deduplication_in_prompt - app.core.exceptions.ExternalServiceError: An error occurred while communicating with Unified Daily Analysis. Details: Failed to analyze daily work: An error occurred while communicating with Daily Work Analysis. Details: Failed to analyze daily work: Error fetching daily analysis: {'message': 'Missing response', 'code': '204', 'hint': 'Please check traceback of the code', 'details': "Postgrest couldn't retrieve response, please check traceback of the code. Please create an issue in `supabase-community/postgrest-py` if needed."}
ERROR tests/unit/services/test_commit_analysis_service.py::test_process_commit_new_commit_success - pydantic_core._pydantic_core.ValidationError: 2 validation errors for User
created_at
  Field required [type=missing, input_value={'id': UUID('3914521c-16a...om', 'slack_id': 'U123'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
updated_at
  Field required [type=missing, input_value={'id': UUID('3914521c-16a...om', 'slack_id': 'U123'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
ERROR tests/unit/services/test_commit_analysis_service.py::test_process_commit_existing_needs_analysis - pydantic_core._pydantic_core.ValidationError: 2 validation errors for User
created_at
  Field required [type=missing, input_value={'id': UUID('5c0c666a-b58...om', 'slack_id': 'U123'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
updated_at
  Field required [type=missing, input_value={'id': UUID('5c0c666a-b58...om', 'slack_id': 'U123'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
ERROR tests/unit/services/test_commit_analysis_service.py::test_process_commit_already_processed - pydantic_core._pydantic_core.ValidationError: 2 validation errors for User
created_at
  Field required [type=missing, input_value={'id': UUID('656ff527-c40...om', 'slack_id': 'U123'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
updated_at
  Field required [type=missing, input_value={'id': UUID('656ff527-c40...om', 'slack_id': 'U123'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
ERROR tests/unit/services/test_commit_analysis_service.py::test_process_commit_user_not_found - pydantic_core._pydantic_core.ValidationError: 2 validation errors for User
created_at
  Field required [type=missing, input_value={'id': UUID('5599040d-979...om', 'slack_id': 'U123'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
updated_at
  Field required [type=missing, input_value={'id': UUID('5599040d-979...om', 'slack_id': 'U123'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
ERROR tests/unit/services/test_commit_analysis_service.py::test_process_commit_create_fails - pydantic_core._pydantic_core.ValidationError: 2 validation errors for User
created_at
  Field required [type=missing, input_value={'id': UUID('1bd73634-60e...om', 'slack_id': 'U123'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
updated_at
  Field required [type=missing, input_value={'id': UUID('1bd73634-60e...om', 'slack_id': 'U123'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
ERROR tests/unit/services/test_commit_analysis_service.py::test_process_commit_update_fails - pydantic_core._pydantic_core.ValidationError: 2 validation errors for User
created_at
  Field required [type=missing, input_value={'id': UUID('31455dc0-ff9...om', 'slack_id': 'U123'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
updated_at
  Field required [type=missing, input_value={'id': UUID('31455dc0-ff9...om', 'slack_id': 'U123'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
ERROR tests/unit/services/test_daily_commit_analysis_service.py::test_analyze_for_report_new_analysis - pydantic_core._pydantic_core.ValidationError: 1 validation error for DailyReport
raw_text_input
  Field required [type=missing, input_value={'id': UUID('935a2623-36f...etime.date(2025, 1, 15)}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
ERROR tests/unit/services/test_daily_commit_analysis_service.py::test_analyze_for_report_existing_analysis - pydantic_core._pydantic_core.ValidationError: 1 validation error for DailyReport
raw_text_input
  Field required [type=missing, input_value={'id': UUID('5b0f90f8-152...etime.date(2025, 1, 15)}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
ERROR tests/unit/services/test_daily_commit_analysis_service.py::test_analyze_for_report_no_commits - pydantic_core._pydantic_core.ValidationError: 1 validation error for DailyReport
raw_text_input
  Field required [type=missing, input_value={'id': UUID('bbe1849b-c3d...etime.date(2025, 1, 15)}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
ERROR tests/unit/services/test_daily_commit_analysis_service.py::test_prepare_analysis_context - pydantic_core._pydantic_core.ValidationError: 1 validation error for DailyReport
raw_text_input
  Field required [type=missing, input_value={'id': UUID('b0c3193b-222...etime.date(2025, 1, 15)}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
ERROR tests/unit/services/test_deduplication_service.py::TestDeduplicationService::test_find_duplicates_high_confidence - pydantic_core._pydantic_core.ValidationError: 1 validation error for Commit
commit_timestamp
  Field required [type=missing, input_value={'id': UUID('027457f3-cad...tication', 'security']}}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
ERROR tests/unit/services/test_deduplication_service.py::TestDeduplicationService::test_find_duplicates_no_matches - pydantic_core._pydantic_core.ValidationError: 1 validation error for Commit
commit_timestamp
  Field required [type=missing, input_value={'id': UUID('04247314-b45...tication', 'security']}}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
ERROR tests/unit/services/test_deduplication_service.py::TestDeduplicationService::test_weekly_aggregation - pydantic_core._pydantic_core.ValidationError: 2 validation errors for User
created_at
  Field required [type=missing, input_value={'id': UUID('17d8df54-937...ee'>, 'is_active': True}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
updated_at
  Field required [type=missing, input_value={'id': UUID('17d8df54-937...ee'>, 'is_active': True}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
ERROR tests/unit/services/test_deduplication_service.py::TestDeduplicationService::test_ai_similarity_error_handling - pydantic_core._pydantic_core.ValidationError: 1 validation error for Commit
commit_timestamp
  Field required [type=missing, input_value={'id': UUID('34241204-8ba...tication', 'security']}}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
================== 82 failed, 168 passed, 14 errors in 3.50s ===================
